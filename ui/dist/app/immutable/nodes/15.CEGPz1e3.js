import{t as _,a as c,b as J}from"../chunks/Bm7YDail.js";import"../chunks/Cp0t8ydx.js";import{p as M,l as K,e as O,a as T,b as a,g as l,m as h,c as n,s as g,a4 as Q,r as d,n as R,f as V}from"../chunks/DwP7UOR7.js";import{p as B,i as A}from"../chunks/DCRH5Z1i.js";import{i as C}from"../chunks/C1itxWee.js";import{s as N,a as Y}from"../chunks/C3LHyfkz.js";import{e as x,u as D}from"../chunks/D4zxndPO.js";import{c as W,o as X}from"../chunks/CPg3bG_u.js";import{e as Z}from"../chunks/DSFJq4oy.js";import{p as ee}from"../chunks/Bfc47y5P.js";import{E as re}from"../chunks/CW8wjXXj.js";import{F as ae,a as I}from"../chunks/C9_Sjxzs.js";import{F as se}from"../chunks/BEZkXVQy.js";import{p as te}from"../chunks/CGzTdwYZ.js";var oe=_('<div class="max-w-3xl mx-auto px-4 sm:px-6 md:px-8 mb-6"><!></div>'),ie=_('<form class="p-4"><div class="py-4 bg-white"><div class="grid grid-cols-6 gap-6"><!> <!></div></div> <div class="px-4 py-3 bg-gray-50 text-right sm:px-6 mt-4 -mx-4 -mb-4 border-t border-gray-200"><!></div></form>'),le=_('<div class="py-6"><div class="max-w-3xl mx-auto px-4 sm:px-6 md:px-8"><h1 class="text-2xl font-semibold text-gray-900 mb-6">Edit Profile</h1></div> <!> <div class="max-w-3xl mx-auto px-4 sm:px-6 md:px-8"><!></div></div>');function ne(w,f){M(f,!1);const[E,F]=N(),v=()=>Y(x,"$error",E);let t=B(f,"profile",8,null),i=B(f,"isLoading",8,!1),o=h(""),b=h("");const P=W();function $(){P("save",{name:l(o)})}K(()=>Q(t()),()=>{t()&&(a(o,t().name),a(b,t().email))}),O(),C();var m=le(),y=g(n(m),2);{var L=e=>{var u=oe(),p=n(u);re(p,{get message(){return v()}}),d(u),c(e,u)};A(y,e=>{v()&&e(L)})}var s=g(y,2),r=n(s);ae(r,{title:"Profile Information",description:"Update your personal details",children:(e,u)=>{var p=ie(),S=n(p),k=n(S),q=n(k);I(q,{id:"name",label:"Name",get disabled(){return i()},required:!0,get value(){return l(o)},set value(U){a(o,U)},$$legacy:!0});var j=g(q,2);I(j,{id:"email",label:"Email address (cannot be changed)",type:"email",get value(){return l(b)},cols:"col-span-6 sm:col-span-4",disabled:!0,required:!0}),d(k),d(S);var z=g(S,2),G=n(z);se(G,{type:"submit",get isLoading(){return i()},loadingText:"Saving...",children:(U,ue)=>{R();var H=J("Save");c(U,H)},$$slots:{default:!0}}),d(z),d(p),Z("submit",p,ee($)),c(e,p)},$$slots:{default:!0}}),d(s),d(m),c(w,m),T(),F()}var de=_('<div class="max-w-3xl mx-auto px-4 sm:px-6 md:px-8 my-4"><div class="bg-green-50 border-l-4 border-green-500 text-green-700 p-4 rounded-md shadow-sm" role="alert"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-green-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><p class="text-sm font-medium">Your profile has been updated successfully!</p></div></div></div></div>'),me=_("<!> <!>",1);function Pe(w,f){M(f,!1);const[E,F]=N(),v=()=>Y(D,"$user",E);let t=h(!1),i=h(null),o=h(!1);X(async()=>{await b()});async function b(){var s,r;a(t,!0),x.set(null);try{const e=v();if(!e)throw new Error("User not found");a(i,{name:((s=e.user)==null?void 0:s.name)||"",email:((r=e.user)==null?void 0:r.email)||""})}catch(e){console.error("Error fetching user profile:",e),x.set(e instanceof Error?e.message:"Failed to fetch user profile")}finally{a(t,!1)}}async function P(s){a(t,!0),x.set(null),a(o,!1);try{const{name:r}=s.detail,e=v();if(!e||!e.user)throw new Error("User not found");const u=e.user.id;await te.collection("users").update(u,{name:r}),e.user&&(e.user.name=r,D.set(e)),l(i)&&a(i,{...l(i),name:r}),a(o,!0),setTimeout(()=>{a(o,!1)},3e3)}catch(r){console.error("Error updating profile:",r),x.set(r instanceof Error?r.message:"Failed to update profile")}finally{a(t,!1)}}C();var $=me(),m=V($);{var y=s=>{var r=de();c(s,r)};A(m,s=>{l(o)&&s(y)})}var L=g(m,2);ne(L,{get profile(){return l(i)},get isLoading(){return l(t)},$$events:{save:P}}),c(w,$),T(),F()}export{Pe as component};
//# sourceMappingURL=15.CEGPz1e3.js.map
