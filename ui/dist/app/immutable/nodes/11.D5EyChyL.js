import{t as m,a as g}from"../chunks/Bm7YDail.js";import"../chunks/Cp0t8ydx.js";import{p as Ut,l as Gt,e as Ht,a as Jt,b as l,m as y,g as t,c as r,r as e,s as o,f as Wt,t as h,d as Yt}from"../chunks/DwP7UOR7.js";import{s as d,e as Kt}from"../chunks/DSFJq4oy.js";import{i as x}from"../chunks/DCRH5Z1i.js";import{e as ot,i as ct}from"../chunks/-4v8aoCK.js";import{p as w,a as Qt,s as Xt}from"../chunks/CGzTdwYZ.js";import{i as Zt}from"../chunks/C1itxWee.js";import{s as te,a as ee}from"../chunks/C3LHyfkz.js";import{o as re}from"../chunks/CPg3bG_u.js";import{p as ae}from"../chunks/CHjSzMbL.js";import{g as I}from"../chunks/CxGvuVDF.js";import{B as se,A as ie}from"../chunks/CFNzRvmK.js";import{L as oe}from"../chunks/D1v2Wa_-.js";import{E as ce}from"../chunks/CW8wjXXj.js";var ne=m('<div class="flex justify-center items-center h-64"><!></div>'),le=m('<p class="text-gray-600 mb-4"> </p>'),de=m('<span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),pe=m('<span class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),ve=m('<span class="bg-gray-100 text-gray-800 text-xs font-medium px-2 py-0.5 rounded"> </span>'),ge=m('<div class="mb-4"><div class="text-sm font-semibold text-gray-700 mb-1">Tags:</div> <div class="flex flex-wrap gap-1"></div></div>'),me=m('<tr class="border-b border-gray-200 hover:bg-gray-50"><td class="px-4 py-2 text-sm text-gray-700"> </td><td class="px-4 py-2 text-sm text-gray-700"> </td><td class="px-4 py-2 text-sm text-gray-700"> </td><td class="px-4 py-2 text-sm"><span> </span></td><td class="px-4 py-2 text-sm text-gray-700"><a class="text-blue-600 hover:text-blue-800 hover:underline">View</a></td></tr>'),fe=m('<div class="bg-white shadow-md rounded-lg p-6"><h3 class="text-lg font-semibold text-gray-900 mb-4">Past Practice Sessions</h3> <div class="overflow-x-auto"><table class="min-w-full bg-white"><thead><tr class="border-b border-gray-200"><th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">Session Name</th><th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">Learner</th><th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">Date</th><th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">Status</th><th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">Actions</th></tr></thead><tbody></tbody></table></div></div>'),ue=m('<div class="bg-white shadow-md rounded-lg p-6 mb-6"><h2 class="text-xl font-semibold text-gray-900 mb-2"> </h2> <!> <div class="flex flex-wrap gap-2 mb-4"><span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span> <!> <!></div> <!> <div class="mb-4"><div class="grid grid-cols-2 gap-4"><div class="bg-gray-50 p-3 rounded"><div class="text-sm font-semibold text-gray-700 mb-1">Difficulty Level:</div> <div> </div></div> <div class="bg-gray-50 p-3 rounded"><div class="text-sm font-semibold text-gray-700 mb-1">Target Ages:</div> <div> </div></div></div></div> <div class="mt-8 flex justify-center"><button type="button" class="inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-200"><svg class="h-6 w-6 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg> Create Practice Session</button></div></div> <!>',1),xe=m('<div class="container mx-auto px-4 py-8"><div class="flex justify-between items-center mb-6"><div><!></div> <!></div> <!></div>');function Be(nt,lt){Ut(lt,!1);const[dt,pt]=te(),vt=()=>ee(ae,"$page",dt),H=y();let a=y(null),D=y([]),S=y(!0),f=y(null),P=null,J=y([]);re(async()=>{try{P=vt().params.id,P?(await gt(P),await mt(P),_t()):(l(f,"Invalid topic ID"),l(S,!1))}catch(s){console.error("Error in onMount:",s),l(f,s instanceof Error?s.message:"An unexpected error occurred"),l(S,!1)}});async function gt(s){try{if(l(S,!0),l(f,null),!s)throw new Error("Topic ID is required");const i=await w.collection("practice_topics").getOne(s);if(i.tags){const v=i.tags;if(typeof v=="string")try{v.trim().startsWith("[")?i.tags=JSON.parse(v):i.tags=v.split(",").map(_=>_.trim()).filter(Boolean)}catch(_){console.error("Error parsing tags:",_),i.tags=[]}}else i.tags=[];l(a,i)}catch(i){console.error("Failed to load topic:",i),l(f,"Failed to load practice topic")}finally{l(S,!1)}}async function mt(s){try{const i=await w.collection("practice_sessions").getList(1,10,{filter:`practice_topic="${s}"`,sort:"-created",expand:"learner,practice_topic"});l(D,i.items)}catch(i){console.error("Failed to load past practices:",i)}}function ft(){I("/practice-topics")}function ut(){t(a)&&I(`/practice-topics/edit/${t(a).id}`)}async function xt(){if(t(a))try{const s=w.authStore.model;if(!s){console.error("User not authenticated"),l(f,"You must be logged in to start a practice");return}try{if(await w.collection("instructors").getFirstListItem(`user="${s.id}"`)){I(`/practice-topics/${t(a).id}/create-session`);return}}catch{}try{const i=await w.collection("learners").getFirstListItem(`user="${s.id}"`),v={practice_topic:t(a).id,learner:i.id,practice_items:"[]",assigned_at:new Date().toISOString(),status:"InProgress",name:`Practice: ${t(a).name}`},_=await w.collection("practice_sessions").create(v);I(`/practice-sessions/${_.id}`)}catch(i){console.error("Failed to find learner record:",i),l(f,"Could not find your learner profile. Please contact support.");return}}catch(s){console.error("Failed to create practice session:",s),l(f,"Failed to start new practice: "+(s instanceof Error?s.message:String(s)))}}function _t(){t(a)&&l(J,[{label:"Topics",href:"/practice-topics",icon:"topic"},{label:t(a).name,icon:"topic"}])}Gt(()=>{},()=>{l(H,[{id:"back",label:"Back",icon:"back",variant:"secondary",onClick:ft},{id:"edit",label:"Edit",icon:"edit",variant:"primary",onClick:ut}])}),Ht(),Zt();var L=xe(),E=r(L),F=r(E),bt=r(F);se(bt,{get items(){return t(J)}}),e(F);var yt=o(F,2);ie(yt,{get actions(){return t(H)}}),e(E);var ht=o(E,2);{var wt=s=>{var i=ne(),v=r(i);oe(v,{size:"md",color:"primary"}),e(i),g(s,i)},St=(s,i)=>{{var v=b=>{ce(b,{get message(){return t(f)}})},_=(b,$t)=>{{var Pt=B=>{var W=ue(),T=Wt(W),C=r(T),kt=r(C,!0);e(C);var Y=o(C,2);{var At=c=>{var n=le(),p=r(n,!0);e(n),h(()=>d(p,t(a).description)),g(c,n)};x(Y,c=>{t(a).description&&c(At)})}var j=o(Y,2),N=r(j),It=r(N,!0);e(N);var K=o(N,2);{var Dt=c=>{var n=de(),p=r(n);e(n),h(()=>d(p,`Age: ${t(a).target_age_range??""}`)),g(c,n)};x(K,c=>{t(a).target_age_range&&c(Dt)})}var Lt=o(K,2);{var Et=c=>{var n=pe(),p=r(n);e(n),h(()=>d(p,`Grade: ${t(a).target_grade_level??""}`)),g(c,n)};x(Lt,c=>{t(a).target_grade_level&&c(Et)})}e(j);var Q=o(j,2);{var Ft=c=>{var n=ge(),p=o(r(n),2);ot(p,5,()=>t(a).tags,ct,(k,A)=>{var $=ve(),u=r($,!0);e($),h(()=>d(u,t(A))),g(k,$)}),e(p),e(n),g(c,n)};x(Q,c=>{t(a).tags&&Array.isArray(t(a).tags)&&t(a).tags.length>0&&c(Ft)})}var M=o(Q,2),X=r(M),O=r(X),Z=o(r(O),2),Bt=r(Z,!0);e(Z),e(O);var tt=o(O,2),et=o(r(tt),2),Tt=r(et,!0);e(et),e(tt),e(X),e(M);var rt=o(M,2),Ct=r(rt);e(rt),e(T);var jt=o(T,2);{var Nt=c=>{var n=fe(),p=o(r(n),2),k=r(p),A=o(r(k));ot(A,5,()=>t(D),ct,($,u)=>{var R=me(),V=r(R),Mt=r(V,!0);e(V);var q=o(V),Ot=r(q,!0);e(q);var z=o(q),Rt=r(z,!0);e(z);var U=o(z),G=r(U),Vt=r(G,!0);e(G),e(U);var at=o(U),qt=r(at);e(at),e(R),h(zt=>{var st,it;d(Mt,t(u).name||"Practice Session"),d(Ot,((it=(st=t(u).expand)==null?void 0:st.learner)==null?void 0:it.nickname)||"Unknown Learner"),d(Rt,zt),Qt(G,1,`px-2 py-1 rounded-full text-xs font-medium 
                                            ${t(u).status==="Completed"?"bg-green-100 text-green-800":t(u).status==="InProgress"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`),d(Vt,t(u).status),Xt(qt,"href",`/practice-sessions/${t(u).id}`)},[()=>new Date(t(u).created).toLocaleDateString()],Yt),g($,R)}),e(A),e(k),e(p),e(n),g(c,n)};x(jt,c=>{t(D).length>0&&c(Nt)})}h(()=>{d(kt,t(a).name),d(It,t(a).subject),d(Bt,t(a).difficulty_level??"Not specified"),d(Tt,t(a).target_age_range||"Not specified")}),Kt("click",Ct,xt),g(B,W)};x(b,B=>{t(a)&&B(Pt)},$t)}};x(s,b=>{t(f)?b(v):b(_,!1)},i)}};x(ht,s=>{t(S)?s(wt):s(St,!1)})}e(L),g(nt,L),Jt(),pt()}export{Be as component};
//# sourceMappingURL=11.D5EyChyL.js.map
