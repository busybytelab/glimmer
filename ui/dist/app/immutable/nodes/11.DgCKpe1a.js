import{t as g,a as v}from"../chunks/Budn9l7p.js";import"../chunks/C5lklyGm.js";import{p as zt,l as Gt,e as Ht,a as Jt,b as d,m as h,g as t,c as r,r as e,s as o,t as b,f as Wt,d as Yt}from"../chunks/Dy_2QLcd.js";import{s as l,e as Kt}from"../chunks/HzhFnYKD.js";import{i as x}from"../chunks/CSRWkSd7.js";import{e as ct,i as dt}from"../chunks/KXxnkizF.js";import{p as w,a as Qt,s as Xt}from"../chunks/3tUVfVXT.js";import{i as Zt}from"../chunks/Bd0QBR9D.js";import{s as te,a as ee}from"../chunks/CbMnyNtw.js";import{o as re}from"../chunks/CeJAMhHV.js";import{p as ae}from"../chunks/DtAyR18x.js";import{g as B}from"../chunks/BHgSklzR.js";import{B as se,A as ie}from"../chunks/Dl4L_VQ5.js";var oe=g('<div class="flex justify-center items-center h-64"><div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"></div></div>'),ne=g('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert"><strong class="font-bold">Error!</strong> <span class="block sm:inline"> </span></div>'),ce=g('<p class="text-gray-600 mb-4"> </p>'),de=g('<span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),le=g('<span class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),pe=g('<span class="bg-gray-100 text-gray-800 text-xs font-medium px-2 py-0.5 rounded"> </span>'),ve=g('<div class="mb-4"><div class="text-sm font-semibold text-gray-700 mb-1">Tags:</div> <div class="flex flex-wrap gap-1"></div></div>'),ge=g('<tr class="border-b border-gray-200 hover:bg-gray-50"><td class="px-4 py-2 text-sm text-gray-700"> </td><td class="px-4 py-2 text-sm text-gray-700"> </td><td class="px-4 py-2 text-sm text-gray-700"> </td><td class="px-4 py-2 text-sm"><span> </span></td><td class="px-4 py-2 text-sm text-gray-700"><a class="text-blue-600 hover:text-blue-800 hover:underline">View</a></td></tr>'),ue=g('<div class="bg-white shadow-md rounded-lg p-6"><h3 class="text-lg font-semibold text-gray-900 mb-4">Past Practice Sessions</h3> <div class="overflow-x-auto"><table class="min-w-full bg-white"><thead><tr class="border-b border-gray-200"><th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">Session Name</th><th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">Learner</th><th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">Date</th><th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">Status</th><th class="px-4 py-2 text-left text-sm font-semibold text-gray-700">Actions</th></tr></thead><tbody></tbody></table></div></div>'),me=g('<div class="bg-white shadow-md rounded-lg p-6 mb-6"><h2 class="text-xl font-semibold text-gray-900 mb-2"> </h2> <!> <div class="flex flex-wrap gap-2 mb-4"><span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span> <!> <!></div> <!> <div class="mb-4"><div class="grid grid-cols-2 gap-4"><div class="bg-gray-50 p-3 rounded"><div class="text-sm font-semibold text-gray-700 mb-1">Difficulty Level:</div> <div> </div></div> <div class="bg-gray-50 p-3 rounded"><div class="text-sm font-semibold text-gray-700 mb-1">Target Ages:</div> <div> </div></div></div></div> <div class="mt-8 flex justify-center"><button type="button" class="inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-200"><svg class="h-6 w-6 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg> Create Practice Session</button></div></div> <!>',1),fe=g('<div class="container mx-auto px-4 py-8"><div class="flex justify-between items-center mb-6"><div><!></div> <!></div> <!></div>');function Fe(lt,pt){zt(pt,!1);const[vt,gt]=te(),ut=()=>ee(ae,"$page",vt),W=h();let a=h(null),E=h([]),$=h(!0),u=h(null),I=null,Y=h([]);re(async()=>{try{I=ut().params.id,I?(await mt(I),await ft(I),yt()):(d(u,"Invalid topic ID"),d($,!1))}catch(s){console.error("Error in onMount:",s),d(u,s instanceof Error?s.message:"An unexpected error occurred"),d($,!1)}});async function mt(s){try{if(d($,!0),d(u,null),!s)throw new Error("Topic ID is required");const i=await w.collection("practice_topics").getOne(s);if(i.tags){const f=i.tags;if(typeof f=="string")try{f.trim().startsWith("[")?i.tags=JSON.parse(f):i.tags=f.split(",").map(_=>_.trim()).filter(Boolean)}catch(_){console.error("Error parsing tags:",_),i.tags=[]}}else i.tags=[];d(a,i)}catch(i){console.error("Failed to load topic:",i),d(u,"Failed to load practice topic")}finally{d($,!1)}}async function ft(s){try{const i=await w.collection("practice_sessions").getList(1,10,{filter:`practice_topic="${s}"`,sort:"-created",expand:"learner,practice_topic"});d(E,i.items)}catch(i){console.error("Failed to load past practices:",i)}}function xt(){B("/practice-topics")}function _t(){t(a)&&B(`/practice-topics/edit/${t(a).id}`)}async function bt(){if(t(a))try{const s=w.authStore.model;if(!s){console.error("User not authenticated"),d(u,"You must be logged in to start a practice");return}try{if(await w.collection("instructors").getFirstListItem(`user="${s.id}"`)){B(`/practice-topics/${t(a).id}/create-session`);return}}catch{}try{const i=await w.collection("learners").getFirstListItem(`user="${s.id}"`),f={practice_topic:t(a).id,learner:i.id,practice_items:"[]",assigned_at:new Date().toISOString(),status:"InProgress",name:`Practice: ${t(a).name}`},_=await w.collection("practice_sessions").create(f);B(`/practice-sessions/${_.id}`)}catch(i){console.error("Failed to find learner record:",i),d(u,"Could not find your learner profile. Please contact support.");return}}catch(s){console.error("Failed to create practice session:",s),d(u,"Failed to start new practice: "+(s instanceof Error?s.message:String(s)))}}function yt(){t(a)&&d(Y,[{label:"Topics",href:"/practice-topics",icon:"topic"},{label:t(a).name,icon:"topic"}])}Gt(()=>{},()=>{d(W,[{id:"back",label:"Back",icon:"back",variant:"secondary",onClick:xt},{id:"edit",label:"Edit",icon:"edit",variant:"primary",onClick:_t}])}),Ht(),Zt();var L=fe(),T=r(L),C=r(T),ht=r(C);se(ht,{get items(){return t(Y)}}),e(C);var wt=o(C,2);ie(wt,{get actions(){return t(W)}}),e(T);var $t=o(T,2);{var Pt=s=>{var i=oe();v(s,i)},St=(s,i)=>{{var f=y=>{var P=ne(),A=o(r(P),2),S=r(A,!0);e(A),e(P),b(()=>l(S,t(u))),v(y,P)},_=(y,P)=>{{var A=S=>{var K=me(),j=Wt(K),N=r(j),kt=r(N,!0);e(N);var Q=o(N,2);{var It=n=>{var c=ce(),p=r(c,!0);e(c),b(()=>l(p,t(a).description)),v(n,c)};x(Q,n=>{t(a).description&&n(It)})}var M=o(Q,2),O=r(M),At=r(O,!0);e(O);var X=o(O,2);{var Dt=n=>{var c=de(),p=r(c);e(c),b(()=>l(p,`Age: ${t(a).target_age_range??""}`)),v(n,c)};x(X,n=>{t(a).target_age_range&&n(Dt)})}var Ft=o(X,2);{var Bt=n=>{var c=le(),p=r(c);e(c),b(()=>l(p,`Grade: ${t(a).target_grade_level??""}`)),v(n,c)};x(Ft,n=>{t(a).target_grade_level&&n(Bt)})}e(M);var Z=o(M,2);{var Et=n=>{var c=ve(),p=o(r(c),2);ct(p,5,()=>t(a).tags,dt,(D,F)=>{var k=pe(),m=r(k,!0);e(k),b(()=>l(m,t(F))),v(D,k)}),e(p),e(c),v(n,c)};x(Z,n=>{t(a).tags&&Array.isArray(t(a).tags)&&t(a).tags.length>0&&n(Et)})}var R=o(Z,2),tt=r(R),V=r(tt),et=o(r(V),2),Lt=r(et,!0);e(et),e(V);var rt=o(V,2),at=o(r(rt),2),Tt=r(at,!0);e(at),e(rt),e(tt),e(R);var st=o(R,2),Ct=r(st);e(st),e(j);var jt=o(j,2);{var Nt=n=>{var c=ue(),p=o(r(c),2),D=r(p),F=o(r(D));ct(F,5,()=>t(E),dt,(k,m)=>{var q=ge(),U=r(q),Mt=r(U,!0);e(U);var z=o(U),Ot=r(z,!0);e(z);var G=o(z),Rt=r(G,!0);e(G);var H=o(G),J=r(H),Vt=r(J,!0);e(J),e(H);var it=o(H),qt=r(it);e(it),e(q),b(Ut=>{var ot,nt;l(Mt,t(m).name||"Practice Session"),l(Ot,((nt=(ot=t(m).expand)==null?void 0:ot.learner)==null?void 0:nt.nickname)||"Unknown Learner"),l(Rt,Ut),Qt(J,1,`px-2 py-1 rounded-full text-xs font-medium 
                                            ${t(m).status==="Completed"?"bg-green-100 text-green-800":t(m).status==="InProgress"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`),l(Vt,t(m).status),Xt(qt,"href",`/practice-sessions/${t(m).id}`)},[()=>new Date(t(m).created).toLocaleDateString()],Yt),v(k,q)}),e(F),e(D),e(p),e(c),v(n,c)};x(jt,n=>{t(E).length>0&&n(Nt)})}b(()=>{l(kt,t(a).name),l(At,t(a).subject),l(Lt,t(a).difficulty_level??"Not specified"),l(Tt,t(a).target_age_range||"Not specified")}),Kt("click",Ct,bt),v(S,K)};x(y,S=>{t(a)&&S(A)},P)}};x(s,y=>{t(u)?y(f):y(_,!1)},i)}};x($t,s=>{t($)?s(Pt):s(St,!1)})}e(L),v(lt,L),Jt(),gt()}export{Fe as component};
//# sourceMappingURL=11.DgCKpe1a.js.map
