{"version":3,"file":"15.BD6c8VgI.js","sources":["../../../../../../src/components/settings/EditProfile.svelte","../../../../../../src/routes/profile/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { error } from '$lib/stores';\n\timport { createEventDispatcher } from 'svelte';\n\timport ErrorAlert from '../common/ErrorAlert.svelte';\n\timport FormField from '../common/FormField.svelte';\n\timport FormButton from '../common/FormButton.svelte';\n\timport FormSection from '../common/FormSection.svelte';\n\n\texport let profile: { name: string; email: string } | null = null;\n\texport let isLoading: boolean = false;\n\n\tlet name = '';\n\tlet email = '';\n\n\t$: if (profile) {\n\t\tname = profile.name;\n\t\temail = profile.email;\n\t}\n\n\tconst dispatch = createEventDispatcher();\n\n\tfunction handleSubmit() {\n\t\tdispatch('save', { name });\n\t}\n</script>\n\n<div class=\"py-6\">\n\t<div class=\"max-w-3xl mx-auto px-4 sm:px-6 md:px-8\">\n\t\t<h1 class=\"text-2xl font-semibold text-gray-900 mb-6\">Edit Profile</h1>\n\t</div>\n\t\n\t{#if $error}\n\t\t<div class=\"max-w-3xl mx-auto px-4 sm:px-6 md:px-8 mb-6\">\n\t\t\t<ErrorAlert message={$error} />\n\t\t</div>\n\t{/if}\n\t\n\t<div class=\"max-w-3xl mx-auto px-4 sm:px-6 md:px-8\">\n\t\t<FormSection title=\"Profile Information\" description=\"Update your personal details\">\n\t\t\t<form on:submit|preventDefault={handleSubmit} class=\"p-4\">\n\t\t\t\t<div class=\"py-4 bg-white\">\n\t\t\t\t\t<div class=\"grid grid-cols-6 gap-6\">\n\t\t\t\t\t\t<FormField \n\t\t\t\t\t\t\tid=\"name\"\n\t\t\t\t\t\t\tlabel=\"Name\"\n\t\t\t\t\t\t\tbind:value={name}\n\t\t\t\t\t\t\tdisabled={isLoading}\n\t\t\t\t\t\t\trequired={true}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<FormField \n\t\t\t\t\t\t\tid=\"email\"\n\t\t\t\t\t\t\tlabel=\"Email address (cannot be changed)\"\n\t\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\t\tvalue={email}\n\t\t\t\t\t\t\tcols=\"col-span-6 sm:col-span-4\"\n\t\t\t\t\t\t\tdisabled={true}\n\t\t\t\t\t\t\trequired={true}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"px-4 py-3 bg-gray-50 text-right sm:px-6 mt-4 -mx-4 -mb-4 border-t border-gray-200\">\n\t\t\t\t\t<FormButton \n\t\t\t\t\t\ttype=\"submit\" \n\t\t\t\t\t\t{isLoading}\n\t\t\t\t\t\tloadingText=\"Saving...\"\n\t\t\t\t\t>\n\t\t\t\t\t\tSave\n\t\t\t\t\t</FormButton>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</FormSection>\n\t</div>\n</div> ","<script lang=\"ts\">\n\timport { user, error } from '$lib/stores';\n\timport { onMount } from 'svelte';\n\timport EditProfile from '../../components/settings/EditProfile.svelte';\n\timport pb from '$lib/pocketbase';\n\n\tlet isLoading = false;\n\tlet userProfile: { name: string; email: string } | null = null;\n\tlet savedSuccessfully = false;\n\n\tonMount(async () => {\n\t\tawait fetchUserProfile();\n\t});\n\n\tasync function fetchUserProfile() {\n\t\tisLoading = true;\n\t\terror.set(null);\n\n\t\ttry {\n\t\t\tconst currentUser = $user;\n\t\t\tif (!currentUser) {\n\t\t\t\tthrow new Error('User not found');\n\t\t\t}\n\n\t\t\t// Here we would fetch additional profile data if needed\n\t\t\tuserProfile = {\n\t\t\t\tname: currentUser.user?.name || '',\n\t\t\t\temail: currentUser.user?.email || '',\n\t\t\t};\n\t\t} catch (err) {\n\t\t\tconsole.error('Error fetching user profile:', err);\n\t\t\terror.set(err instanceof Error ? err.message : 'Failed to fetch user profile');\n\t\t} finally {\n\t\t\tisLoading = false;\n\t\t}\n\t}\n\n\tasync function handleSaveProfile(event: CustomEvent<{ name: string }>) {\n\t\tisLoading = true;\n\t\terror.set(null);\n\t\tsavedSuccessfully = false;\n\n\t\ttry {\n\t\t\tconst { name } = event.detail;\n\t\t\tconst currentUser = $user;\n\t\t\t\n\t\t\tif (!currentUser || !currentUser.user) {\n\t\t\t\tthrow new Error('User not found');\n\t\t\t}\n\t\t\t\n\t\t\t// Update user in PocketBase\n\t\t\tconst userId = currentUser.user.id;\n\t\t\tawait pb.collection('users').update(userId, { name });\n\t\t\t\n\t\t\t// Update local user data\n\t\t\tif (currentUser.user) {\n\t\t\t\tcurrentUser.user.name = name;\n\t\t\t\tuser.set(currentUser);\n\t\t\t}\n\t\t\t\n\t\t\t// Update local profile\n\t\t\tif (userProfile) {\n\t\t\t\tuserProfile = {\n\t\t\t\t\t...userProfile,\n\t\t\t\t\tname\n\t\t\t\t};\n\t\t\t}\n\t\t\t\n\t\t\t// Show success message briefly\n\t\t\tsavedSuccessfully = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tsavedSuccessfully = false;\n\t\t\t}, 3000);\n\t\t\t\n\t\t} catch (err) {\n\t\t\tconsole.error('Error updating profile:', err);\n\t\t\terror.set(err instanceof Error ? err.message : 'Failed to update profile');\n\t\t} finally {\n\t\t\tisLoading = false;\n\t\t}\n\t}\n</script>\n\n{#if savedSuccessfully}\n\t<div class=\"max-w-3xl mx-auto px-4 sm:px-6 md:px-8 my-4\">\n\t\t<div class=\"bg-green-50 border-l-4 border-green-500 text-green-700 p-4 rounded-md shadow-sm\" role=\"alert\">\n\t\t\t<div class=\"flex\">\n\t\t\t\t<div class=\"flex-shrink-0\">\n\t\t\t\t\t<svg class=\"h-5 w-5 text-green-500\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n\t\t\t\t\t\t<path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clip-rule=\"evenodd\" />\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ml-3\">\n\t\t\t\t\t<p class=\"text-sm font-medium\">Your profile has been updated successfully!</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n{/if}\n\n<EditProfile \n\tprofile={userProfile} \n\t{isLoading}\n\ton:save={handleSaveProfile}\n/> "],"names":["profile","isLoading","name","email","dispatch","createEventDispatcher","handleSubmit","$error","$$render","consequent","$$value","userProfile","savedSuccessfully","onMount","fetchUserProfile","$.set","error","currentUser","$user","_a","_b","err","handleSaveProfile","event","userId","pb","user","$.get"],"mappings":"4zCAQY,IAAAA,kBAAkD,IAAI,EACtDC,oBAAqB,EAAK,EAEjCC,IAAO,EAAE,EACTC,IAAQ,EAAE,EAOR,MAAAC,EAAWC,EAAqB,EAE7B,SAAAC,GAAe,CACvBF,EAAS,OAAU,CAAA,OAAAF,CAAI,CAAA,CAAA,CACxB,mBATOF,EAAO,MACbE,EAAOF,EAAO,EAAC,IAAI,IACnBG,EAAQH,EAAO,EAAC,KAAK,4FAiBCO,EAAM,0BAFxBA,EAAM,GAAAC,EAAAC,CAAA,wMAeKR,EAAS,YACT,wBAFEC,CAAI,kBAAJA,EAAIQ,CAAA,0HASTP,CAAK,4CAEF,YACA,0MAlBkBG,CAAY,CAAA,yxBCjC1C,IAAAL,IAAY,EAAK,EACjBU,IAAsD,IAAI,EAC1DC,IAAoB,EAAK,EAE7BC,EAAoB,SAAA,OACbC,EAAgB,EACtB,EAEc,eAAAA,GAAmB,SACjCC,EAAAd,EAAY,EAAI,EAChBe,EAAM,IAAI,IAAI,EAEV,GAAA,CACG,MAAAC,EAAcC,EAAK,EACpB,GAAA,CAAAD,EACM,MAAA,IAAA,MAAM,gBAAgB,IAIjCN,EAAW,CACV,OAAMQ,EAAAF,EAAY,OAAZ,YAAAE,EAAkB,OAAQ,GAChC,QAAOC,EAAAH,EAAY,OAAZ,YAAAG,EAAkB,QAAS,IAEnC,OAAQC,EAAK,CACb,QAAQ,MAAM,+BAAgCA,CAAG,EACjDL,EAAM,IAAIK,aAAe,MAAQA,EAAI,QAAU,8BAA8B,CAC9E,QAAU,CACTN,EAAAd,EAAY,EAAK,CAClB,CACD,gBAEeqB,EAAkBC,EAAsC,CACtER,EAAAd,EAAY,EAAI,EAChBe,EAAM,IAAI,IAAI,EACdD,EAAAH,EAAoB,EAAK,EAErB,GAAA,OACK,KAAAV,GAASqB,EAAM,OACjBN,EAAcC,EAAK,EAEpB,GAAA,CAAAD,GAAgB,CAAAA,EAAY,KACtB,MAAA,IAAA,MAAM,gBAAgB,EAI3B,MAAAO,EAASP,EAAY,KAAK,SAC1BQ,GAAG,WAAW,OAAO,EAAE,OAAOD,EAAM,CAAI,KAAAtB,EAAI,EAG9Ce,EAAY,OACfA,EAAY,KAAK,KAAOf,EACxBwB,EAAK,IAAIT,CAAW,GAIjBU,EAAAhB,CAAW,KACdA,EAAW,CAAA,GAAAgB,EACPhB,CAAW,EACd,KAAAT,EAAA,EAKFa,EAAAH,EAAoB,EAAI,EACxB,WAAiB,IAAA,CAChBG,EAAAH,EAAoB,EAAK,CACzB,EAAE,IAEH,OAAQS,EAAK,CACb,QAAQ,MAAM,0BAA2BA,CAAG,EAC5CL,EAAM,IAAIK,aAAe,MAAQA,EAAI,QAAU,0BAA0B,CAC1E,QAAU,CACTN,EAAAd,EAAY,EAAK,CAClB,CACD,+DAGIW,CAAiB,GAAAJ,EAAAC,CAAA,8CAkBZE,CAAW,+CAEXW,CAAiB"}