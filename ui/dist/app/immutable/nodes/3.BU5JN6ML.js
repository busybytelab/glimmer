import{t as x,a as v,c as ae}from"../chunks/Bm7YDail.js";import"../chunks/Cp0t8ydx.js";import{p as Te,l as se,e as $e,t as A,g as e,a as Ce,b as s,m as c,c as r,d as Q,s as u,f as re,r as o}from"../chunks/DwP7UOR7.js";import{e as oe,s as b,r as De}from"../chunks/DSFJq4oy.js";import{i as E}from"../chunks/DCRH5Z1i.js";import{e as le,i as ie}from"../chunks/-4v8aoCK.js";import{s as ne,a as Me}from"../chunks/CGzTdwYZ.js";import{b as Ee}from"../chunks/BHoMrDBE.js";import{p as Se}from"../chunks/Bfc47y5P.js";import{i as Pe}from"../chunks/C1itxWee.js";import{e as de}from"../chunks/D4zxndPO.js";import{S as Le,l as ce}from"../chunks/BDL569NN.js";var Fe=x("<option>Loading models...</option>"),je=x("<option>Error loading models</option>"),Ae=x("<option> </option>"),He=x('<div class="text-center py-12 border border-dashed border-gray-200 rounded-lg"><p class="text-gray-500">No messages yet. Start a conversation below.</p></div>'),Ne=x('<span class="text-xs text-gray-400 ml-2 tooltip svelte-f8ri06"> </span>'),Ye=x('<div class="flex flex-col"><div class="flex items-center mb-2"><span class="font-medium text-sm text-gray-700 mr-2"> </span> <span class="text-xs text-gray-500"> </span> <!></div> <div><p class="whitespace-pre-wrap break-words text-left text-gray-800"> </p></div></div>'),qe=x('<div class="flex flex-col"><div class="flex items-center mb-2"><span class="font-medium text-sm text-gray-700">Assistant</span></div> <div class="bg-gray-50 border border-gray-100 rounded-lg p-4"><div class="flex space-x-2"><div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce bounce-delay-1 svelte-f8ri06"></div> <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce bounce-delay-2 svelte-f8ri06"></div></div></div></div>'),Ke=x('<div class="space-y-6"><!> <!></div>'),ze=x('<div class="max-w-full mx-auto px-4 sm:px-6 md:px-8 my-8"><div class="flex justify-between items-center mb-6"><h1 class="text-2xl font-semibold text-gray-900">Chat with LLM</h1> <div class="flex items-center"><!></div></div> <div class="bg-white shadow rounded-lg"><div class="px-4 py-5 sm:p-6 chat-container"><!></div> <div class="px-4 py-4 sm:px-6 border-t border-gray-200"><form class="flex"><textarea placeholder="Type your message..." rows="3" class="flex-1 px-4 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-0 focus:ring-secondary focus:border-secondary resize-none dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600 dark:placeholder-gray-500"></textarea> <button type="submit" class="bg-secondary text-white px-6 py-2 rounded-r-md hover:bg-blue-600 focus:outline-none focus:ring-0 focus:ring-secondary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0"> </button></form> <div class="flex justify-between mt-2"><p class="text-xs text-gray-500">Press Enter to send, Shift+Enter for new line</p> <p class="text-xs text-gray-500 font-medium tooltip svelte-f8ri06"> </p></div></div></div></div>');function et(ve,fe){Te(fe,!1);const R=c();let h=c(""),p=c([]),w=c(!1),ue="You are a helpful learning assistant for kids.",S=c(""),V=c(0),H=c(0),N=c(0),Y=c(0),P=c(!1),q=c(null),k=c([]);async function pe(){s(P,!0),s(q,null);try{const t=await ce.getInfo();s(k,t.platforms.flatMap(n=>n.models.map(d=>({id:d.name,name:`${d.name}${d.isDefault?" (Default)":""}`,isDefault:d.isDefault})))),e(k).length===0&&s(k,[{id:"",name:"Default"}]);const l=e(k).find(n=>n.isDefault);l&&s(S,l.id)}catch(t){console.error("Error fetching models:",t),s(q,t instanceof Error?t.message:"Failed to fetch models"),s(k,[{id:"",name:"Default"}])}finally{s(P,!1)}}pe();async function W(){if(!e(h).trim())return;const t={role:"user",content:e(h),timestamp:new Date};s(p,[...e(p),t]),s(h,""),s(w,!0),de.set(null);try{const l=e(p).map(i=>`${i.role==="user"?"User":"Assistant"}: ${i.content}`).join(`

`),n=await ce.chat(l,ue,e(S)||void 0),d={role:"assistant",content:n.response,timestamp:new Date,usage:n.usage};s(p,[...e(p),d]),setTimeout(()=>{const i=document.querySelector(".chat-container");i&&(i.scrollTop=i.scrollHeight)},50)}catch(l){console.error("Error sending message:",l),de.set(l instanceof Error?l.message:"Failed to send message")}finally{s(w,!1)}}function me(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),W())}se(()=>e(p),()=>{let t=0,l=0,n=0,d=0;e(p).forEach(i=>{i.usage&&(t+=i.usage.PromptTokens||0,l+=i.usage.CompletionTokens||0,n+=i.usage.TotalTokens||0,d+=i.usage.Cost||0)}),s(H,t),s(N,l),s(V,n),s(Y,d)}),se(()=>(e(H),e(N),e(Y)),()=>{s(R,`Prompt: ${e(H)} tokens
Completion: ${e(N)} tokens
Cost: $${e(Y).toFixed(6)}`)}),$e(),Pe();var K=ze(),z=r(K),X=u(r(z),2),ge=r(X);Le(ge,{id:"modelSelect",label:"Model",get disabled(){return e(P)},cols:"",inline:!0,get value(){return e(S)},set value(t){s(S,t)},children:(t,l)=>{var n=ae(),d=re(n);{var i=a=>{var m=Fe();m.value=m.__value="",v(a,m)},y=(a,m)=>{{var T=_=>{var f=je();f.value=f.__value="",v(_,f)},$=_=>{var f=ae(),G=re(f);le(G,1,()=>e(k),ie,(J,C)=>{var g=Ae(),D={},O=r(g,!0);o(g),A(()=>{D!==(D=e(C).id)&&(g.value=(g.__value=e(C).id)??""),b(O,e(C).name)}),v(J,g)}),v(_,f)};E(a,_=>{e(q)?_(T):_($,!1)},m)}};E(d,a=>{e(P)?a(i):a(y,!1)})}v(t,n)},$$slots:{default:!0},$$legacy:!0}),o(X),o(z);var Z=u(z,2),I=r(Z),xe=r(I);{var _e=t=>{var l=He();v(t,l)},ye=t=>{var l=Ke(),n=r(l);le(n,1,()=>e(p),ie,(y,a)=>{var m=Ye(),T=r(m),$=r(T),_=r($,!0);o($);var f=u($,2),G=r(f,!0);o(f);var J=u(f,2);{var C=M=>{var j=Ne(),ke=r(j);o(j),A(we=>{ne(j,"title",`Model: ${e(a).usage.LlmModelName||"Default"} Cache hit: ${e(a).usage.CacheHit?"Yes":"No"} Prompt: ${e(a).usage.PromptTokens??""} tokens Completion: ${e(a).usage.CompletionTokens??""} tokens Cost: $${we??""}`),b(ke,`(${e(a).usage.TotalTokens??""} tokens)`)},[()=>(e(a).usage.Cost||0).toFixed(6)],Q),v(M,j)};E(J,M=>{e(a).role==="assistant"&&e(a).usage&&M(C)})}o(T);var g=u(T,2),D=r(g),O=r(D,!0);o(D),o(g),o(m),A(M=>{b(_,e(a).role==="user"?"You":"Assistant"),b(G,M),Me(g,1,`${e(a).role==="user"?"bg-blue-50 border-blue-100":"bg-gray-50 border-gray-100"} border rounded-lg p-4`),b(O,e(a).content)},[()=>e(a).timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})],Q),v(y,m)});var d=u(n,2);{var i=y=>{var a=qe();v(y,a)};E(d,y=>{e(w)&&y(i)})}o(l),v(t,l)};E(xe,t=>{e(p).length===0?t(_e):t(ye,!1)})}o(I);var ee=u(I,2),L=r(ee),F=r(L);De(F);var U=u(F,2),be=r(U,!0);o(U),o(L);var te=u(L,2),B=u(r(te),2),he=r(B);o(B),o(te),o(ee),o(Z),o(K),A(t=>{U.disabled=t,b(be,e(w)?"Sending...":"Send"),ne(B,"title",e(R)),b(he,`${e(V)??""} tokens`)},[()=>e(w)||!e(h).trim()],Q),Ee(F,()=>e(h),t=>s(h,t)),oe("keydown",F,me),oe("submit",L,Se(W)),v(ve,K),Ce()}export{et as component};
//# sourceMappingURL=3.BU5JN6ML.js.map
