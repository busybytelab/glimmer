var Tn=Object.defineProperty;var On=(r,t,e)=>t in r?Tn(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var kr=(r,t,e)=>On(r,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=e(n);fetch(n.href,s)}})();const la=!1;var Ht=Array.isArray,An=Array.prototype.indexOf,Hr=Array.from,$a=Object.defineProperty,Ct=Object.getOwnPropertyDescriptor,Ia=Object.getOwnPropertyDescriptors,Pn=Object.prototype,$n=Array.prototype,Gr=Object.getPrototypeOf,ca=Object.isExtensible;const Et=()=>{};function In(r){return r()}function Lr(r){for(var t=0;t<r.length;t++)r[t]()}const Ve=2,La=4,ur=8,Vr=16,tt=32,At=64,ar=128,Be=256,nr=512,De=1024,Qe=2048,ht=4096,et=8192,fr=16384,Ln=32768,Wr=65536,Ra=1<<17,Rn=1<<19,ja=1<<20,Rr=1<<21,ut=Symbol("$state"),jn=Symbol("legacy props"),qn=Symbol("");function qa(r){return r===this.v}function Da(r,t){return r!=r?t==t:r!==t||r!==null&&typeof r=="object"||typeof r=="function"}function Kr(r){return!Da(r,this.v)}function Dn(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Fn(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Nn(r){throw new Error("https://svelte.dev/e/effect_orphan")}function Mn(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Un(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function Bn(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function zn(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Hn(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Pt=!1,Gn=!1;function Vn(){Pt=!0}const Yr=1,Jr=2,Fa=4,Wn=8,Kn=16,Yn=1,Jn=2,Qn=4,Zn=8,Xn=16,Na=1,es=2,Ne=Symbol(),ts="http://www.w3.org/1999/xhtml";function Ma(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let he=null;function da(r){he=r}function we(r,t=!1,e){var a=he={p:he,c:null,d:!1,e:null,m:!1,s:r,x:null,l:null};Pt&&!t&&(he.l={s:null,u:null,r1:[],r2:Mt(!1)}),Qr(()=>{a.d=!0})}function Se(r){const t=he;if(t!==null){const o=t.e;if(o!==null){var e=ue,a=pe;t.e=null;try{for(var n=0;n<o.length;n++){var s=o[n];pt(s.effect),Ze(s.reaction),hr(s.fn)}}finally{pt(e),Ze(a)}}he=t.p,t.m=!0}return{}}function Gt(){return!Pt||he!==null&&he.l===null}function gt(r){if(typeof r!="object"||r===null||ut in r)return r;const t=Gr(r);if(t!==Pn&&t!==$n)return r;var e=new Map,a=Ht(r),n=st(0),s=pe,o=l=>{var c=pe;Ze(s);var u=l();return Ze(c),u};return a&&e.set("length",st(r.length)),new Proxy(r,{defineProperty(l,c,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Bn();var k=e.get(c);return k===void 0?(k=o(()=>st(u.value)),e.set(c,k)):y(k,o(()=>gt(u.value))),!0},deleteProperty(l,c){var u=e.get(c);if(u===void 0)c in l&&(e.set(c,o(()=>st(Ne))),Cr(n));else{if(a&&typeof c=="string"){var k=e.get("length"),v=Number(c);Number.isInteger(v)&&v<k.v&&y(k,v)}y(u,Ne),Cr(n)}return!0},get(l,c,u){var g;if(c===ut)return r;var k=e.get(c),v=c in l;if(k===void 0&&(!v||(g=Ct(l,c))!=null&&g.writable)&&(k=o(()=>st(gt(v?l[c]:Ne))),e.set(c,k)),k!==void 0){var p=i(k);return p===Ne?void 0:p}return Reflect.get(l,c,u)},getOwnPropertyDescriptor(l,c){var u=Reflect.getOwnPropertyDescriptor(l,c);if(u&&"value"in u){var k=e.get(c);k&&(u.value=i(k))}else if(u===void 0){var v=e.get(c),p=v==null?void 0:v.v;if(v!==void 0&&p!==Ne)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return u},has(l,c){var p;if(c===ut)return!0;var u=e.get(c),k=u!==void 0&&u.v!==Ne||Reflect.has(l,c);if(u!==void 0||ue!==null&&(!k||(p=Ct(l,c))!=null&&p.writable)){u===void 0&&(u=o(()=>st(k?gt(l[c]):Ne)),e.set(c,u));var v=i(u);if(v===Ne)return!1}return k},set(l,c,u,k){var A;var v=e.get(c),p=c in l;if(a&&c==="length")for(var g=u;g<v.v;g+=1){var m=e.get(g+"");m!==void 0?y(m,Ne):g in l&&(m=o(()=>st(Ne)),e.set(g+"",m))}v===void 0?(!p||(A=Ct(l,c))!=null&&A.writable)&&(v=o(()=>st(void 0)),y(v,o(()=>gt(u))),e.set(c,v)):(p=v.v!==Ne,y(v,o(()=>gt(u))));var f=Reflect.getOwnPropertyDescriptor(l,c);if(f!=null&&f.set&&f.set.call(k,u),!p){if(a&&typeof c=="string"){var _=e.get("length"),T=Number(c);Number.isInteger(T)&&T>=_.v&&y(_,T+1)}Cr(n)}return!0},ownKeys(l){i(n);var c=Reflect.ownKeys(l).filter(v=>{var p=e.get(v);return p===void 0||p.v!==Ne});for(var[u,k]of e)k.v!==Ne&&!(u in l)&&c.push(u);return c},setPrototypeOf(){zn()}})}function Cr(r,t=1){y(r,r.v+t)}function ua(r){try{if(r!==null&&typeof r=="object"&&ut in r)return r[ut]}catch{}return r}function rs(r,t){return Object.is(ua(r),ua(t))}function Ft(r){var t=Ve|Qe,e=pe!==null&&(pe.f&Ve)!==0?pe:null;return ue===null||e!==null&&(e.f&Be)!==0?t|=Be:ue.f|=ja,{ctx:he,deps:null,effects:null,equals:qa,f:t,fn:r,reactions:null,rv:0,v:null,wv:0,parent:e??ue}}function Oe(r){const t=Ft(r);return t.equals=Kr,t}function Ua(r){var t=r.effects;if(t!==null){r.effects=null;for(var e=0;e<t.length;e+=1)vt(t[e])}}function as(r){for(var t=r.parent;t!==null;){if((t.f&Ve)===0)return t;t=t.parent}return null}function Ba(r){var t,e=ue;pt(as(r));try{Ua(r),t=sn(r)}finally{pt(e)}return t}function za(r){var t=Ba(r),e=(dt||(r.f&Be)!==0)&&r.deps!==null?ht:De;We(r,e),r.equals(t)||(r.v=t,r.wv=an())}const Nt=new Map;function Mt(r,t){var e={f:0,v:r,reactions:null,equals:qa,rv:0,wv:0};return e}function st(r,t){const e=Mt(r);return fs(e),e}function U(r,t=!1){var a;const e=Mt(r);return t||(e.equals=Kr),Pt&&he!==null&&he.l!==null&&((a=he.l).s??(a.s=[])).push(e),e}function xe(r,t){return y(r,Ye(()=>i(r))),t}function y(r,t,e=!1){pe!==null&&!Je&&Gt()&&(pe.f&(Ve|Vr))!==0&&!(qe!=null&&qe.includes(r))&&Hn();let a=e?gt(t):t;return Ut(r,a)}function Ut(r,t){if(!r.equals(t)){var e=r.v;Kt?Nt.set(r,t):Nt.set(r,e),r.v=t,(r.f&Ve)!==0&&((r.f&Qe)!==0&&Ba(r),We(r,(r.f&Be)===0?De:ht)),r.wv=an(),Ha(r,Qe),Gt()&&ue!==null&&(ue.f&De)!==0&&(ue.f&(tt|At))===0&&(Ge===null?vs([r]):Ge.push(r))}return t}function Ha(r,t){var e=r.reactions;if(e!==null)for(var a=Gt(),n=e.length,s=0;s<n;s++){var o=e[s],l=o.f;(l&Qe)===0&&(!a&&o===ue||(We(o,t),(l&(De|Be))!==0&&((l&Ve)!==0?Ha(o,ht):br(o))))}}let ns=!1;var fa,Ga,Va,Wa;function ss(){if(fa===void 0){fa=window,Ga=/Firefox/.test(navigator.userAgent);var r=Element.prototype,t=Node.prototype,e=Text.prototype;Va=Ct(t,"firstChild").get,Wa=Ct(t,"nextSibling").get,ca(r)&&(r.__click=void 0,r.__className=void 0,r.__attributes=null,r.__style=void 0,r.__e=void 0),ca(e)&&(e.__t=void 0)}}function vr(r=""){return document.createTextNode(r)}function Ue(r){return Va.call(r)}function pr(r){return Wa.call(r)}function d(r,t){return Ue(r)}function ve(r,t){{var e=Ue(r);return e instanceof Comment&&e.data===""?pr(e):e}}function b(r,t=1,e=!1){let a=r;for(;t--;)a=pr(a);return a}function is(r){r.textContent=""}function Ka(r){ue===null&&pe===null&&Nn(),pe!==null&&(pe.f&Be)!==0&&ue===null&&Fn(),Kt&&Dn()}function os(r,t){var e=t.last;e===null?t.last=t.first=r:(e.next=r,r.prev=e,t.last=r)}function $t(r,t,e,a=!0){var n=ue,s={ctx:he,deps:null,nodes_start:null,nodes_end:null,f:r|Qe,first:null,fn:t,last:null,next:null,parent:n,prev:null,teardown:null,transitions:null,wv:0};if(e)try{mr(s),s.f|=Ln}catch(c){throw vt(s),c}else t!==null&&br(s);var o=e&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(ja|ar))===0;if(!o&&a&&(n!==null&&os(s,n),pe!==null&&(pe.f&Ve)!==0)){var l=pe;(l.effects??(l.effects=[])).push(s)}return s}function Qr(r){const t=$t(ur,null,!1);return We(t,De),t.teardown=r,t}function jr(r){Ka();var t=ue!==null&&(ue.f&tt)!==0&&he!==null&&!he.m;if(t){var e=he;(e.e??(e.e=[])).push({fn:r,effect:ue,reaction:pe})}else{var a=hr(r);return a}}function ls(r){return Ka(),Wt(r)}function cs(r){const t=$t(At,r,!0);return(e={})=>new Promise(a=>{e.outro?sr(t,()=>{vt(t),a(void 0)}):(vt(t),a(void 0))})}function hr(r){return $t(La,r,!1)}function ft(r,t){var e=he,a={effect:null,ran:!1};e.l.r1.push(a),a.effect=Wt(()=>{r(),!a.ran&&(a.ran=!0,y(e.l.r2,!0),Ye(t))})}function Vt(){var r=he;Wt(()=>{if(i(r.l.r2)){for(var t of r.l.r1){var e=t.effect;(e.f&De)!==0&&We(e,ht),It(e)&&mr(e),t.ran=!1}r.l.r2.v=!1}})}function Wt(r){return $t(ur,r,!0)}function L(r,t=[],e=Ft){const a=t.map(e);return Zr(()=>r(...a.map(i)))}function Zr(r,t=0){return $t(ur|Vr|t,r,!0)}function Bt(r,t=!0){return $t(ur|tt,r,!0,t)}function Ya(r){var t=r.teardown;if(t!==null){const e=Kt,a=pe;va(!0),Ze(null);try{t.call(null)}finally{va(e),Ze(a)}}}function Ja(r,t=!1){var e=r.first;for(r.first=r.last=null;e!==null;){var a=e.next;(e.f&At)!==0?e.parent=null:vt(e,t),e=a}}function ds(r){for(var t=r.first;t!==null;){var e=t.next;(t.f&tt)===0&&vt(t),t=e}}function vt(r,t=!0){var e=!1;(t||(r.f&Rn)!==0)&&r.nodes_start!==null&&(Qa(r.nodes_start,r.nodes_end),e=!0),Ja(r,t&&!e),dr(r,0),We(r,fr);var a=r.transitions;if(a!==null)for(const s of a)s.stop();Ya(r);var n=r.parent;n!==null&&n.first!==null&&Za(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=null}function Qa(r,t){for(;r!==null;){var e=r===t?null:pr(r);r.remove(),r=e}}function Za(r){var t=r.parent,e=r.prev,a=r.next;e!==null&&(e.next=a),a!==null&&(a.prev=e),t!==null&&(t.first===r&&(t.first=a),t.last===r&&(t.last=e))}function sr(r,t){var e=[];Xr(r,e,!0),Xa(e,()=>{vt(r),t&&t()})}function Xa(r,t){var e=r.length;if(e>0){var a=()=>--e||t();for(var n of r)n.out(a)}else t()}function Xr(r,t,e){if((r.f&et)===0){if(r.f^=et,r.transitions!==null)for(const o of r.transitions)(o.is_global||e)&&t.push(o);for(var a=r.first;a!==null;){var n=a.next,s=(a.f&Wr)!==0||(a.f&tt)!==0;Xr(a,t,s?e:!1),a=n}}}function ir(r){en(r,!0)}function en(r,t){if((r.f&et)!==0){r.f^=et,(r.f&De)===0&&(r.f^=De),It(r)&&(We(r,Qe),br(r));for(var e=r.first;e!==null;){var a=e.next,n=(e.f&Wr)!==0||(e.f&tt)!==0;en(e,n?t:!1),e=a}if(r.transitions!==null)for(const s of r.transitions)(s.is_global||t)&&s.in()}}let or=[];function us(){var r=or;or=[],Lr(r)}function tn(r){or.length===0&&queueMicrotask(us),or.push(r)}let tr=!1,qr=!1,lr=null,yt=!1,Kt=!1;function va(r){Kt=r}let rr=[];let pe=null,Je=!1;function Ze(r){pe=r}let ue=null;function pt(r){ue=r}let qe=null;function fs(r){pe!==null&&pe.f&Rr&&(qe===null?qe=[r]:qe.push(r))}let je=null,Me=0,Ge=null;function vs(r){Ge=r}let rn=1,cr=0,dt=!1,ct=null;function an(){return++rn}function It(r){var v;var t=r.f;if((t&Qe)!==0)return!0;if((t&ht)!==0){var e=r.deps,a=(t&Be)!==0;if(e!==null){var n,s,o=(t&nr)!==0,l=a&&ue!==null&&!dt,c=e.length;if(o||l){var u=r,k=u.parent;for(n=0;n<c;n++)s=e[n],(o||!((v=s==null?void 0:s.reactions)!=null&&v.includes(u)))&&(s.reactions??(s.reactions=[])).push(u);o&&(u.f^=nr),l&&k!==null&&(k.f&Be)===0&&(u.f^=Be)}for(n=0;n<c;n++)if(s=e[n],It(s)&&za(s),s.wv>r.wv)return!0}(!a||ue!==null&&!dt)&&We(r,De)}return!1}function ps(r,t){for(var e=t;e!==null;){if((e.f&ar)!==0)try{e.fn(r);return}catch{e.f^=ar}e=e.parent}throw tr=!1,r}function pa(r){return(r.f&fr)===0&&(r.parent===null||(r.parent.f&ar)===0)}function gr(r,t,e,a){if(tr){if(e===null&&(tr=!1),pa(t))throw r;return}if(e!==null&&(tr=!0),ps(r,t),pa(t))throw r}function nn(r,t,e=!0){var a=r.reactions;if(a!==null)for(var n=0;n<a.length;n++){var s=a[n];qe!=null&&qe.includes(r)||((s.f&Ve)!==0?nn(s,t,!1):t===s&&(e?We(s,Qe):(s.f&De)!==0&&We(s,ht),br(s)))}}function sn(r){var g;var t=je,e=Me,a=Ge,n=pe,s=dt,o=qe,l=he,c=Je,u=r.f;je=null,Me=0,Ge=null,dt=(u&Be)!==0&&(Je||!yt||pe===null),pe=(u&(tt|At))===0?r:null,qe=null,da(r.ctx),Je=!1,cr++,r.f|=Rr;try{var k=(0,r.fn)(),v=r.deps;if(je!==null){var p;if(dr(r,Me),v!==null&&Me>0)for(v.length=Me+je.length,p=0;p<je.length;p++)v[Me+p]=je[p];else r.deps=v=je;if(!dt)for(p=Me;p<v.length;p++)((g=v[p]).reactions??(g.reactions=[])).push(r)}else v!==null&&Me<v.length&&(dr(r,Me),v.length=Me);if(Gt()&&Ge!==null&&!Je&&v!==null&&(r.f&(Ve|ht|Qe))===0)for(p=0;p<Ge.length;p++)nn(Ge[p],r);return n!==null&&n!==r&&(cr++,Ge!==null&&(a===null?a=Ge:a.push(...Ge))),k}finally{je=t,Me=e,Ge=a,pe=n,dt=s,qe=o,da(l),Je=c,r.f^=Rr}}function hs(r,t){let e=t.reactions;if(e!==null){var a=An.call(e,r);if(a!==-1){var n=e.length-1;n===0?e=t.reactions=null:(e[a]=e[n],e.pop())}}e===null&&(t.f&Ve)!==0&&(je===null||!je.includes(t))&&(We(t,ht),(t.f&(Be|nr))===0&&(t.f^=nr),Ua(t),dr(t,0))}function dr(r,t){var e=r.deps;if(e!==null)for(var a=t;a<e.length;a++)hs(r,e[a])}function mr(r){var t=r.f;if((t&fr)===0){We(r,De);var e=ue,a=he,n=yt;ue=r,yt=!0;try{(t&Vr)!==0?ds(r):Ja(r),Ya(r);var s=sn(r);r.teardown=typeof s=="function"?s:null,r.wv=rn;var o=r.deps,l;la&&Gn&&r.f&Qe}catch(c){gr(c,r,e,a||r.ctx)}finally{yt=n,ue=e}}}function gs(){try{Mn()}catch(r){if(lr!==null)gr(r,lr,null);else throw r}}function ms(){var r=yt;try{var t=0;for(yt=!0;rr.length>0;){t++>1e3&&gs();var e=rr,a=e.length;rr=[];for(var n=0;n<a;n++){var s=_s(e[n]);bs(s)}Nt.clear()}}finally{qr=!1,yt=r,lr=null}}function bs(r){var t=r.length;if(t!==0)for(var e=0;e<t;e++){var a=r[e];if((a.f&(fr|et))===0)try{It(a)&&(mr(a),a.deps===null&&a.first===null&&a.nodes_start===null&&(a.teardown===null?Za(a):a.fn=null))}catch(n){gr(n,a,null,a.ctx)}}}function br(r){qr||(qr=!0,queueMicrotask(ms));for(var t=lr=r;t.parent!==null;){t=t.parent;var e=t.f;if((e&(At|tt))!==0){if((e&De)===0)return;t.f^=De}}rr.push(t)}function _s(r){for(var t=[],e=r;e!==null;){var a=e.f,n=(a&(tt|At))!==0,s=n&&(a&De)!==0;if(!s&&(a&et)===0){if((a&La)!==0)t.push(e);else if(n)e.f^=De;else try{It(e)&&mr(e)}catch(c){gr(c,e,null,e.ctx)}var o=e.first;if(o!==null){e=o;continue}}var l=e.parent;for(e=e.next;e===null&&l!==null;)e=l.next,l=l.parent}return t}function i(r){var t=r.f,e=(t&Ve)!==0;if(ct!==null&&ct.add(r),pe!==null&&!Je){if(!(qe!=null&&qe.includes(r))){var a=pe.deps;r.rv<cr&&(r.rv=cr,je===null&&a!==null&&a[Me]===r?Me++:je===null?je=[r]:(!dt||!je.includes(r))&&je.push(r))}}else if(e&&r.deps===null&&r.effects===null){var n=r,s=n.parent;s!==null&&(s.f&Be)===0&&(n.f^=Be)}return e&&(n=r,It(n)&&za(n)),Kt&&Nt.has(r)?Nt.get(r):r.v}function ys(r){var t=ct;ct=new Set;var e=ct,a;try{if(Ye(r),t!==null)for(a of ct)t.add(a)}finally{ct=t}return e}function xs(r){var t=ys(()=>Ye(r));for(var e of t)if((e.f&Ra)!==0)for(const a of e.deps||[])(a.f&Ve)===0&&Ut(a,a.v);else Ut(e,e.v)}function Ye(r){var t=Je;try{return Je=!0,r()}finally{Je=t}}const ws=-7169;function We(r,t){r.f=r.f&ws|t}function _t(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(ut in r)Dr(r);else if(!Array.isArray(r))for(let t in r){const e=r[t];typeof e=="object"&&e&&ut in e&&Dr(e)}}}function Dr(r,t=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!t.has(r)){t.add(r),r instanceof Date&&r.getTime();for(let a in r)try{Dr(r[a],t)}catch{}const e=Gr(r);if(e!==Object.prototype&&e!==Array.prototype&&e!==Map.prototype&&e!==Set.prototype&&e!==Date.prototype){const a=Ia(e);for(let n in a){const s=a[n].get;if(s)try{s.call(r)}catch{}}}}}const Ss=["touchstart","touchmove"];function ks(r){return Ss.includes(r)}let ha=!1;function Cs(){ha||(ha=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var t;if(!r.defaultPrevented)for(const e of r.target.elements)(t=e.__on_r)==null||t.call(e)})},{capture:!0}))}function on(r){var t=pe,e=ue;Ze(null),pt(null);try{return r()}finally{Ze(t),pt(e)}}function ea(r,t,e,a=e){r.addEventListener(t,()=>on(e));const n=r.__on_r;n?r.__on_r=()=>{n(),a(!0)}:r.__on_r=()=>a(!0),Cs()}const Es=new Set,ga=new Set;function Ts(r,t,e,a={}){function n(s){if(a.capture||jt.call(t,s),!s.cancelBubble)return on(()=>e==null?void 0:e.call(this,s))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?tn(()=>{t.addEventListener(r,n,a)}):t.addEventListener(r,n,a),n}function fe(r,t,e,a,n){var s={capture:a,passive:n},o=Ts(r,t,e,s);(t===document.body||t===window||t===document)&&Qr(()=>{t.removeEventListener(r,o,s)})}function jt(r){var A;var t=this,e=t.ownerDocument,a=r.type,n=((A=r.composedPath)==null?void 0:A.call(r))||[],s=n[0]||r.target,o=0,l=r.__root;if(l){var c=n.indexOf(l);if(c!==-1&&(t===document||t===window)){r.__root=t;return}var u=n.indexOf(t);if(u===-1)return;c<=u&&(o=c)}if(s=n[o]||r.target,s!==t){$a(r,"currentTarget",{configurable:!0,get(){return s||e}});var k=pe,v=ue;Ze(null),pt(null);try{for(var p,g=[];s!==null;){var m=s.assignedSlot||s.parentNode||s.host||null;try{var f=s["__"+a];if(f!=null&&(!s.disabled||r.target===s))if(Ht(f)){var[_,...T]=f;_.apply(s,[r,...T])}else f.call(s,r)}catch(C){p?g.push(C):p=C}if(r.cancelBubble||m===t||m===null)break;s=m}if(p){for(let C of g)queueMicrotask(()=>{throw C});throw p}}finally{r.__root=t,delete r.currentTarget,Ze(k),pt(v)}}}function ta(r){var t=document.createElement("template");return t.innerHTML=r,t.content}function xt(r,t){var e=ue;e.nodes_start===null&&(e.nodes_start=r,e.nodes_end=t)}function S(r,t){var e=(t&Na)!==0,a=(t&es)!==0,n,s=!r.startsWith("<!>");return()=>{n===void 0&&(n=ta(s?r:"<!>"+r),e||(n=Ue(n)));var o=a||Ga?document.importNode(n,!0):n.cloneNode(!0);if(e){var l=Ue(o),c=o.lastChild;xt(l,c)}else xt(o,o);return o}}function Yt(r,t,e="svg"){var a=!r.startsWith("<!>"),n=(t&Na)!==0,s=`<${e}>${a?r:"<!>"+r}</${e}>`,o;return()=>{if(!o){var l=ta(s),c=Ue(l);if(n)for(o=document.createDocumentFragment();Ue(c);)o.appendChild(Ue(c));else o=Ue(c)}var u=o.cloneNode(!0);if(n){var k=Ue(u),v=u.lastChild;xt(k,v)}else xt(u,u);return u}}function Re(r=""){{var t=vr(r+"");return xt(t,t),t}}function Ke(){var r=document.createDocumentFragment(),t=document.createComment(""),e=vr();return r.append(t,e),xt(t,e),r}function h(r,t){r!==null&&r.before(t)}function R(r,t){var e=t==null?"":typeof t=="object"?t+"":t;e!==(r.__t??(r.__t=r.nodeValue))&&(r.__t=e,r.nodeValue=e+"")}function Os(r,t){return As(r,t)}const St=new Map;function As(r,{target:t,anchor:e,props:a={},events:n,context:s,intro:o=!0}){ss();var l=new Set,c=v=>{for(var p=0;p<v.length;p++){var g=v[p];if(!l.has(g)){l.add(g);var m=ks(g);t.addEventListener(g,jt,{passive:m});var f=St.get(g);f===void 0?(document.addEventListener(g,jt,{passive:m}),St.set(g,1)):St.set(g,f+1)}}};c(Hr(Es)),ga.add(c);var u=void 0,k=cs(()=>{var v=e??t.appendChild(vr());return Bt(()=>{if(s){we({});var p=he;p.c=s}n&&(a.$$events=n),u=r(v,a)||{},s&&Se()}),()=>{var m;for(var p of l){t.removeEventListener(p,jt);var g=St.get(p);--g===0?(document.removeEventListener(p,jt),St.delete(p)):St.set(p,g)}ga.delete(c),v!==e&&((m=v.parentNode)==null||m.removeChild(v))}});return Ps.set(u,k),u}let Ps=new WeakMap;function O(r,t,[e,a]=[0,0]){var n=r,s=null,o=null,l=Ne,c=e>0?Wr:0,u=!1;const k=(p,g=!0)=>{u=!0,v(g,p)},v=(p,g)=>{l!==(l=p)&&(l?(s?ir(s):g&&(s=Bt(()=>g(n))),o&&sr(o,()=>{o=null})):(o?ir(o):g&&(o=Bt(()=>g(n,[e+1,a]))),s&&sr(s,()=>{s=null})))};Zr(()=>{u=!1,t(k),u||v(null,null)},c)}function $e(r,t){return t}function $s(r,t,e,a){for(var n=[],s=t.length,o=0;o<s;o++)Xr(t[o].e,n,!0);var l=s>0&&n.length===0&&e!==null;if(l){var c=e.parentNode;is(c),c.append(e),a.clear(),lt(r,t[0].prev,t[s-1].next)}Xa(n,()=>{for(var u=0;u<s;u++){var k=t[u];l||(a.delete(k.k),lt(r,k.prev,k.next)),vt(k.e,!l)}})}function Ie(r,t,e,a,n,s=null){var o=r,l={flags:t,items:new Map,first:null},c=(t&Fa)!==0;if(c){var u=r;o=u.appendChild(vr())}var k=null,v=!1,p=Oe(()=>{var g=e();return Ht(g)?g:g==null?[]:Hr(g)});Zr(()=>{var g=i(p),m=g.length;v&&m===0||(v=m===0,Is(g,l,o,n,t,a,e),s!==null&&(m===0?k?ir(k):k=Bt(()=>s(o)):k!==null&&sr(k,()=>{k=null})),i(p))})}function Is(r,t,e,a,n,s,o){var N,K,Y,X;var l=(n&Wn)!==0,c=(n&(Yr|Jr))!==0,u=r.length,k=t.items,v=t.first,p=v,g,m=null,f,_=[],T=[],A,C,w,x;if(l)for(x=0;x<u;x+=1)A=r[x],C=s(A,x),w=k.get(C),w!==void 0&&((N=w.a)==null||N.measure(),(f??(f=new Set)).add(w));for(x=0;x<u;x+=1){if(A=r[x],C=s(A,x),w=k.get(C),w===void 0){var E=p?p.e.nodes_start:e;m=Rs(E,t,m,m===null?t.first:m.next,A,C,x,a,n,o),k.set(C,m),_=[],T=[],p=m.next;continue}if(c&&Ls(w,A,x,n),(w.e.f&et)!==0&&(ir(w.e),l&&((K=w.a)==null||K.unfix(),(f??(f=new Set)).delete(w))),w!==p){if(g!==void 0&&g.has(w)){if(_.length<T.length){var I=T[0],P;m=I.prev;var D=_[0],H=_[_.length-1];for(P=0;P<_.length;P+=1)ma(_[P],I,e);for(P=0;P<T.length;P+=1)g.delete(T[P]);lt(t,D.prev,H.next),lt(t,m,D),lt(t,H,I),p=I,m=H,x-=1,_=[],T=[]}else g.delete(w),ma(w,p,e),lt(t,w.prev,w.next),lt(t,w,m===null?t.first:m.next),lt(t,m,w),m=w;continue}for(_=[],T=[];p!==null&&p.k!==C;)(p.e.f&et)===0&&(g??(g=new Set)).add(p),T.push(p),p=p.next;if(p===null)continue;w=p}_.push(w),m=w,p=w.next}if(p!==null||g!==void 0){for(var B=g===void 0?[]:Hr(g);p!==null;)(p.e.f&et)===0&&B.push(p),p=p.next;var z=B.length;if(z>0){var q=(n&Fa)!==0&&u===0?e:null;if(l){for(x=0;x<z;x+=1)(Y=B[x].a)==null||Y.measure();for(x=0;x<z;x+=1)(X=B[x].a)==null||X.fix()}$s(t,B,q,k)}}l&&tn(()=>{var F;if(f!==void 0)for(w of f)(F=w.a)==null||F.apply()}),ue.first=t.first&&t.first.e,ue.last=m&&m.e}function Ls(r,t,e,a){(a&Yr)!==0&&Ut(r.v,t),(a&Jr)!==0?Ut(r.i,e):r.i=e}function Rs(r,t,e,a,n,s,o,l,c,u){var k=(c&Yr)!==0,v=(c&Kn)===0,p=k?v?U(n):Mt(n):n,g=(c&Jr)===0?o:Mt(o),m={i:g,v:p,k:s,a:null,e:null,prev:e,next:a};try{return m.e=Bt(()=>l(r,p,g,u),ns),m.e.prev=e&&e.e,m.e.next=a&&a.e,e===null?t.first=m:(e.next=m,e.e.next=m.e),a!==null&&(a.prev=m,a.e.prev=m.e),m}finally{}}function ma(r,t,e){for(var a=r.next?r.next.e.nodes_start:e,n=t?t.e.nodes_start:e,s=r.e.nodes_start;s!==a;){var o=pr(s);n.before(s),s=o}}function lt(r,t,e){t===null?r.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function js(r,t,e=!1,a=!1,n=!1){var s=r,o="";L(()=>{var l=ue;if(o!==(o=t()??"")&&(l.nodes_start!==null&&(Qa(l.nodes_start,l.nodes_end),l.nodes_start=l.nodes_end=null),o!=="")){var c=o+"";e?c=`<svg>${c}</svg>`:a&&(c=`<math>${c}</math>`);var u=ta(c);if((e||a)&&(u=Ue(u)),xt(Ue(u),u.lastChild),e||a)for(;Ue(u);)s.before(Ue(u));else s.before(u)}})}function _r(r,t,e,a,n){var l;var s=(l=t.$$slots)==null?void 0:l[e],o=!1;s===!0&&(s=t.children,o=!0),s===void 0?n!==null&&n(r):s(r,o?()=>a:a)}function qs(r,t,e){var a=r==null?"":""+r;return t&&(a=a?a+" "+t:t),a===""?null:a}function Ce(r,t,e,a,n,s){var o=r.__className;if(o!==e||o===void 0){var l=qs(e,a);l==null?r.removeAttribute("class"):r.className=l,r.__className=e}return s}const Ds=Symbol("is custom element"),Fs=Symbol("is html");function Ns(r,t){var e=ln(r);e.value===(e.value=t??void 0)||r.value===t&&(t!==0||r.nodeName!=="PROGRESS")||(r.value=t??"")}function te(r,t,e,a){var n=ln(r);n[t]!==(n[t]=e)&&(t==="loading"&&(r[qn]=e),e==null?r.removeAttribute(t):typeof e!="string"&&Ms(r).includes(t)?r[t]=e:r.setAttribute(t,e))}function ln(r){return r.__attributes??(r.__attributes={[Ds]:r.nodeName.includes("-"),[Fs]:r.namespaceURI===ts})}var ba=new Map;function Ms(r){var t=ba.get(r.nodeName);if(t)return t;ba.set(r.nodeName,t=[]);for(var e,a=r,n=Element.prototype;n!==a;){e=Ia(a);for(var s in e)e[s].set&&t.push(s);a=Gr(a)}return t}function zt(r,t,e=t){var a=Gt();ea(r,"input",n=>{var s=n?r.defaultValue:r.value;if(s=Er(r)?Tr(s):s,e(s),a&&s!==(s=t())){var o=r.selectionStart,l=r.selectionEnd;r.value=s??"",l!==null&&(r.selectionStart=o,r.selectionEnd=Math.min(l,r.value.length))}}),Ye(t)==null&&r.value&&e(Er(r)?Tr(r.value):r.value),Wt(()=>{var n=t();Er(r)&&n===Tr(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function Us(r,t,e=t){ea(r,"change",a=>{var n=a?r.defaultChecked:r.checked;e(n)}),Ye(t)==null&&e(r.checked),Wt(()=>{var a=t();r.checked=!!a})}function Er(r){var t=r.type;return t==="number"||t==="range"}function Tr(r){return r===""?null:+r}function cn(r,t,e){if(r.multiple)return Hs(r,t);for(var a of r.options){var n=Dt(a);if(rs(n,t)){a.selected=!0;return}}(!e||t!==void 0)&&(r.selectedIndex=-1)}function Bs(r,t){hr(()=>{var e=new MutationObserver(()=>{var a=r.__value;cn(r,a)});return e.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{e.disconnect()}})}function zs(r,t,e=t){var a=!0;ea(r,"change",n=>{var s=n?"[selected]":":checked",o;if(r.multiple)o=[].map.call(r.querySelectorAll(s),Dt);else{var l=r.querySelector(s)??r.querySelector("option:not([disabled])");o=l&&Dt(l)}e(o)}),hr(()=>{var n=t();if(cn(r,n,a),a&&n===void 0){var s=r.querySelector(":checked");s!==null&&(n=Dt(s),e(n))}r.__value=n,a=!1}),Bs(r)}function Hs(r,t){for(var e of r.options)e.selected=~t.indexOf(Dt(e))}function Dt(r){return"__value"in r?r.__value:r.value}function qt(r){return function(...t){var e=t[0];return e.stopPropagation(),r==null?void 0:r.apply(this,t)}}function ra(r){return function(...t){var e=t[0];return e.preventDefault(),r==null?void 0:r.apply(this,t)}}function Ee(r=!1){const t=he,e=t.l.u;if(!e)return;let a=()=>_t(t.s);if(r){let n=0,s={};const o=Ft(()=>{let l=!1;const c=t.s;for(const u in c)c[u]!==s[u]&&(s[u]=c[u],l=!0);return l&&n++,n});a=()=>i(o)}e.b.length&&ls(()=>{_a(t,a),Lr(e.b)}),jr(()=>{const n=Ye(()=>e.m.map(In));return()=>{for(const s of n)typeof s=="function"&&s()}}),e.a.length&&jr(()=>{_a(t,a),Lr(e.a)})}function _a(r,t){if(r.l.s)for(const e of r.l.s)i(e);t()}function dn(r,t){var s;var e=(s=r.$$events)==null?void 0:s[t.type],a=Ht(e)?e.slice():e==null?[]:[e];for(var n of a)n.call(this,t)}function un(r,t,e){if(r==null)return t(void 0),Et;const a=Ye(()=>r.subscribe(t,e));return a.unsubscribe?()=>a.unsubscribe():a}const kt=[];function yr(r,t=Et){let e=null;const a=new Set;function n(l){if(Da(r,l)&&(r=l,e)){const c=!kt.length;for(const u of a)u[1](),kt.push(u,r);if(c){for(let u=0;u<kt.length;u+=2)kt[u][0](kt[u+1]);kt.length=0}}}function s(l){n(l(r))}function o(l,c=Et){const u=[l,c];return a.add(u),a.size===1&&(e=t(n,s)||Et),l(r),()=>{a.delete(u),a.size===0&&e&&(e(),e=null)}}return{set:n,update:s,subscribe:o}}function Gs(r){let t;return un(r,e=>t=e)(),t}let Zt=!1,Fr=Symbol();function Xe(r,t,e){const a=e[t]??(e[t]={store:null,source:U(void 0),unsubscribe:Et});if(a.store!==r&&!(Fr in e))if(a.unsubscribe(),a.store=r??null,r==null)a.source.v=void 0,a.unsubscribe=Et;else{var n=!0;a.unsubscribe=un(r,s=>{n?a.source.v=s:y(a.source,s)}),n=!1}return r&&Fr in e?Gs(r):i(a.source)}function Lt(){const r={};function t(){Qr(()=>{for(var e in r)r[e].unsubscribe();$a(r,Fr,{enumerable:!1,value:!0})})}return[r,t]}function Vs(r){var t=Zt;try{return Zt=!1,[r(),Zt]}finally{Zt=t}}function ya(r){var t;return((t=r.ctx)==null?void 0:t.d)??!1}function j(r,t,e,a){var I;var n=(e&Yn)!==0,s=!Pt||(e&Jn)!==0,o=(e&Zn)!==0,l=(e&Xn)!==0,c=!1,u;o?[u,c]=Vs(()=>r[t]):u=r[t];var k=ut in r||jn in r,v=o&&(((I=Ct(r,t))==null?void 0:I.set)??(k&&t in r&&(P=>r[t]=P)))||void 0,p=a,g=!0,m=!1,f=()=>(m=!0,g&&(g=!1,l?p=Ye(a):p=a),p);u===void 0&&a!==void 0&&(v&&s&&Un(),u=f(),v&&v(u));var _;if(s)_=()=>{var P=r[t];return P===void 0?f():(g=!0,m=!1,P)};else{var T=(n?Ft:Oe)(()=>r[t]);T.f|=Ra,_=()=>{var P=i(T);return P!==void 0&&(p=void 0),P===void 0?p:P}}if((e&Qn)===0)return _;if(v){var A=r.$$legacy;return function(P,D){return arguments.length>0?((!s||!D||A||c)&&v(D?_():P),P):_()}}var C=!1,w=!1,x=U(u),E=Ft(()=>{var P=_(),D=i(x);return C?(C=!1,w=!0,D):(w=!1,x.v=P)});return o&&i(E),n||(E.equals=Kr),function(P,D){if(ct!==null&&(C=w,_(),i(x)),arguments.length>0){const H=D?i(E):s&&o?gt(P):P;if(!E.equals(H)){if(C=!0,y(x,H),m&&p!==void 0&&(p=H),ya(E))return P;Ye(()=>i(E))}return P}return ya(E)?E.v:i(E)}}function rt(r){he===null&&Ma(),Pt&&he.l!==null?Ks(he).m.push(r):jr(()=>{const t=Ye(r);if(typeof t=="function")return t})}function Ws(r,t,{bubbles:e=!1,cancelable:a=!1}={}){return new CustomEvent(r,{detail:t,bubbles:e,cancelable:a})}function fn(){const r=he;return r===null&&Ma(),(t,e,a)=>{var s;const n=(s=r.s.$$events)==null?void 0:s[t];if(n){const o=Ht(n)?n.slice():[n],l=Ws(t,e,a);for(const c of o)c.call(r.x,l);return!l.defaultPrevented}return!0}}function Ks(r){var t=r.l;return t.u??(t.u={a:[],b:[],m:[]})}const Ys="5";var Pa;typeof window<"u"&&((Pa=window.__svelte??(window.__svelte={})).v??(Pa.v=new Set)).add(Ys);Vn();const Tt=yr(null),ot=yr(!1),Le=yr(null),Or=yr(!0);class ze extends Error{constructor(t){var e,a,n,s;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,ze.prototype),t!==null&&typeof t=="object"&&(this.url=typeof t.url=="string"?t.url:"",this.status=typeof t.status=="number"?t.status:0,this.isAbort=!!t.isAbort,this.originalError=t.originalError,t.response!==null&&typeof t.response=="object"?this.response=t.response:t.data!==null&&typeof t.data=="object"?this.response=t.data:this.response={}),this.originalError||t instanceof ze||(this.originalError=t),typeof DOMException<"u"&&t instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(e=this.response)==null?void 0:e.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(s=(n=(a=this.originalError)==null?void 0:a.cause)==null?void 0:n.message)!=null&&s.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}}const Xt=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function Js(r,t){const e={};if(typeof r!="string")return e;const a=Object.assign({},{}).decode||Qs;let n=0;for(;n<r.length;){const s=r.indexOf("=",n);if(s===-1)break;let o=r.indexOf(";",n);if(o===-1)o=r.length;else if(o<s){n=r.lastIndexOf(";",s-1)+1;continue}const l=r.slice(n,s).trim();if(e[l]===void 0){let c=r.slice(s+1,o).trim();c.charCodeAt(0)===34&&(c=c.slice(1,-1));try{e[l]=a(c)}catch{e[l]=c}}n=o+1}return e}function xa(r,t,e){const a=Object.assign({},e||{}),n=a.encode||Zs;if(!Xt.test(r))throw new TypeError("argument name is invalid");const s=n(t);if(s&&!Xt.test(s))throw new TypeError("argument val is invalid");let o=r+"="+s;if(a.maxAge!=null){const l=a.maxAge-0;if(isNaN(l)||!isFinite(l))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(l)}if(a.domain){if(!Xt.test(a.domain))throw new TypeError("option domain is invalid");o+="; Domain="+a.domain}if(a.path){if(!Xt.test(a.path))throw new TypeError("option path is invalid");o+="; Path="+a.path}if(a.expires){if(!function(c){return Object.prototype.toString.call(c)==="[object Date]"||c instanceof Date}(a.expires)||isNaN(a.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+a.expires.toUTCString()}if(a.httpOnly&&(o+="; HttpOnly"),a.secure&&(o+="; Secure"),a.priority)switch(typeof a.priority=="string"?a.priority.toLowerCase():a.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(a.sameSite)switch(typeof a.sameSite=="string"?a.sameSite.toLowerCase():a.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function Qs(r){return r.indexOf("%")!==-1?decodeURIComponent(r):r}function Zs(r){return encodeURIComponent(r)}const Xs=typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal;let vn;function Ot(r){if(r)try{const t=decodeURIComponent(vn(r.split(".")[1]).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(t)||{}}catch{}return{}}function pn(r,t=0){let e=Ot(r);return!(Object.keys(e).length>0&&(!e.exp||e.exp-t>Date.now()/1e3))}vn=typeof atob!="function"||Xs?r=>{let t=String(r).replace(/=+$/,"");if(t.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var e,a,n=0,s=0,o="";a=t.charAt(s++);~a&&(e=n%4?64*e+a:a,n++%4)?o+=String.fromCharCode(255&e>>(-2*n&6)):0)a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a);return o}:atob;const wa="pb_auth";class aa{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get record(){return this.baseModel}get model(){return this.baseModel}get isValid(){return!pn(this.token)}get isSuperuser(){var e,a;let t=Ot(this.token);return t.type=="auth"&&(((e=this.record)==null?void 0:e.collectionName)=="_superusers"||!((a=this.record)!=null&&a.collectionName)&&t.collectionId=="pbc_3142635823")}get isAdmin(){return console.warn("Please replace pb.authStore.isAdmin with pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),this.isSuperuser}get isAuthRecord(){return console.warn("Please replace pb.authStore.isAuthRecord with !pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),Ot(this.token).type=="auth"&&!this.isSuperuser}save(t,e){this.baseToken=t||"",this.baseModel=e||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(t,e=wa){const a=Js(t||"")[e]||"";let n={};try{n=JSON.parse(a),(typeof n===null||typeof n!="object"||Array.isArray(n))&&(n={})}catch{}this.save(n.token||"",n.record||n.model||null)}exportToCookie(t,e=wa){var c,u;const a={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},n=Ot(this.token);a.expires=n!=null&&n.exp?new Date(1e3*n.exp):new Date("1970-01-01"),t=Object.assign({},a,t);const s={token:this.token,record:this.record?JSON.parse(JSON.stringify(this.record)):null};let o=xa(e,JSON.stringify(s),t);const l=typeof Blob<"u"?new Blob([o]).size:o.length;if(s.record&&l>4096){s.record={id:(c=s.record)==null?void 0:c.id,email:(u=s.record)==null?void 0:u.email};const k=["collectionId","collectionName","verified"];for(const v in this.record)k.includes(v)&&(s.record[v]=this.record[v]);o=xa(e,JSON.stringify(s),t)}return o}onChange(t,e=!1){return this._onChangeCallbacks.push(t),e&&t(this.token,this.record),()=>{for(let a=this._onChangeCallbacks.length-1;a>=0;a--)if(this._onChangeCallbacks[a]==t)return delete this._onChangeCallbacks[a],void this._onChangeCallbacks.splice(a,1)}}triggerChange(){for(const t of this._onChangeCallbacks)t&&t(this.token,this.record)}}class ei extends aa{constructor(t="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=t,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get record(){const t=this._storageGet(this.storageKey)||{};return t.record||t.model||null}get model(){return this.record}save(t,e){this._storageSet(this.storageKey,{token:t,record:e}),super.save(t,e)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(t){if(typeof window<"u"&&(window!=null&&window.localStorage)){const e=window.localStorage.getItem(t)||"";try{return JSON.parse(e)}catch{return e}}return this.storageFallback[t]}_storageSet(t,e){if(typeof window<"u"&&(window!=null&&window.localStorage)){let a=e;typeof e!="string"&&(a=JSON.stringify(e)),window.localStorage.setItem(t,a)}else this.storageFallback[t]=e}_storageRemove(t){var e;typeof window<"u"&&(window!=null&&window.localStorage)&&((e=window.localStorage)==null||e.removeItem(t)),delete this.storageFallback[t]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",t=>{if(t.key!=this.storageKey)return;const e=this._storageGet(this.storageKey)||{};super.save(e.token||"",e.record||e.model||null)})}}class at{constructor(t){this.client=t}}class ti extends at{async getAll(t){return t=Object.assign({method:"GET"},t),this.client.send("/api/settings",t)}async update(t,e){return e=Object.assign({method:"PATCH",body:t},e),this.client.send("/api/settings",e)}async testS3(t="storage",e){return e=Object.assign({method:"POST",body:{filesystem:t}},e),this.client.send("/api/settings/test/s3",e).then(()=>!0)}async testEmail(t,e,a,n){return n=Object.assign({method:"POST",body:{email:e,template:a,collection:t}},n),this.client.send("/api/settings/test/email",n).then(()=>!0)}async generateAppleClientSecret(t,e,a,n,s,o){return o=Object.assign({method:"POST",body:{clientId:t,teamId:e,keyId:a,privateKey:n,duration:s}},o),this.client.send("/api/settings/apple/generate-client-secret",o)}}const ri=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function na(r){if(r){r.query=r.query||{};for(let t in r)ri.includes(t)||(r.query[t]=r[t],delete r[t])}}function hn(r){const t=[];for(const e in r){const a=encodeURIComponent(e),n=Array.isArray(r[e])?r[e]:[r[e]];for(let s of n)s=ai(s),s!==null&&t.push(a+"="+s)}return t.join("&")}function ai(r){return r==null?null:r instanceof Date?encodeURIComponent(r.toISOString().replace("T"," ")):encodeURIComponent(typeof r=="object"?JSON.stringify(r):r)}class gn extends at{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(t,e,a){var o;if(!t)throw new Error("topic must be set.");let n=t;if(a){na(a=Object.assign({},a));const l="options="+encodeURIComponent(JSON.stringify({query:a.query,headers:a.headers}));n+=(n.includes("?")?"&":"?")+l}const s=function(l){const c=l;let u;try{u=JSON.parse(c==null?void 0:c.data)}catch{}e(u||{})};return this.subscriptions[n]||(this.subscriptions[n]=[]),this.subscriptions[n].push(s),this.isConnected?this.subscriptions[n].length===1?await this.submitSubscriptions():(o=this.eventSource)==null||o.addEventListener(n,s):await this.connect(),async()=>this.unsubscribeByTopicAndListener(t,s)}async unsubscribe(t){var a;let e=!1;if(t){const n=this.getSubscriptionsByTopic(t);for(let s in n)if(this.hasSubscriptionListeners(s)){for(let o of this.subscriptions[s])(a=this.eventSource)==null||a.removeEventListener(s,o);delete this.subscriptions[s],e||(e=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?e&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(t){var a;let e=!1;for(let n in this.subscriptions)if((n+"?").startsWith(t)){e=!0;for(let s of this.subscriptions[n])(a=this.eventSource)==null||a.removeEventListener(n,s);delete this.subscriptions[n]}e&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(t,e){var s;let a=!1;const n=this.getSubscriptionsByTopic(t);for(let o in n){if(!Array.isArray(this.subscriptions[o])||!this.subscriptions[o].length)continue;let l=!1;for(let c=this.subscriptions[o].length-1;c>=0;c--)this.subscriptions[o][c]===e&&(l=!0,delete this.subscriptions[o][c],this.subscriptions[o].splice(c,1),(s=this.eventSource)==null||s.removeEventListener(o,e));l&&(this.subscriptions[o].length||delete this.subscriptions[o],a||this.hasSubscriptionListeners(o)||(a=!0))}this.hasSubscriptionListeners()?a&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(t){var e,a;if(this.subscriptions=this.subscriptions||{},t)return!!((e=this.subscriptions[t])!=null&&e.length);for(let n in this.subscriptions)if((a=this.subscriptions[n])!=null&&a.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(t=>{if(!(t!=null&&t.isAbort))throw t})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(t){const e={};t=t.includes("?")?t:t+"?";for(let a in this.subscriptions)(a+"?").startsWith(t)&&(e[a]=this.subscriptions[a]);return e}getNonEmptySubscriptionKeys(){const t=[];for(let e in this.subscriptions)this.subscriptions[e].length&&t.push(e);return t}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let t in this.subscriptions)for(let e of this.subscriptions[t])this.eventSource.addEventListener(t,e)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let t in this.subscriptions)for(let e of this.subscriptions[t])this.eventSource.removeEventListener(t,e)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((t,e)=>{this.pendingConnects.push({resolve:t,reject:e}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildURL("/api/realtime")),this.eventSource.onerror=t=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",t=>{const e=t;this.clientId=e==null?void 0:e.lastEventId,this.submitSubscriptions().then(async()=>{let a=3;for(;this.hasUnsentSubscriptions()&&a>0;)a--,await this.submitSubscriptions()}).then(()=>{for(let n of this.pendingConnects)n.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const a=this.getSubscriptionsByTopic("PB_CONNECT");for(let n in a)for(let s of a[n])s(t)}).catch(a=>{this.clientId="",this.connectErrorHandler(a)})})}hasUnsentSubscriptions(){const t=this.getNonEmptySubscriptionKeys();if(t.length!=this.lastSentSubscriptions.length)return!0;for(const e of t)if(!this.lastSentSubscriptions.includes(e))return!0;return!1}connectErrorHandler(t){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let a of this.pendingConnects)a.reject(new ze(t));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const e=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},e)}disconnect(t=!1){var e;if(this.clientId&&this.onDisconnect&&this.onDisconnect(Object.keys(this.subscriptions)),clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(e=this.eventSource)==null||e.close(),this.eventSource=null,this.clientId="",!t){this.reconnectAttempts=0;for(let a of this.pendingConnects)a.resolve();this.pendingConnects=[]}}}class mn extends at{decode(t){return t}async getFullList(t,e){if(typeof t=="number")return this._getFullList(t,e);let a=500;return(e=Object.assign({},t,e)).batch&&(a=e.batch,delete e.batch),this._getFullList(a,e)}async getList(t=1,e=30,a){return(a=Object.assign({method:"GET"},a)).query=Object.assign({page:t,perPage:e},a.query),this.client.send(this.baseCrudPath,a).then(n=>{var s;return n.items=((s=n.items)==null?void 0:s.map(o=>this.decode(o)))||[],n})}async getFirstListItem(t,e){return(e=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+t},e)).query=Object.assign({filter:t,skipTotal:1},e.query),this.getList(1,1,e).then(a=>{var n;if(!((n=a==null?void 0:a.items)!=null&&n.length))throw new ze({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return a.items[0]})}async getOne(t,e){if(!t)throw new ze({url:this.client.buildURL(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return e=Object.assign({method:"GET"},e),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(t),e).then(a=>this.decode(a))}async create(t,e){return e=Object.assign({method:"POST",body:t},e),this.client.send(this.baseCrudPath,e).then(a=>this.decode(a))}async update(t,e,a){return a=Object.assign({method:"PATCH",body:e},a),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(t),a).then(n=>this.decode(n))}async delete(t,e){return e=Object.assign({method:"DELETE"},e),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(t),e).then(()=>!0)}_getFullList(t=500,e){(e=e||{}).query=Object.assign({skipTotal:1},e.query);let a=[],n=async s=>this.getList(s,t||500,e).then(o=>{const l=o.items;return a=a.concat(l),l.length==o.perPage?n(s+1):a});return n(1)}}function it(r,t,e,a){const n=a!==void 0;return n||e!==void 0?n?(console.warn(r),t.body=Object.assign({},t.body,e),t.query=Object.assign({},t.query,a),t):Object.assign(t,e):t}function Ar(r){var t;(t=r._resetAutoRefresh)==null||t.call(r)}class ni extends mn{constructor(t,e){super(t),this.collectionIdOrName=e}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}get isSuperusers(){return this.collectionIdOrName=="_superusers"||this.collectionIdOrName=="_pbc_2773867675"}async subscribe(t,e,a){if(!t)throw new Error("Missing topic.");if(!e)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+t,e,a)}async unsubscribe(t){return t?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+t):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(t,e){if(typeof t=="number")return super.getFullList(t,e);const a=Object.assign({},t,e);return super.getFullList(a)}async getList(t=1,e=30,a){return super.getList(t,e,a)}async getFirstListItem(t,e){return super.getFirstListItem(t,e)}async getOne(t,e){return super.getOne(t,e)}async create(t,e){return super.create(t,e)}async update(t,e,a){return super.update(t,e,a).then(n=>{var s,o,l;if(((s=this.client.authStore.record)==null?void 0:s.id)===(n==null?void 0:n.id)&&(((o=this.client.authStore.record)==null?void 0:o.collectionId)===this.collectionIdOrName||((l=this.client.authStore.record)==null?void 0:l.collectionName)===this.collectionIdOrName)){let c=Object.assign({},this.client.authStore.record.expand),u=Object.assign({},this.client.authStore.record,n);c&&(u.expand=Object.assign(c,n.expand)),this.client.authStore.save(this.client.authStore.token,u)}return n})}async delete(t,e){return super.delete(t,e).then(a=>{var n,s,o;return!a||((n=this.client.authStore.record)==null?void 0:n.id)!==t||((s=this.client.authStore.record)==null?void 0:s.collectionId)!==this.collectionIdOrName&&((o=this.client.authStore.record)==null?void 0:o.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),a})}authResponse(t){const e=this.decode((t==null?void 0:t.record)||{});return this.client.authStore.save(t==null?void 0:t.token,e),Object.assign({},t,{token:(t==null?void 0:t.token)||"",record:e})}async listAuthMethods(t){return t=Object.assign({method:"GET",fields:"mfa,otp,password,oauth2"},t),this.client.send(this.baseCollectionPath+"/auth-methods",t)}async authWithPassword(t,e,a){let n;a=Object.assign({method:"POST",body:{identity:t,password:e}},a),this.isSuperusers&&(n=a.autoRefreshThreshold,delete a.autoRefreshThreshold,a.autoRefresh||Ar(this.client));let s=await this.client.send(this.baseCollectionPath+"/auth-with-password",a);return s=this.authResponse(s),n&&this.isSuperusers&&function(l,c,u,k){Ar(l);const v=l.beforeSend,p=l.authStore.record,g=l.authStore.onChange((m,f)=>{(!m||(f==null?void 0:f.id)!=(p==null?void 0:p.id)||(f!=null&&f.collectionId||p!=null&&p.collectionId)&&(f==null?void 0:f.collectionId)!=(p==null?void 0:p.collectionId))&&Ar(l)});l._resetAutoRefresh=function(){g(),l.beforeSend=v,delete l._resetAutoRefresh},l.beforeSend=async(m,f)=>{var C;const _=l.authStore.token;if((C=f.query)!=null&&C.autoRefresh)return v?v(m,f):{url:m,sendOptions:f};let T=l.authStore.isValid;if(T&&pn(l.authStore.token,c))try{await u()}catch{T=!1}T||await k();const A=f.headers||{};for(let w in A)if(w.toLowerCase()=="authorization"&&_==A[w]&&l.authStore.token){A[w]=l.authStore.token;break}return f.headers=A,v?v(m,f):{url:m,sendOptions:f}}}(this.client,n,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(t,e,Object.assign({autoRefresh:!0},a))),s}async authWithOAuth2Code(t,e,a,n,s,o,l){let c={method:"POST",body:{provider:t,code:e,codeVerifier:a,redirectURL:n,createData:s}};return c=it("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, options?).",c,o,l),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",c).then(u=>this.authResponse(u))}authWithOAuth2(...t){if(t.length>1||typeof(t==null?void 0:t[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((t==null?void 0:t[0])||"",(t==null?void 0:t[1])||"",(t==null?void 0:t[2])||"",(t==null?void 0:t[3])||"",(t==null?void 0:t[4])||{},(t==null?void 0:t[5])||{},(t==null?void 0:t[6])||{});const e=(t==null?void 0:t[0])||{};let a=null;e.urlCallback||(a=Sa(void 0));const n=new gn(this.client);function s(){a==null||a.close(),n.unsubscribe()}const o={},l=e.requestKey;return l&&(o.requestKey=l),this.listAuthMethods(o).then(c=>{var p;const u=c.oauth2.providers.find(g=>g.name===e.provider);if(!u)throw new ze(new Error(`Missing or invalid provider "${e.provider}".`));const k=this.client.buildURL("/api/oauth2-redirect"),v=l?(p=this.client.cancelControllers)==null?void 0:p[l]:void 0;return v&&(v.signal.onabort=()=>{s()}),new Promise(async(g,m)=>{var f;try{await n.subscribe("@oauth2",async C=>{var x;const w=n.clientId;try{if(!C.state||w!==C.state)throw new Error("State parameters don't match.");if(C.error||!C.code)throw new Error("OAuth2 redirect error or missing code: "+C.error);const E=Object.assign({},e);delete E.provider,delete E.scopes,delete E.createData,delete E.urlCallback,(x=v==null?void 0:v.signal)!=null&&x.onabort&&(v.signal.onabort=null);const I=await this.authWithOAuth2Code(u.name,C.code,u.codeVerifier,k,e.createData,E);g(I)}catch(E){m(new ze(E))}s()});const _={state:n.clientId};(f=e.scopes)!=null&&f.length&&(_.scope=e.scopes.join(" "));const T=this._replaceQueryParams(u.authURL+k,_);await(e.urlCallback||function(C){a?a.location.href=C:a=Sa(C)})(T)}catch(_){s(),m(new ze(_))}})}).catch(c=>{throw s(),c})}async authRefresh(t,e){let a={method:"POST"};return a=it("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",a,t,e),this.client.send(this.baseCollectionPath+"/auth-refresh",a).then(n=>this.authResponse(n))}async requestPasswordReset(t,e,a){let n={method:"POST",body:{email:t}};return n=it("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",n,e,a),this.client.send(this.baseCollectionPath+"/request-password-reset",n).then(()=>!0)}async confirmPasswordReset(t,e,a,n,s){let o={method:"POST",body:{token:t,password:e,passwordConfirm:a}};return o=it("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",o,n,s),this.client.send(this.baseCollectionPath+"/confirm-password-reset",o).then(()=>!0)}async requestVerification(t,e,a){let n={method:"POST",body:{email:t}};return n=it("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",n,e,a),this.client.send(this.baseCollectionPath+"/request-verification",n).then(()=>!0)}async confirmVerification(t,e,a){let n={method:"POST",body:{token:t}};return n=it("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",n,e,a),this.client.send(this.baseCollectionPath+"/confirm-verification",n).then(()=>{const s=Ot(t),o=this.client.authStore.record;return o&&!o.verified&&o.id===s.id&&o.collectionId===s.collectionId&&(o.verified=!0,this.client.authStore.save(this.client.authStore.token,o)),!0})}async requestEmailChange(t,e,a){let n={method:"POST",body:{newEmail:t}};return n=it("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",n,e,a),this.client.send(this.baseCollectionPath+"/request-email-change",n).then(()=>!0)}async confirmEmailChange(t,e,a,n){let s={method:"POST",body:{token:t,password:e}};return s=it("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",s,a,n),this.client.send(this.baseCollectionPath+"/confirm-email-change",s).then(()=>{const o=Ot(t),l=this.client.authStore.record;return l&&l.id===o.id&&l.collectionId===o.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(t,e){return this.client.collection("_externalAuths").getFullList(Object.assign({},e,{filter:this.client.filter("recordRef = {:id}",{id:t})}))}async unlinkExternalAuth(t,e,a){const n=await this.client.collection("_externalAuths").getFirstListItem(this.client.filter("recordRef = {:recordId} && provider = {:provider}",{recordId:t,provider:e}));return this.client.collection("_externalAuths").delete(n.id,a).then(()=>!0)}async requestOTP(t,e){return e=Object.assign({method:"POST",body:{email:t}},e),this.client.send(this.baseCollectionPath+"/request-otp",e)}async authWithOTP(t,e,a){return a=Object.assign({method:"POST",body:{otpId:t,password:e}},a),this.client.send(this.baseCollectionPath+"/auth-with-otp",a).then(n=>this.authResponse(n))}async impersonate(t,e,a){(a=Object.assign({method:"POST",body:{duration:e}},a)).headers=a.headers||{},a.headers.Authorization||(a.headers.Authorization=this.client.authStore.token);const n=new bn(this.client.baseURL,new aa,this.client.lang),s=await n.send(this.baseCollectionPath+"/impersonate/"+encodeURIComponent(t),a);return n.authStore.save(s==null?void 0:s.token,this.decode((s==null?void 0:s.record)||{})),n}_replaceQueryParams(t,e={}){let a=t,n="";t.indexOf("?")>=0&&(a=t.substring(0,t.indexOf("?")),n=t.substring(t.indexOf("?")+1));const s={},o=n.split("&");for(const l of o){if(l=="")continue;const c=l.split("=");s[decodeURIComponent(c[0].replace(/\+/g," "))]=decodeURIComponent((c[1]||"").replace(/\+/g," "))}for(let l in e)e.hasOwnProperty(l)&&(e[l]==null?delete s[l]:s[l]=e[l]);n="";for(let l in s)s.hasOwnProperty(l)&&(n!=""&&(n+="&"),n+=encodeURIComponent(l.replace(/%20/g,"+"))+"="+encodeURIComponent(s[l].replace(/%20/g,"+")));return n!=""?a+"?"+n:a}}function Sa(r){if(typeof window>"u"||!(window!=null&&window.open))throw new ze(new Error("Not in a browser context - please pass a custom urlCallback function."));let t=1024,e=768,a=window.innerWidth,n=window.innerHeight;t=t>a?a:t,e=e>n?n:e;let s=a/2-t/2,o=n/2-e/2;return window.open(r,"popup_window","width="+t+",height="+e+",top="+o+",left="+s+",resizable,menubar=no")}class si extends mn{get baseCrudPath(){return"/api/collections"}async import(t,e=!1,a){return a=Object.assign({method:"PUT",body:{collections:t,deleteMissing:e}},a),this.client.send(this.baseCrudPath+"/import",a).then(()=>!0)}async getScaffolds(t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/meta/scaffolds",t)}async truncate(t,e){return e=Object.assign({method:"DELETE"},e),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(t)+"/truncate",e).then(()=>!0)}}class ii extends at{async getList(t=1,e=30,a){return(a=Object.assign({method:"GET"},a)).query=Object.assign({page:t,perPage:e},a.query),this.client.send("/api/logs",a)}async getOne(t,e){if(!t)throw new ze({url:this.client.buildURL("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/"+encodeURIComponent(t),e)}async getStats(t){return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/stats",t)}}class oi extends at{async check(t){return t=Object.assign({method:"GET"},t),this.client.send("/api/health",t)}}class li extends at{getUrl(t,e,a={}){return console.warn("Please replace pb.files.getUrl() with pb.files.getURL()"),this.getURL(t,e,a)}getURL(t,e,a={}){if(!e||!(t!=null&&t.id)||!(t!=null&&t.collectionId)&&!(t!=null&&t.collectionName))return"";const n=[];n.push("api"),n.push("files"),n.push(encodeURIComponent(t.collectionId||t.collectionName)),n.push(encodeURIComponent(t.id)),n.push(encodeURIComponent(e));let s=this.client.buildURL(n.join("/"));if(Object.keys(a).length){a.download===!1&&delete a.download;const o=new URLSearchParams(a);s+=(s.includes("?")?"&":"?")+o}return s}async getToken(t){return t=Object.assign({method:"POST"},t),this.client.send("/api/files/token",t).then(e=>(e==null?void 0:e.token)||"")}}class ci extends at{async getFullList(t){return t=Object.assign({method:"GET"},t),this.client.send("/api/backups",t)}async create(t,e){return e=Object.assign({method:"POST",body:{name:t}},e),this.client.send("/api/backups",e).then(()=>!0)}async upload(t,e){return e=Object.assign({method:"POST",body:t},e),this.client.send("/api/backups/upload",e).then(()=>!0)}async delete(t,e){return e=Object.assign({method:"DELETE"},e),this.client.send(`/api/backups/${encodeURIComponent(t)}`,e).then(()=>!0)}async restore(t,e){return e=Object.assign({method:"POST"},e),this.client.send(`/api/backups/${encodeURIComponent(t)}/restore`,e).then(()=>!0)}getDownloadUrl(t,e){return console.warn("Please replace pb.backups.getDownloadUrl() with pb.backups.getDownloadURL()"),this.getDownloadURL(t,e)}getDownloadURL(t,e){return this.client.buildURL(`/api/backups/${encodeURIComponent(e)}?token=${encodeURIComponent(t)}`)}}class di extends at{async getFullList(t){return t=Object.assign({method:"GET"},t),this.client.send("/api/crons",t)}async run(t,e){return e=Object.assign({method:"POST"},e),this.client.send(`/api/crons/${encodeURIComponent(t)}`,e).then(()=>!0)}}function Nr(r){return typeof Blob<"u"&&r instanceof Blob||typeof File<"u"&&r instanceof File||r!==null&&typeof r=="object"&&r.uri&&(typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal)}function Mr(r){return r&&(r.constructor.name==="FormData"||typeof FormData<"u"&&r instanceof FormData)}function ka(r){for(const t in r){const e=Array.isArray(r[t])?r[t]:[r[t]];for(const a of e)if(Nr(a))return!0}return!1}const ui=/^[\-\.\d]+$/;function Ca(r){if(typeof r!="string")return r;if(r=="true")return!0;if(r=="false")return!1;if((r[0]==="-"||r[0]>="0"&&r[0]<="9")&&ui.test(r)){let t=+r;if(""+t===r)return t}return r}class fi extends at{constructor(){super(...arguments),this.requests=[],this.subs={}}collection(t){return this.subs[t]||(this.subs[t]=new vi(this.requests,t)),this.subs[t]}async send(t){const e=new FormData,a=[];for(let n=0;n<this.requests.length;n++){const s=this.requests[n];if(a.push({method:s.method,url:s.url,headers:s.headers,body:s.json}),s.files)for(let o in s.files){const l=s.files[o]||[];for(let c of l)e.append("requests."+n+"."+o,c)}}return e.append("@jsonPayload",JSON.stringify({requests:a})),t=Object.assign({method:"POST",body:e},t),this.client.send("/api/batch",t)}}class vi{constructor(t,e){this.requests=[],this.requests=t,this.collectionIdOrName=e}upsert(t,e){e=Object.assign({body:t||{}},e);const a={method:"PUT",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(a,e),this.requests.push(a)}create(t,e){e=Object.assign({body:t||{}},e);const a={method:"POST",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(a,e),this.requests.push(a)}update(t,e,a){a=Object.assign({body:e||{}},a);const n={method:"PATCH",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(t)};this.prepareRequest(n,a),this.requests.push(n)}delete(t,e){e=Object.assign({},e);const a={method:"DELETE",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(t)};this.prepareRequest(a,e),this.requests.push(a)}prepareRequest(t,e){if(na(e),t.headers=e.headers,t.json={},t.files={},e.query!==void 0){const n=hn(e.query);n&&(t.url+=(t.url.includes("?")?"&":"?")+n)}let a=e.body;Mr(a)&&(a=function(s){let o={};return s.forEach((l,c)=>{if(c==="@jsonPayload"&&typeof l=="string")try{let u=JSON.parse(l);Object.assign(o,u)}catch(u){console.warn("@jsonPayload error:",u)}else o[c]!==void 0?(Array.isArray(o[c])||(o[c]=[o[c]]),o[c].push(Ca(l))):o[c]=Ca(l)}),o}(a));for(const n in a){const s=a[n];if(Nr(s))t.files[n]=t.files[n]||[],t.files[n].push(s);else if(Array.isArray(s)){const o=[],l=[];for(const c of s)Nr(c)?o.push(c):l.push(c);if(o.length>0&&o.length==s.length){t.files[n]=t.files[n]||[];for(let c of o)t.files[n].push(c)}else if(t.json[n]=l,o.length>0){let c=n;n.startsWith("+")||n.endsWith("+")||(c+="+"),t.files[c]=t.files[c]||[];for(let u of o)t.files[c].push(u)}}else t.json[n]=s}}}class bn{get baseUrl(){return this.baseURL}set baseUrl(t){this.baseURL=t}constructor(t="/",e,a="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseURL=t,this.lang=a,e?this.authStore=e:typeof window<"u"&&window.Deno?this.authStore=new aa:this.authStore=new ei,this.collections=new si(this),this.files=new li(this),this.logs=new ii(this),this.settings=new ti(this),this.realtime=new gn(this),this.health=new oi(this),this.backups=new ci(this),this.crons=new di(this)}get admins(){return this.collection("_superusers")}createBatch(){return new fi(this)}collection(t){return this.recordServices[t]||(this.recordServices[t]=new ni(this,t)),this.recordServices[t]}autoCancellation(t){return this.enableAutoCancellation=!!t,this}cancelRequest(t){return this.cancelControllers[t]&&(this.cancelControllers[t].abort(),delete this.cancelControllers[t]),this}cancelAllRequests(){for(let t in this.cancelControllers)this.cancelControllers[t].abort();return this.cancelControllers={},this}filter(t,e){if(!e)return t;for(let a in e){let n=e[a];switch(typeof n){case"boolean":case"number":n=""+n;break;case"string":n="'"+n.replace(/'/g,"\\'")+"'";break;default:n=n===null?"null":n instanceof Date?"'"+n.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(n).replace(/'/g,"\\'")+"'"}t=t.replaceAll("{:"+a+"}",n)}return t}getFileUrl(t,e,a={}){return console.warn("Please replace pb.getFileUrl() with pb.files.getURL()"),this.files.getURL(t,e,a)}buildUrl(t){return console.warn("Please replace pb.buildUrl() with pb.buildURL()"),this.buildURL(t)}buildURL(t){var a;let e=this.baseURL;return typeof window>"u"||!window.location||e.startsWith("https://")||e.startsWith("http://")||(e=(a=window.location.origin)!=null&&a.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseURL.startsWith("/")||(e+=window.location.pathname||"/",e+=e.endsWith("/")?"":"/"),e+=this.baseURL),t&&(e+=e.endsWith("/")?"":"/",e+=t.startsWith("/")?t.substring(1):t),e}async send(t,e){e=this.initSendOptions(t,e);let a=this.buildURL(t);if(this.beforeSend){const n=Object.assign({},await this.beforeSend(a,e));n.url!==void 0||n.options!==void 0?(a=n.url||a,e=n.options||e):Object.keys(n).length&&(e=n,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(e.query!==void 0){const n=hn(e.query);n&&(a+=(a.includes("?")?"&":"?")+n),delete e.query}return this.getHeader(e.headers,"Content-Type")=="application/json"&&e.body&&typeof e.body!="string"&&(e.body=JSON.stringify(e.body)),(e.fetch||fetch)(a,e).then(async n=>{let s={};try{s=await n.json()}catch{}if(this.afterSend&&(s=await this.afterSend(n,s,e)),n.status>=400)throw new ze({url:n.url,status:n.status,data:s});return s}).catch(n=>{throw new ze(n)})}initSendOptions(t,e){if((e=Object.assign({method:"GET"},e)).body=function(n){if(typeof FormData>"u"||n===void 0||typeof n!="object"||n===null||Mr(n)||!ka(n))return n;const s=new FormData;for(const o in n){const l=n[o];if(l!==void 0)if(typeof l!="object"||ka({data:l})){const c=Array.isArray(l)?l:[l];for(let u of c)s.append(o,u)}else{let c={};c[o]=l,s.append("@jsonPayload",JSON.stringify(c))}}return s}(e.body),na(e),e.query=Object.assign({},e.params,e.query),e.requestKey===void 0&&(e.$autoCancel===!1||e.query.$autoCancel===!1?e.requestKey=null:(e.$cancelKey||e.query.$cancelKey)&&(e.requestKey=e.$cancelKey||e.query.$cancelKey)),delete e.$autoCancel,delete e.query.$autoCancel,delete e.$cancelKey,delete e.query.$cancelKey,this.getHeader(e.headers,"Content-Type")!==null||Mr(e.body)||(e.headers=Object.assign({},e.headers,{"Content-Type":"application/json"})),this.getHeader(e.headers,"Accept-Language")===null&&(e.headers=Object.assign({},e.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(e.headers,"Authorization")===null&&(e.headers=Object.assign({},e.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&e.requestKey!==null){const a=e.requestKey||(e.method||"GET")+t;delete e.requestKey,this.cancelRequest(a);const n=new AbortController;this.cancelControllers[a]=n,e.signal=n.signal}return e}getHeader(t,e){t=t||{},e=e.toLowerCase();for(let a in t)if(a.toLowerCase()==e)return t[a];return null}}const pi=()=>window.location.origin,Z=new bn(pi());function Ur(){if(Z.authStore.isValid&&typeof Z.authStore.token=="string"&&Z.authStore.token!=="")return Z.authStore.token;const r=localStorage.getItem("authToken");return r!==null?r:""}function hi(r=!0){r&&Z.authStore.isValid&&localStorage.setItem("authToken",Z.authStore.token)}function Pr(){Z.authStore.clear(),localStorage.removeItem("authToken")}const _n="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='32'%20height='32'%20viewBox='0%200%20100%20100'%20aria-hidden='true'%20role='img'%3e%3cdefs%3e%3c!--%20Playful%20Blue/Cyan%20Gradient%20--%3e%3clinearGradient%20id='shape1Gradient'%20x1='0%25'%20y1='0%25'%20x2='100%25'%20y2='100%25'%3e%3cstop%20offset='0%25'%20stop-color='%2300BFFF'/%3e%3c!--%20DeepSkyBlue%20--%3e%3cstop%20offset='100%25'%20stop-color='%2387CEFA'/%3e%3c!--%20LightSkyBlue%20--%3e%3c/linearGradient%3e%3c!--%20Bright%20Yellow/Lime%20Gradient%20--%3e%3clinearGradient%20id='shape2Gradient'%20x1='100%25'%20y1='0%25'%20x2='0%25'%20y2='100%25'%3e%3cstop%20offset='0%25'%20stop-color='%23FFD700'/%3e%3c!--%20Gold%20--%3e%3cstop%20offset='100%25'%20stop-color='%23ADFF2F'/%3e%3c!--%20GreenYellow%20--%3e%3c/linearGradient%3e%3c/defs%3e%3c!--%20Rounded%20Shape%201%20(like%20a%20soft%20square%20or%20cloud)%20--%3e%3cpath%20fill='url(%23shape1Gradient)'%20d='M20%2010%20C0%2010,%200%2030,%2020%2030%20H80%20C100%2030,%20100%2010,%2080%2010%20Z'%20transform='rotate(-15%2050%2050)%20translate(0%2015)'/%3e%3c!--%20Rounded%20Shape%202%20(like%20a%20soft%20triangle%20or%20drop)%20--%3e%3cpath%20fill='url(%23shape2Gradient)'%20d='M50%2045%20C20%2045,%2020%2090,%2050%2090%20C80%2090,%2080%2045,%2050%2045%20Z'%20transform='rotate(25%2050%2070)%20translate(0%20-5)'/%3e%3c!--%20Small%20Sparkle/Dot%20--%3e%3ccircle%20cx='75'%20cy='25'%20r='5'%20fill='%23FFFFFF'%20opacity='0.9'/%3e%3ccircle%20cx='75'%20cy='25'%20r='8'%20fill='%23FFFFFF'%20opacity='0.5'/%3e%3c/svg%3e";var gi=S('<div class="bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 px-3 py-2 rounded relative text-sm" role="alert"><strong class="font-bold">Error!</strong> <span class="block sm:inline"> </span></div>'),mi=S('<p id="email-error" class="mt-1 text-xs text-red-600 dark:text-red-300"> </p>'),bi=S('<p id="password-error" class="mt-1 text-xs text-red-600 dark:text-red-300"> </p>'),_i=Yt('<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Signing in...',1),yi=S('<div class="min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900"><div class="max-w-sm w-full space-y-6 p-6 bg-white dark:bg-gray-800 rounded-xl shadow-md"><div class="text-center"><div class="flex items-center justify-center"><img alt="Glimmer Logo" class="h-10 w-10 mr-3"> <h1 class="text-2xl font-bold text-primary dark:text-white svelte-phxsvf">Glimmer</h1></div> <p class="mt-1 text-gray-600 dark:text-gray-300 text-base">Learning Helper for Kids</p></div> <form class="space-y-4"><!> <div class="space-y-2"><div><label for="email" class="sr-only">Email address</label> <input id="email" name="email" type="email" autocomplete="email" required placeholder="Email address"> <!></div> <div><label for="password" class="sr-only">Password</label> <input id="password" name="password" type="password" autocomplete="current-password" required placeholder="Password"> <!></div></div> <div class="flex items-center justify-between"><div class="flex items-center"><input id="remember-me" name="remember-me" type="checkbox" class="h-4 w-4 text-secondary focus:ring-secondary border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 svelte-phxsvf"> <label for="remember-me" class="ml-2 block text-xs text-gray-900 dark:text-gray-200">Remember me</label></div> <div class="text-xs"><a href="/forgot-password" class="font-medium text-secondary hover:text-secondary focus:outline-none focus:underline dark:text-blue-400">Forgot your password?</a></div></div> <div><button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-secondary hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-secondary disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 svelte-phxsvf"><!></button></div></form></div></div>');function xi(r,t){we(t,!1);const[e,a]=Lt(),n=()=>Xe(Le,"$error",e);let s=U({email:"",password:"",rememberMe:!1}),o=U(!1),l=U({});function c(){y(l,{});let $=!0;return i(s).email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i(s).email)||(xe(l,i(l).email="Please enter a valid email address"),$=!1):(xe(l,i(l).email="Email is required"),$=!1),i(s).password?i(s).password.length<6&&(xe(l,i(l).password="Password must be at least 6 characters"),$=!1):(xe(l,i(l).password="Password is required"),$=!1),$}async function u(){if(c()){y(o,!0),Le.set(null);try{await Z.collection("users").authWithPassword(i(s).email,i(s).password),hi(i(s).rememberMe),ot.set(!0),window.location.href="/dashboard"}catch($){const M=$ instanceof Error?$.message:"Login failed. Please check your credentials.";Le.set(M),xe(l,i(l).email=M)}finally{y(o,!1)}}}rt(()=>{Le.set(null)}),Ee();var k=yi(),v=d(k),p=d(v),g=d(p),m=d(g);te(m,"src",_n);var f=b(p,2),_=d(f);{var T=$=>{var M=gi(),V=b(d(M),2),W=d(V);L(()=>R(W,n())),h($,M)};O(_,$=>{n()&&$(T)})}var A=b(_,2),C=d(A),w=b(d(C),2),x=b(w,2);{var E=$=>{var M=mi(),V=d(M);L(()=>R(V,i(l).email)),h($,M)};O(x,$=>{i(l).email&&$(E)})}var I=b(C,2),P=b(d(I),2),D=b(P,2);{var H=$=>{var M=bi(),V=d(M);L(()=>R(V,i(l).password)),h($,M)};O(D,$=>{i(l).password&&$(H)})}var B=b(A,2),z=d(B),q=d(z),N=b(B,2),K=d(N),Y=d(K);{var X=$=>{var M=_i();h($,M)},F=$=>{var M=Re("Sign in");h($,M)};O(Y,$=>{i(o)?$(X):$(F,!1)})}L(()=>{Ce(w,1,`block w-full px-3 py-2 rounded-t-md border ${i(l).email?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600"} placeholder-gray-400 dark:placeholder-gray-500 text-gray-900 dark:text-gray-100 bg-gray-100 dark:bg-gray-700 focus:outline-none focus:ring-secondary focus:border-secondary sm:text-sm`,"svelte-phxsvf"),w.disabled=i(o),te(w,"aria-invalid",!!i(l).email),te(w,"aria-describedby",i(l).email?"email-error":void 0),Ce(P,1,`block w-full px-3 py-2 rounded-b-md border ${i(l).password?"border-red-500 dark:border-red-400":"border-gray-300 dark:border-gray-600"} placeholder-gray-400 dark:placeholder-gray-500 text-gray-900 dark:text-gray-100 bg-gray-100 dark:bg-gray-700 focus:outline-none focus:ring-secondary focus:border-secondary sm:text-sm`,"svelte-phxsvf"),P.disabled=i(o),te(P,"aria-invalid",!!i(l).password),te(P,"aria-describedby",i(l).password?"password-error":void 0),q.disabled=i(o),K.disabled=i(o)}),zt(w,()=>i(s).email,$=>xe(s,i(s).email=$)),zt(P,()=>i(s).password,$=>xe(s,i(s).password=$)),Us(q,()=>i(s).rememberMe,$=>xe(s,i(s).rememberMe=$)),fe("submit",f,ra(u)),h(r,k),Se(),a()}var wi=S('<li><a><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg> <span> </span></a></li>'),Si=S('<aside><div class="h-full flex flex-col"><div class="flex items-center justify-center h-16 border-b border-gray-200"><img alt="Glimmer Logo" class="h-8 w-8 mr-2"> <div class="text-xl font-semibold text-gray-800">Glimmer</div></div> <nav class="flex-1 overflow-y-auto p-4"><ul class="space-y-2"></ul></nav> <div class="p-4 border-t border-gray-200"><button class="flex items-center justify-center w-full p-2 bg-red-50 text-red-600 rounded-md hover:bg-red-100 transition-colors"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg> Sign Out</button></div></div></aside>');function Ea(r,t){let e=j(t,"isOpen",8,!0);const a=[{href:"/",label:"Dashboard",icon:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"},{href:"/practice-topics",label:"Practice Topics",icon:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"},{href:"/learners",label:"Learners",icon:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"},{href:"/chat",label:"Chat",icon:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"},{href:"/profile",label:"Profile",icon:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},{href:"/settings",label:"Settings",icon:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}];function n(m,f){m.preventDefault(),window.navigate(f)}function s(m){if(typeof window<"u"){const f=window.location.pathname;return m==="/"?f==="/":f.startsWith(m)}return!1}var o=Si(),l=d(o),c=d(l),u=d(c);te(u,"src",_n);var k=b(c,2),v=d(k);Ie(v,5,()=>a,$e,(m,f)=>{var _=wi(),T=d(_),A=d(T),C=d(A),w=b(A,2),x=d(w);L(E=>{te(T,"href",i(f).href),Ce(T,1,E),te(C,"d",i(f).icon),R(x,i(f).label)},[()=>`flex items-center p-2 rounded-md hover:bg-gray-100 transition-colors ${s(i(f).href)?"bg-gray-100 text-indigo-600":"text-gray-700"}`],Oe),fe("click",T,E=>n(E,i(f).href)),h(m,_)});var p=b(k,2),g=d(p);L(()=>Ce(o,1,`bg-white border-r border-gray-200 w-64 flex-shrink-0 ${e()?"":"hidden"} md:block`)),fe("click",g,()=>{localStorage.removeItem("pocketbase_auth"),window.location.href="/"}),h(r,o)}var ki=S('<div class="md:hidden fixed inset-0 flex z-40 print:hidden"><button class="fixed inset-0 bg-gray-600 bg-opacity-75" aria-label="Close sidebar overlay"></button> <!></div>'),Ci=S('<div class="h-screen flex overflow-hidden bg-gray-100 print:h-auto print:overflow-visible"><!> <div class="hidden md:flex md:flex-shrink-0 print:hidden"><!></div> <div class="flex flex-col w-0 flex-1 overflow-hidden h-screen print:h-auto print:overflow-visible print:w-full"><div class="md:hidden pl-1 pt-1 sm:pl-3 sm:pt-3 print:hidden"><button class="-ml-0.5 -mt-0.5 h-12 w-12 inline-flex items-center justify-center rounded-md text-gray-500 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-secondary svelte-9gggib"><span class="sr-only">Open sidebar</span> <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></button></div> <main class="flex-1 relative z-0 overflow-y-auto focus:outline-none h-full print:h-auto print:overflow-visible print:relative print:z-0"><!></main></div></div>');function nt(r,t){let e=j(t,"sidebarOpen",12,!0);function a(){e(!e())}var n=Ci(),s=d(n);{var o=m=>{var f=ki(),_=d(f),T=b(_,2);Ea(T,{isOpen:!0}),fe("click",_,()=>e(!1)),fe("keydown",_,A=>A.key==="Escape"&&e(!1)),h(m,f)};O(s,m=>{e()&&m(o)})}var l=b(s,2),c=d(l);Ea(c,{get isOpen(){return e()}});var u=b(l,2),k=d(u),v=d(k),p=b(k,2),g=d(p);_r(g,t,"default",{},null),fe("click",v,a),h(r,n)}var Ei=S('<div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md shadow-sm mb-4" role="alert"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><p class="text-sm font-medium"> </p></div></div></div>');function sa(r,t){let e=j(t,"message",8);var a=Ke(),n=ve(a);{var s=o=>{var l=Ei(),c=d(l),u=b(d(c),2),k=d(u),v=d(k);L(()=>R(v,e())),h(o,l)};O(n,o=>{e()&&o(s)})}h(r,a)}var Ti=Yt('<svg class="animate-spin h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),Oi=S('<div class="bg-white overflow-hidden shadow rounded-lg"><div class="p-5"><div class="flex items-center"><div class="flex-shrink-0"><svg class="h-6 w-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><!></svg></div> <div class="ml-5 w-0 flex-1"><dl><dt class="text-sm font-medium text-gray-500 truncate"> </dt> <dd class="flex items-baseline"><div class="text-2xl font-semibold text-gray-900"><!></div></dd></dl></div></div></div></div>');function $r(r,t){let e=j(t,"title",8),a=j(t,"value",8),n=j(t,"isLoading",8,!1),s=j(t,"icon",8);var o=Oi(),l=d(o),c=d(l),u=d(c),k=d(u),v=d(k);js(v,s,!0);var p=b(u,2),g=d(p),m=d(g),f=d(m),_=b(m,2),T=d(_),A=d(T);{var C=x=>{var E=Ti();h(x,E)},w=x=>{var E=Re();L(()=>R(E,a())),h(x,E)};O(A,x=>{n()?x(C):x(w,!1)})}L(()=>R(f,e())),h(r,o)}var Ai=S('<div class="max-w-7xl mx-auto px-4 sm:px-6 md:px-8 mt-4"><!></div>'),Pi=S('<div class="py-6"><div class="max-w-7xl mx-auto px-4 sm:px-6 md:px-8"><h1 class="text-2xl font-semibold text-gray-900">Dashboard</h1></div> <!> <div class="max-w-7xl mx-auto px-4 sm:px-6 md:px-8"><div class="py-4"><div class="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3"><!> <!> <!></div></div></div></div>');function $i(r,t){const[e,a]=Lt(),n=()=>Xe(Le,"$error",e);let s=j(t,"activeLearners",8),o=j(t,"practiceTopics",8),l=j(t,"completedSessions",8),c=j(t,"isLoading",8,!1);const u={learners:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />',topics:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />',sessions:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />'};var k=Pi(),v=b(d(k),2);{var p=C=>{var w=Ai(),x=d(w);sa(x,{get message(){return n()}}),h(C,w)};O(v,C=>{n()&&C(p)})}var g=b(v,2),m=d(g),f=d(m),_=d(f);$r(_,{title:"Active Learners",get value(){return s()},get isLoading(){return c()},get icon(){return u.learners}});var T=b(_,2);$r(T,{title:"Practice Topics",get value(){return o()},get isLoading(){return c()},get icon(){return u.topics}});var A=b(T,2);$r(A,{title:"Completed Sessions",get value(){return l()},get isLoading(){return c()},get icon(){return u.sessions}}),h(r,k),a()}function Ta(r,t){we(t,!1);const[e,a]=Lt(),n=()=>Xe(Tt,"$user",e);let s=U(!0),o=U(0),l=U(0),c=U(0),u=U(!0);rt(async()=>{await k()});async function k(){y(u,!0),Le.set(null);try{const v=n();if(!v)throw new Error("User not found");let p={activeLearners:0,practiceTopics:0,completedSessions:0};"account"in v?(console.log(v),p={activeLearners:0,practiceTopics:0,completedSessions:0}):(console.log(v),p={activeLearners:1,practiceTopics:0,completedSessions:0}),y(o,p.activeLearners),y(l,p.practiceTopics),y(c,p.completedSessions)}catch(v){console.error("Error fetching dashboard stats:",v),Le.set(v instanceof Error?v.message:"Failed to fetch dashboard stats")}finally{y(u,!1)}}Ee(),nt(r,{get sidebarOpen(){return i(s)},set sidebarOpen(v){y(s,v)},children:(v,p)=>{$i(v,{get activeLearners(){return i(o)},get practiceTopics(){return i(l)},get completedSessions(){return i(c)},get isLoading(){return i(u)}})},$$slots:{default:!0},$$legacy:!0}),Se(),a()}var Ii=S('<span class="text-red-500">*</span>'),Li=S('<div><label class="block text-sm font-medium text-gray-700 mb-1 text-left"> <!></label> <input></div>');function mt(r,t){let e=j(t,"id",8),a=j(t,"label",8),n=j(t,"type",8,"text"),s=j(t,"value",12),o=j(t,"disabled",8,!1),l=j(t,"required",8,!1),c=j(t,"placeholder",8,""),u=j(t,"cols",8,"col-span-6 sm:col-span-3");var k=Li(),v=d(k),p=d(v),g=b(p);{var m=_=>{var T=Ii();h(_,T)};O(g,_=>{l()&&_(m)})}var f=b(v,2);L(()=>{Ce(k,1,`${u()} mb-4`),te(v,"for",e()),R(p,`${a()??""} `),te(f,"type",n()),te(f,"name",e()),te(f,"id",e()),te(f,"placeholder",c()),f.required=l(),f.disabled=o(),Ce(f,1,`mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-sm shadow-sm placeholder-gray-400
		focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500
		dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600 dark:placeholder-gray-500
		disabled:bg-gray-50 disabled:text-gray-500 disabled:border-gray-200 disabled:shadow-none
		${o()?"":"hover:border-gray-400"}`)}),zt(f,s),h(r,k)}var Ri=Yt('<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> ',1),ji=S("<button><!></button>");function He(r,t){let e=j(t,"type",8,"button"),a=j(t,"isLoading",8,!1),n=j(t,"disabled",8,!1),s=j(t,"variant",8,"primary"),o=j(t,"loadingText",8,"Loading...");const l={primary:"bg-indigo-600 hover:bg-indigo-700 focus:ring-indigo-500 border-indigo-600",secondary:"bg-gray-600 hover:bg-gray-700 focus:ring-gray-500 border-gray-600",danger:"bg-red-600 hover:bg-red-700 focus:ring-red-500 border-red-600"};var c=ji(),u=d(c);{var k=p=>{var g=Ri(),m=b(ve(g),1,!0);L(()=>R(m,o())),h(p,g)},v=p=>{var g=Ke(),m=ve(g);_r(m,t,"default",{},f=>{var _=Re("Submit");h(f,_)}),h(p,g)};O(u,p=>{a()?p(k):p(v,!1)})}L(()=>{te(c,"type",e()),Ce(c,1,`inline-flex justify-center py-2 px-5 border shadow-sm text-sm font-medium rounded-md text-white 
	${l[s()]} 
	focus:outline-none focus:ring-2 focus:ring-offset-2
	transition-all duration-200 ease-in-out
	disabled:opacity-50 disabled:cursor-not-allowed
	`),c.disabled=n()||a()}),fe("click",c,function(p){dn.call(this,t,p)}),h(r,c)}var qi=S('<p class="mt-1 max-w-2xl text-sm text-gray-500 mx-auto"> </p>'),Di=S('<div class="bg-white shadow overflow-hidden sm:rounded-lg border border-gray-200 mb-6"><div class="px-4 py-5 sm:px-6 bg-gray-50"><h3 class="text-lg leading-6 font-medium text-gray-900"> </h3> <!></div> <div class="border-t border-gray-200"><!></div></div>');function yn(r,t){let e=j(t,"title",8),a=j(t,"description",8,"");var n=Di(),s=d(n),o=d(s),l=d(o),c=b(o,2);{var u=p=>{var g=qi(),m=d(g);L(()=>R(m,a())),h(p,g)};O(c,p=>{a()&&p(u)})}var k=b(s,2),v=d(k);_r(v,t,"default",{},null),L(()=>R(l,e())),h(r,n)}var Fi=S('<div class="max-w-3xl mx-auto px-4 sm:px-6 md:px-8 mb-6"><!></div>'),Ni=S('<form class="p-4"><div class="py-4 bg-white"><div class="grid grid-cols-6 gap-6"><!> <!></div></div> <div class="px-4 py-3 bg-gray-50 text-right sm:px-6 mt-4 -mx-4 -mb-4 border-t border-gray-200"><!></div></form>'),Mi=S('<div class="py-6"><div class="max-w-3xl mx-auto px-4 sm:px-6 md:px-8"><h1 class="text-2xl font-semibold text-gray-900 mb-6">Edit Profile</h1></div> <!> <div class="max-w-3xl mx-auto px-4 sm:px-6 md:px-8"><!></div></div>');function Ui(r,t){we(t,!1);const[e,a]=Lt(),n=()=>Xe(Le,"$error",e);let s=j(t,"profile",8,null),o=j(t,"isLoading",8,!1),l=U(""),c=U("");const u=fn();function k(){u("save",{name:i(l)})}ft(()=>_t(s()),()=>{s()&&(y(l,s().name),y(c,s().email))}),Vt(),Ee();var v=Mi(),p=b(d(v),2);{var g=_=>{var T=Fi(),A=d(T);sa(A,{get message(){return n()}}),h(_,T)};O(p,_=>{n()&&_(g)})}var m=b(p,2),f=d(m);yn(f,{title:"Profile Information",description:"Update your personal details",children:(_,T)=>{var A=Ni(),C=d(A),w=d(C),x=d(w);mt(x,{id:"name",label:"Name",get disabled(){return o()},required:!0,get value(){return i(l)},set value(D){y(l,D)},$$legacy:!0});var E=b(x,2);mt(E,{id:"email",label:"Email address (cannot be changed)",type:"email",get value(){return i(c)},cols:"col-span-6 sm:col-span-4",disabled:!0,required:!0});var I=b(C,2),P=d(I);He(P,{type:"submit",get isLoading(){return o()},loadingText:"Saving...",children:(D,H)=>{var B=Re("Save");h(D,B)},$$slots:{default:!0}}),fe("submit",A,ra(k)),h(_,A)},$$slots:{default:!0}}),h(r,v),Se(),a()}var Bi=S('<div class="max-w-3xl mx-auto px-4 sm:px-6 md:px-8 my-4"><div class="bg-green-50 border-l-4 border-green-500 text-green-700 p-4 rounded-md shadow-sm" role="alert"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-green-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><p class="text-sm font-medium">Your profile has been updated successfully!</p></div></div></div></div>'),zi=S("<!> <!>",1);function Hi(r,t){we(t,!1);const[e,a]=Lt(),n=()=>Xe(Tt,"$user",e);let s=U(!0),o=U(!1),l=U(null),c=U(!1);rt(async()=>{await u()});async function u(){var v,p;y(o,!0),Le.set(null);try{const g=n();if(!g)throw new Error("User not found");y(l,{name:((v=g.user)==null?void 0:v.name)||"",email:((p=g.user)==null?void 0:p.email)||""})}catch(g){console.error("Error fetching user profile:",g),Le.set(g instanceof Error?g.message:"Failed to fetch user profile")}finally{y(o,!1)}}async function k(v){y(o,!0),Le.set(null),y(c,!1);try{const{name:p}=v.detail,g=n();if(!g||!g.user)throw new Error("User not found");const m=g.user.id;await Z.collection("users").update(m,{name:p}),g.user&&(g.user.name=p,Tt.set(g)),i(l)&&y(l,{...i(l),name:p}),y(c,!0),setTimeout(()=>{y(c,!1)},3e3)}catch(p){console.error("Error updating profile:",p),Le.set(p instanceof Error?p.message:"Failed to update profile")}finally{y(o,!1)}}Ee(),nt(r,{get sidebarOpen(){return i(s)},set sidebarOpen(v){y(s,v)},children:(v,p)=>{var g=zi(),m=ve(g);{var f=T=>{var A=Bi();h(T,A)};O(m,T=>{i(c)&&T(f)})}var _=b(m,2);Ui(_,{get profile(){return i(l)},get isLoading(){return i(o)},$$events:{save:k}}),h(v,g)},$$slots:{default:!0},$$legacy:!0}),Se(),a()}var Gi=S('<div class="max-w-3xl mx-auto px-4 sm:px-6 md:px-8 my-8"><h1 class="text-2xl font-semibold text-gray-900 mb-6">Settings</h1> <div class="bg-white shadow overflow-hidden sm:rounded-lg"><div class="px-4 py-5 sm:p-6"><p class="text-gray-700">This is the Settings page. Application settings and preferences will be available here.</p></div></div></div>');function Vi(r){let t=U(!0);nt(r,{get sidebarOpen(){return i(t)},set sidebarOpen(e){y(t,e)},children:(e,a)=>{var n=Gi();h(e,n)},$$slots:{default:!0},$$legacy:!0})}var Wi=S('<span class="text-red-500">*</span>'),Ki=S('<label class="block text-sm font-medium text-gray-700 mb-1 text-left"> <!></label>'),Yi=S("<div><!> <textarea></textarea></div>");function er(r,t){let e=j(t,"id",8),a=j(t,"label",8),n=j(t,"value",12),s=j(t,"disabled",8,!1),o=j(t,"required",8,!1),l=j(t,"placeholder",8,""),c=j(t,"rows",8,3),u=j(t,"cols",8,"col-span-6 sm:col-span-3"),k=j(t,"class_override",8,"");var v=Yi(),p=d(v);{var g=f=>{var _=Ki(),T=d(_),A=b(T);{var C=w=>{var x=Wi();h(w,x)};O(A,w=>{o()&&w(C)})}L(()=>{te(_,"for",e()),R(T,`${a()??""} `)}),h(f,_)};O(p,f=>{a()&&f(g)})}var m=b(p,2);L(()=>{Ce(v,1,`${u()} ${a()?"mb-4":""}`),te(m,"name",e()),te(m,"id",e()),te(m,"placeholder",l()),m.required=o(),m.disabled=s(),te(m,"rows",c()),Ce(m,1,k()||`mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-sm shadow-sm placeholder-gray-400
		focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500
		dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600 dark:placeholder-gray-500
		disabled:bg-gray-50 disabled:text-gray-500 disabled:border-gray-200 disabled:shadow-none
		resize-none
		${s()?"":"hover:border-gray-400"}`)}),zt(m,n),fe("keydown",m,function(f){dn.call(this,t,f)}),h(r,v)}var Ji=S('<span class="text-red-500">*</span>'),Qi=S("<div><label> <!></label> <select><!></select></div>");function xn(r,t){let e=j(t,"id",8),a=j(t,"label",8),n=j(t,"value",12),s=j(t,"disabled",8,!1),o=j(t,"required",8,!1),l=j(t,"cols",8,"col-span-6 sm:col-span-3"),c=j(t,"inline",8,!1);var u=Qi(),k=d(u),v=d(k),p=b(v);{var g=_=>{var T=Ji();h(_,T)};O(p,_=>{o()&&_(g)})}var m=b(k,2);L(()=>{n(),xs(()=>{e(),o(),s(),c()})});var f=d(m);_r(f,t,"default",{},null),L(()=>{Ce(u,1,`${l()} mb-4 ${c()?"flex items-center gap-2":""}`),te(k,"for",e()),Ce(k,1,`block text-sm font-medium text-gray-700 text-left $${c()?"":"mb-1"}`),R(v,`${a()??""} `),te(m,"name",e()),te(m,"id",e()),m.required=o(),m.disabled=s(),Ce(m,1,`mt-1 block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md text-sm shadow-sm placeholder-gray-400
		focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500
		dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600 dark:placeholder-gray-500
		disabled:bg-gray-50 disabled:text-gray-500 disabled:border-gray-200 disabled:shadow-none
		${s()?"":"hover:border-gray-400"} $${c()?"mt-0":""}
		appearance-none bg-no-repeat bg-[length:1.5em_1.5em] bg-[right_0.5rem_center] bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22none%22%20viewBox%3D%220%200%2020%2020%22%3E%3Cpath%20stroke%3D%22%236B7280%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%221.5%22%20d%3D%22m6%208%204%204%204-4%22%2F%3E%3C%2Fsvg%3E')]`)}),zs(m,n),h(r,u)}const bt=class bt{constructor(){kr(this,"baseUrl","/api/llm")}static getInstance(){return bt.instance||(bt.instance=new bt),bt.instance}async getInfo(){const t=Ur();if(!t)throw new Error("Please log in again.");const e=await fetch(`${this.baseUrl}/info`,{headers:{Authorization:`Bearer ${t}`}});if(!e.ok)throw new Error(`Error: ${e.status} ${e.statusText}`);return e.json()}async chat(t,e,a){const n=Ur();if(!n)throw new Error("Please log in again.");const s={prompt:t,systemPrompt:e};a&&(s.model=a);const o=await fetch(`${this.baseUrl}/chat`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify(s)});if(!o.ok)throw new Error(`Error: ${o.status} ${o.statusText}`);return o.json()}};kr(bt,"instance");let Br=bt;const zr=Br.getInstance();var Zi=S('<div class="mb-6"><!></div>'),Xi=S("<option>Loading models...</option>"),eo=S("<option>Error loading models</option>"),to=S("<option> </option>"),ro=S('<span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),ao=S('<div class="mt-2 flex flex-wrap gap-2"></div>'),no=S('<form class="p-4"><!> <div class="py-4 bg-white"><div class="grid grid-cols-6 gap-6"><!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!></div></div> <div class="px-4 py-3 bg-gray-50 text-right sm:px-6 mt-4 -mx-4 -mb-4 border-t border-gray-200 flex justify-end space-x-4"><!> <!> <!></div></form>'),so=S('<div class="mx-auto px-4 sm:px-6 md:px-8"><!></div>');function Oa(r,t){we(t,!1);let e=j(t,"topic",8,null);const a=fn();let n=U(e()?{name:e().name,subject:e().subject,description:e().description||"",target_age_range:e().target_age_range||"",target_grade_level:e().target_grade_level||"",learning_goals:Array.isArray(e().learning_goals)?e().learning_goals:[],base_prompt:e().base_prompt||"",system_prompt:e().system_prompt||"",tags:Array.isArray(e().tags)?e().tags:[],llm_model:e().llm_model||""}:{name:"",subject:"",description:"",target_age_range:"",target_grade_level:"",learning_goals:[],base_prompt:"",system_prompt:"",tags:[],llm_model:""}),s=U(!1),o=U(null),l=U(i(n).learning_goals.join(`
`)),c=U(i(n).tags.join(", ")),u=U(!1),k=U(null),v=U([]);async function p(){y(u,!0),y(k,null);try{const w=await zr.getInfo();if(y(v,w.platforms.flatMap(x=>x.models.map(E=>({id:E.name,name:`${E.name}${E.isDefault?" (Default)":""}`,isDefault:E.isDefault})))),i(v).length===0&&y(v,[{id:"",name:"Default"}]),!i(n).llm_model){const x=i(v).find(E=>E.isDefault);x&&xe(n,i(n).llm_model=x.id)}}catch(w){console.error("Error fetching models:",w),y(k,w instanceof Error?w.message:"Failed to fetch models"),y(v,[{id:"",name:"Default"}])}finally{y(u,!1)}}p();function g(){return i(n).name?i(n).subject?i(n).base_prompt?null:"Base prompt is required":"Subject is required":"Name is required"}async function m(){const w=g();if(w){y(o,w);return}try{y(s,!0),y(o,null);const x=Z.authStore.model;if(!x&&!e()){y(o,"You must be logged in to create a topic"),y(s,!1);return}const E={...i(n)};if(typeof E.tags=="string"&&(E.tags=E.tags.split(",").map(P=>P.trim()).filter(Boolean)),console.log("Data being sent to server:",E),!e())try{if(!x){y(o,"You must be logged in to create a topic"),y(s,!1);return}const P=await Z.collection("instructors").getList(1,1,{filter:`user.id = "${x.id}"`});if(P&&P.items.length>0)E.instructor=P.items[0].id,E.account=P.items[0].account;else{const D=await Z.collection("accounts").getList(1,1,{filter:`owner.id = "${x.id}"`});if(D&&D.items.length>0)E.account=D.items[0].id;else{y(o,"Could not determine account for user"),y(s,!1);return}}}catch(P){console.error("Failed to get user account info:",P),y(o,"Failed to get account information"),y(s,!1);return}let I;e()?I=await Z.collection("practice_topics").update(e().id,E):I=await Z.collection("practice_topics").create(E),console.log("Response from server:",I),a("update",I)}catch(x){console.error("Failed to save topic:",x),y(o,"Failed to save practice topic")}finally{y(s,!1)}}function f(w){const x=w.target;y(c,x.value),xe(n,i(n).tags=i(c).split(",").map(E=>E.trim()).filter(Boolean)),console.log("Tags updated through input:",i(n).tags)}async function _(){if(e()&&confirm("Are you sure you want to delete this practice topic?"))try{y(s,!0),y(o,null),await Z.collection("practice_topics").delete(e().id),a("delete",e().id)}catch(w){console.error("Failed to delete topic:",w),y(o,"Failed to delete practice topic")}finally{y(s,!1)}}ft(()=>(i(l),i(c)),()=>{xe(n,i(n).learning_goals=i(l).split(`
`).map(w=>w.trim()).filter(Boolean)),xe(n,i(n).tags=i(c).split(",").map(w=>w.trim()).filter(Boolean))}),Vt(),Ee();var T=so(),A=d(T);const C=Oe(()=>e()?"Edit Practice Topic":"Create Practice Topic");yn(A,{get title(){return i(C)},description:"Enter the details for this practice topic",children:(w,x)=>{var E=no(),I=d(E);{var P=G=>{var ge=Zi(),me=d(ge);sa(me,{get message(){return i(o)}}),h(G,ge)};O(I,G=>{i(o)&&G(P)})}var D=b(I,2),H=d(D),B=d(H);mt(B,{id:"name",label:"Name",get disabled(){return i(s)},required:!0,cols:"col-span-6",placeholder:"Enter topic name",get value(){return i(n).name},set value(G){xe(n,i(n).name=G)},$$legacy:!0});var z=b(B,2);mt(z,{id:"subject",label:"Subject",get disabled(){return i(s)},required:!0,cols:"col-span-6 sm:col-span-3",placeholder:"e.g. Mathematics, Science, History",get value(){return i(n).subject},set value(G){xe(n,i(n).subject=G)},$$legacy:!0});var q=b(z,2);mt(q,{id:"target_age_range",label:"Target Age Range",get disabled(){return i(s)},cols:"col-span-6 sm:col-span-3",placeholder:"e.g. 7-10",get value(){return i(n).target_age_range},set value(G){xe(n,i(n).target_age_range=G)},$$legacy:!0});var N=b(q,2);mt(N,{id:"target_grade_level",label:"Target Grade Level",get disabled(){return i(s)},cols:"col-span-6 sm:col-span-3",placeholder:"e.g. 3-5",get value(){return i(n).target_grade_level},set value(G){xe(n,i(n).target_grade_level=G)},$$legacy:!0});var K=b(N,2);er(K,{id:"description",label:"Description",get disabled(){return i(s)},cols:"col-span-6",placeholder:"Describe the topic and its purpose",get value(){return i(n).description},set value(G){xe(n,i(n).description=G)},$$legacy:!0});var Y=b(K,2);er(Y,{id:"learning_goals",label:"Learning Goals (one per line)",get disabled(){return i(s)},cols:"col-span-6",placeholder:"Enter learning goals, one per line",get value(){return i(l)},set value(G){y(l,G)},$$legacy:!0});var X=b(Y,2);er(X,{id:"base_prompt",label:"Base Prompt",get disabled(){return i(s)},required:!0,cols:"col-span-6",placeholder:"Enter a base prompt for generating practice items",get value(){return i(n).base_prompt},set value(G){xe(n,i(n).base_prompt=G)},$$legacy:!0});var F=b(X,2);er(F,{id:"system_prompt",label:"System Prompt",get disabled(){return i(s)},cols:"col-span-6",placeholder:"Enter a system prompt for the AI assistant",get value(){return i(n).system_prompt},set value(G){xe(n,i(n).system_prompt=G)},$$legacy:!0});var $=b(F,2);const M=Oe(()=>i(s)||i(u));xn($,{id:"llm_model",label:"LLM Model",get disabled(){return i(M)},cols:"col-span-6 sm:col-span-3",get value(){return i(n).llm_model},set value(G){xe(n,i(n).llm_model=G)},children:(G,ge)=>{var me=Ke(),se=ve(me);{var ae=Pe=>{var ke=Xi();ke.value=ke.__value="",h(Pe,ke)},_e=(Pe,ke)=>{{var Q=de=>{var ye=eo();ye.value=ye.__value="",h(de,ye)},oe=de=>{var ye=Ke(),ee=ve(ye);Ie(ee,1,()=>i(v),$e,(ie,le)=>{var Te=to(),Fe={},wt=d(Te);L(()=>{Fe!==(Fe=i(le).id)&&(Te.value=(Te.__value=i(le).id)??""),R(wt,i(le).name)}),h(ie,Te)}),h(de,ye)};O(Pe,de=>{i(k)?de(Q):de(oe,!1)},ke)}};O(se,Pe=>{i(u)?Pe(ae):Pe(_e,!1)})}h(G,me)},$$slots:{default:!0},$$legacy:!0});var V=b($,2);mt(V,{id:"tags",label:"Tags (comma-separated)",type:"text",get disabled(){return i(s)},cols:"col-span-6",placeholder:"e.g. math, arithmetic, addition",get value(){return i(c)},set value(G){y(c,G)},$$events:{input:f},$$legacy:!0});var W=b(V,2);{var re=G=>{var ge=ao();Ie(ge,5,()=>i(n).tags,$e,(me,se)=>{var ae=ro(),_e=d(ae);L(()=>R(_e,i(se))),h(me,ae)}),h(G,ge)};O(W,G=>{i(n).tags.length>0&&G(re)})}var J=b(D,2),ce=d(J);He(ce,{type:"button",variant:"secondary",get disabled(){return i(s)},$$events:{click:()=>a("cancel")},children:(G,ge)=>{var me=Re("Cancel");h(G,me)},$$slots:{default:!0}});var Ae=b(ce,2);{var be=G=>{He(G,{type:"button",variant:"danger",get disabled(){return i(s)},$$events:{click:_},children:(ge,me)=>{var se=Re("Delete");h(ge,se)},$$slots:{default:!0}})};O(Ae,G=>{e()&&G(be)})}var ne=b(Ae,2);He(ne,{type:"submit",get isLoading(){return i(s)},loadingText:"Saving...",children:(G,ge)=>{var me=Re("Save");h(G,me)},$$slots:{default:!0}}),fe("submit",E,ra(m)),h(w,E)},$$slots:{default:!0}}),h(r,T),Se()}var io=S("<p> </p>"),oo=S('<span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),lo=S('<span class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),co=S('<span class="bg-gray-100 text-gray-800 text-xs font-medium px-2 py-0.5 rounded"> </span>'),uo=S('<div class="w-full mt-2 pt-2 border-t border-gray-50"><div class="flex flex-wrap gap-1"></div></div>'),fo=S('<div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow cursor-pointer relative" tabindex="0" role="button"><button class="absolute top-2 right-2 p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full" aria-label="Edit topic"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg></button> <h2 class="text-xl font-semibold text-gray-900 mb-2"> </h2> <div class="text-gray-600 mb-4 min-h-[1.5rem]"><!></div> <div class="flex flex-wrap gap-2"><span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span> <!> <!> <!></div></div>');function vo(r,t){we(t,!1);let e=j(t,"topic",8),a=j(t,"onClick",8,()=>{}),n=j(t,"onEdit",8,()=>{});Ee();var s=fo(),o=d(s),l=b(o,2),c=d(l),u=b(l,2),k=d(u);{var v=x=>{var E=io(),I=d(E);L(()=>R(I,e().description)),h(x,E)};O(k,x=>{e().description&&x(v)})}var p=b(u,2),g=d(p),m=d(g),f=b(g,2);{var _=x=>{var E=oo(),I=d(E);L(()=>R(I,`Age: ${e().target_age_range??""}`)),h(x,E)};O(f,x=>{e().target_age_range&&x(_)})}var T=b(f,2);{var A=x=>{var E=lo(),I=d(E);L(()=>R(I,`Grade: ${e().target_grade_level??""}`)),h(x,E)};O(T,x=>{e().target_grade_level&&x(A)})}var C=b(T,2);{var w=x=>{var E=uo(),I=d(E);Ie(I,5,()=>e().tags,$e,(P,D)=>{var H=co(),B=d(H);L(()=>R(B,i(D))),h(P,H)}),h(x,E)};O(C,x=>{e().tags&&Array.isArray(e().tags)&&e().tags.length>0&&x(w)})}L(()=>{te(s,"aria-label",`View ${e().name}`),R(c,e().name),R(m,e().subject)}),fe("click",o,qt(x=>{x.preventDefault(),n()(e())})),fe("click",s,()=>a()(e())),fe("keydown",s,x=>x.key==="Enter"&&a()(e())),h(r,s),Se()}var po=S('<div class="flex justify-between items-center mb-6"><h1 class="text-2xl font-bold text-gray-900">Practice Topics</h1> <!></div>'),ho=S('<div class="flex justify-between items-center mb-6"><h1 class="text-2xl font-bold text-gray-900"> </h1> <!></div>'),go=S('<div class="flex justify-center items-center h-64"><div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"></div></div>'),mo=S('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert"><strong class="font-bold">Error!</strong> <span class="block sm:inline"> </span></div>'),bo=S('<div class="max-w-4xl mx-auto"><!></div>'),_o=S('<div class="max-w-4xl mx-auto"><!></div>'),yo=S('<div class="bg-yellow-50 border-l-4 border-yellow-400 p-4"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><p class="text-sm text-yellow-700">No practice topics available. Create your first topic!</p></div></div></div>'),xo=S('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>'),wo=S('<div class="container mx-auto px-4 py-8"><!> <!></div>');function So(r,t){we(t,!1);let e=U([]),a=U(!0),n=U(null),s=U(null),o=U(!1),l=U(!0);async function c(){try{y(a,!0),y(n,null);const f=await Z.collection("practice_topics").getFullList({sort:"-created",expand:"account"});y(e,f.map(_=>{if(_.tags&&!Array.isArray(_.tags))try{typeof _.tags=="string"&&_.tags.trim().startsWith("[")?_.tags=JSON.parse(_.tags):typeof _.tags=="string"&&(_.tags=_.tags.split(",").map(T=>T.trim()).filter(Boolean))}catch(T){console.error("Error parsing tags:",T),_.tags=[]}else _.tags||(_.tags=[]);return _})),console.log("Loaded topics:",i(e))}catch(f){console.error("Failed to load topics:",f),y(n,"Failed to load practice topics")}finally{y(a,!1)}}rt(async()=>{console.log("PracticeTopics mounted, loading topics");const _=new URLSearchParams(window.location.search).get("edit");if(console.log("URL edit parameter:",_),await c(),_){console.log("Found edit parameter, will edit topic:",_);const T=i(e).find(C=>C.id===_);T?(console.log("Found topic to edit:",T.name),k(T)):console.error("Could not find topic with id:",_);const A=new URL(window.location.href);A.searchParams.delete("edit"),window.history.replaceState({},"",A)}});function u(f){window.navigate(`/practice-topic/${f.id}`)}function k(f){y(s,f),y(o,!1)}function v(f){y(e,i(e).map(_=>_.id===f.id?f:_)),y(s,null),y(o,!1),c()}function p(f){y(e,i(e).filter(_=>_.id!==f)),y(s,null),y(o,!1)}function g(){y(s,null),y(o,!0)}function m(){y(s,null),y(o,!1)}Ee(),nt(r,{get sidebarOpen(){return i(l)},set sidebarOpen(f){y(l,f)},children:(f,_)=>{var T=wo(),A=d(T);{var C=P=>{var D=po(),H=b(d(D),2);He(H,{type:"button",$$events:{click:g},children:(B,z)=>{var q=Re("Create New Topic");h(B,q)},$$slots:{default:!0}}),h(P,D)},w=P=>{var D=ho(),H=d(D),B=d(H),z=b(H,2);He(z,{type:"button",variant:"secondary",$$events:{click:m},children:(q,N)=>{var K=Re("Back to Topics");h(q,K)},$$slots:{default:!0}}),L(()=>R(B,i(s)?"Edit Practice Topic":"Create New Topic")),h(P,D)};O(A,P=>{!i(s)&&!i(o)?P(C):P(w,!1)})}var x=b(A,2);{var E=P=>{var D=go();h(P,D)},I=(P,D)=>{{var H=z=>{var q=mo(),N=b(d(q),2),K=d(N);L(()=>R(K,i(n))),h(z,q)},B=(z,q)=>{{var N=Y=>{var X=bo(),F=d(X);Oa(F,{get topic(){return i(s)},$$events:{update:({detail:$})=>v($),delete:({detail:$})=>p($),cancel:m}}),h(Y,X)},K=(Y,X)=>{{var F=M=>{var V=_o(),W=d(V);Oa(W,{$$events:{update:({detail:re})=>v(re),cancel:m}}),h(M,V)},$=(M,V)=>{{var W=J=>{var ce=yo();h(J,ce)},re=J=>{var ce=xo();Ie(ce,5,()=>i(e),$e,(Ae,be)=>{vo(Ae,{get topic(){return i(be)},onClick:u,onEdit:k})}),h(J,ce)};O(M,J=>{i(e).length===0?J(W):J(re,!1)},V)}};O(Y,M=>{i(o)?M(F):M($,!1)},X)}};O(z,Y=>{i(s)!==null?Y(N):Y(K,!1)},q)}};O(P,z=>{i(n)?z(H):z(B,!1)},D)}};O(x,P=>{i(a)?P(E):P(I,!1)})}h(f,T)},$$slots:{default:!0},$$legacy:!0}),Se()}var ko=S('<div class="flex justify-center items-center h-64"><div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"></div></div>'),Co=S('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert"><strong class="font-bold">Error!</strong> <span class="block sm:inline"> </span></div>'),Eo=S('<p class="text-gray-600 mb-4"> </p>'),To=S('<span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),Oo=S('<span class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),Ao=S('<span class="bg-gray-100 text-gray-800 text-xs font-medium px-2 py-0.5 rounded"> </span>'),Po=S('<div class="mb-4"><h3 class="text-sm font-medium text-gray-700 mb-2">Tags:</h3> <div class="flex flex-wrap gap-1"></div></div>'),$o=S('<li class="text-gray-600"> </li>'),Io=S('<div class="mb-4"><h3 class="text-sm font-medium text-gray-700 mb-2">Learning Goals:</h3> <ul class="list-disc list-inside"></ul></div>'),Lo=S('<tr><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm"><span> </span></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"><button class="text-indigo-600 hover:text-indigo-900"> </button></td></tr>'),Ro=S('<div class="bg-white shadow-md rounded-lg p-6"><h2 class="text-xl font-semibold text-gray-900 mb-4">Practice Sessions</h2> <div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Score</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div></div>'),jo=S('<div class="bg-gray-50 border border-gray-200 p-4 rounded-md"><p class="text-gray-600">No practice sessions yet. Start your first one!</p></div>'),qo=S('<div class="bg-white shadow-md rounded-lg p-6 mb-6"><h2 class="text-xl font-semibold text-gray-900 mb-2"> </h2> <!> <div class="flex flex-wrap gap-2 mb-4"><span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span> <!> <!></div> <!> <!> <div class="mt-6"><!></div></div> <!>',1),Do=S('<div class="container mx-auto px-4 py-8"><div class="flex justify-between items-center mb-6"><h1 class="text-2xl font-bold text-gray-900">Practice Topic</h1> <div class="flex space-x-2"><!> <!></div></div> <!></div>');function Fo(r,t){we(t,!1);let e=U(null),a=U([]),n=U(!0),s=U(null),o=U(!0),l=null;rt(async()=>{try{const g=window.location.pathname;g.includes("/practice-topic/")?(l=g.split("/practice-topic/")[1],l?(await c(l),await u(l)):(y(s,"Invalid topic ID"),y(n,!1))):(console.error("Invalid URL format, expected /practice-topic/ID"),y(s,"Invalid URL format"),y(n,!1))}catch(g){console.error("Error in onMount:",g),y(s,g instanceof Error?g.message:"An unexpected error occurred"),y(n,!1)}});async function c(g){try{if(y(n,!0),y(s,null),!g)throw new Error("Topic ID is required");const m=await Z.collection("practice_topics").getOne(g);if(m.tags){const f=m.tags;if(typeof f=="string")try{f.trim().startsWith("[")?m.tags=JSON.parse(f):m.tags=f.split(",").map(_=>_.trim()).filter(Boolean)}catch(_){console.error("Error parsing tags:",_),m.tags=[]}}else m.tags=[];y(e,m)}catch(m){console.error("Failed to load topic:",m),y(s,"Failed to load practice topic")}finally{y(n,!1)}}async function u(g){try{const m=await Z.collection("practice_sessions").getList(1,10,{filter:`practice_topic="${g}"`,sort:"-created",expand:"learner,practice_topic"});y(a,m.items)}catch(m){console.error("Failed to load past practices:",m)}}function k(){window.navigate("/practice-topics")}function v(){if(!i(e))return;const g=new URL(window.location.origin+"/practice-topics");g.searchParams.set("edit",i(e).id),window.navigate(g.pathname+g.search)}async function p(){if(i(e))try{const g=Z.authStore.model;if(!g){console.error("User not authenticated"),y(s,"You must be logged in to start a practice");return}try{if(await Z.collection("instructors").getFirstListItem(`user="${g.id}"`)){window.navigate(`/create-practice/${i(e).id}`);return}}catch{}try{const m=await Z.collection("learners").getFirstListItem(`user="${g.id}"`),f={practice_topic:i(e).id,learner:m.id,practice_items:"[]",assigned_at:new Date().toISOString(),status:"InProgress",name:`Practice: ${i(e).name}`},_=await Z.collection("practice_sessions").create(f);window.navigate(`/practice-session/${_.id}`)}catch(m){console.error("Failed to find learner record:",m),y(s,"Could not find your learner profile. Please contact support.");return}}catch(g){console.error("Failed to create practice session:",g),y(s,"Failed to start new practice: "+(g instanceof Error?g.message:String(g)))}}Ee(),nt(r,{get sidebarOpen(){return i(o)},set sidebarOpen(g){y(o,g)},children:(g,m)=>{var f=Do(),_=d(f),T=b(d(_),2),A=d(T);He(A,{type:"button",variant:"secondary",$$events:{click:k},children:(I,P)=>{var D=Re("Back to Topics");h(I,D)},$$slots:{default:!0}});var C=b(A,2);He(C,{type:"button",variant:"primary",$$events:{click:v},children:(I,P)=>{var D=Re("Edit Topic");h(I,D)},$$slots:{default:!0}});var w=b(_,2);{var x=I=>{var P=ko();h(I,P)},E=(I,P)=>{{var D=B=>{var z=Co(),q=b(d(z),2),N=d(q);L(()=>R(N,i(s))),h(B,z)},H=(B,z)=>{{var q=N=>{var K=qo(),Y=ve(K),X=d(Y),F=d(X),$=b(X,2);{var M=Q=>{var oe=Eo(),de=d(oe);L(()=>R(de,i(e).description)),h(Q,oe)};O($,Q=>{i(e).description&&Q(M)})}var V=b($,2),W=d(V),re=d(W),J=b(W,2);{var ce=Q=>{var oe=To(),de=d(oe);L(()=>R(de,`Age: ${i(e).target_age_range??""}`)),h(Q,oe)};O(J,Q=>{i(e).target_age_range&&Q(ce)})}var Ae=b(J,2);{var be=Q=>{var oe=Oo(),de=d(oe);L(()=>R(de,`Grade: ${i(e).target_grade_level??""}`)),h(Q,oe)};O(Ae,Q=>{i(e).target_grade_level&&Q(be)})}var ne=b(V,2);{var G=Q=>{var oe=Po(),de=b(d(oe),2);Ie(de,5,()=>i(e).tags,$e,(ye,ee)=>{var ie=Ao(),le=d(ie);L(()=>R(le,i(ee))),h(ye,ie)}),h(Q,oe)};O(ne,Q=>{i(e).tags&&Array.isArray(i(e).tags)&&i(e).tags.length>0&&Q(G)})}var ge=b(ne,2);{var me=Q=>{var oe=Io(),de=b(d(oe),2);Ie(de,5,()=>i(e).learning_goals,$e,(ye,ee)=>{var ie=$o(),le=d(ie);L(()=>R(le,i(ee))),h(ye,ie)}),h(Q,oe)};O(ge,Q=>{i(e).learning_goals&&Array.isArray(i(e).learning_goals)&&i(e).learning_goals.length>0&&Q(me)})}var se=b(ge,2),ae=d(se);He(ae,{type:"button",variant:"primary",$$events:{click:p},children:(Q,oe)=>{var de=Re("Start New Practice");h(Q,de)},$$slots:{default:!0}});var _e=b(Y,2);{var Pe=Q=>{var oe=Ro(),de=b(d(oe),2),ye=d(de),ee=b(d(ye));Ie(ee,5,()=>i(a),$e,(ie,le)=>{var Te=Lo(),Fe=d(Te),wt=d(Fe),Rt=b(Fe),wr=d(Rt),Jt=b(Rt),Qt=d(Jt),Sr=d(Qt),ia=b(Jt),Sn=d(ia),kn=b(ia),oa=d(kn),Cn=d(oa);L(En=>{R(wt,En),R(wr,i(le).name||"Unnamed practice"),Ce(Qt,1,`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                                                ${i(le).status==="Completed"?"bg-green-100 text-green-800":i(le).status==="InProgress"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`),R(Sr,i(le).status),R(Sn,i(le).score?`${i(le).score}%`:"-"),R(Cn,i(le).status==="InProgress"?"Continue":"View")},[()=>new Date(i(le).assigned_at).toLocaleDateString()],Oe),fe("click",oa,()=>window.navigate(`/practice-session/${i(le).id}`)),h(ie,Te)}),h(Q,oe)},ke=Q=>{var oe=jo();h(Q,oe)};O(_e,Q=>{i(a).length>0?Q(Pe):Q(ke,!1)})}L(()=>{R(F,i(e).name),R(re,i(e).subject)}),h(N,K)};O(B,N=>{i(e)&&N(q)},z)}};O(I,B=>{i(s)?B(D):B(H,!1)},P)}};O(w,I=>{i(n)?I(x):I(E,!1)})}h(g,f)},$$slots:{default:!0},$$legacy:!0}),Se()}var No=S('<img class="h-8 w-8 rounded-full object-cover">'),Mo=Yt('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>'),Uo=S('<span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),Bo=S('<span class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),zo=S('<div class="mt-3 mb-4"><p class="text-xs text-gray-500 mb-1">Learning preferences:</p> <div class="flex flex-wrap gap-1"><span class="bg-gray-100 text-gray-800 text-xs font-medium px-2 py-0.5 rounded"> </span></div></div>'),Ho=S('<div role="button" tabindex="0"> </div>'),Go=S('<div class="flex flex-wrap gap-2 mt-3"></div>'),Vo=S('<button><div class="flex items-center mb-4"><div class="bg-blue-100 text-blue-800 p-3 rounded-full mr-4"><!></div> <div><h3 class="text-lg font-semibold text-gray-900"> </h3> <p class="text-sm text-gray-600"> </p></div></div> <div class="flex flex-wrap gap-2 mb-3"><!> <!></div> <!> <!></button>'),Wo=S('<img class="h-8 w-8 rounded-full object-cover">'),Ko=Yt('<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>'),Yo=S('<span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),Jo=S('<span class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),Qo=S('<span class="bg-gray-100 text-gray-800 text-xs font-medium px-2 py-0.5 rounded"> </span>'),Zo=S('<div class="mt-3 mb-4"><p class="text-xs text-gray-500 mb-1">Learning preferences:</p> <div class="flex flex-wrap gap-1"></div></div>'),Xo=S('<div role="button" tabindex="0"> </div>'),el=S('<div class="flex flex-wrap gap-2 mt-3"></div>'),tl=S('<div><div class="flex items-center mb-4"><div class="bg-blue-100 text-blue-800 p-3 rounded-full mr-4"><!></div> <div><h3 class="text-lg font-semibold text-gray-900"> </h3> <p class="text-sm text-gray-600"> </p></div></div> <div class="flex flex-wrap gap-2 mb-3"><!> <!></div> <!> <!></div>');function rl(r,t){we(t,!1);let e=j(t,"learner",8),a=j(t,"actions",24,()=>[]),n=j(t,"clickable",8,!1),s=j(t,"onClick",8,()=>{}),o=j(t,"shadow",8,!0),l=j(t,"showPreferences",8,!0);function c(g="primary"){switch(g){case"secondary":return"bg-gray-100 hover:bg-gray-200 text-gray-800";case"success":return"bg-green-100 hover:bg-green-200 text-green-800";case"danger":return"bg-red-100 hover:bg-red-200 text-red-800";case"warning":return"bg-yellow-100 hover:bg-yellow-200 text-yellow-800";case"primary":default:return"bg-blue-100 hover:bg-blue-200 text-blue-800"}}Ee();var u=Ke(),k=ve(u);{var v=g=>{var m=Vo(),f=d(m),_=d(f),T=d(_);{var A=F=>{var $=No();L(()=>{te($,"src",e().avatar),te($,"alt",e().nickname)}),h(F,$)},C=F=>{var $=Mo();h(F,$)};O(T,F=>{e().avatar?F(A):F(C,!1)})}var w=b(_,2),x=d(w),E=d(x),I=b(x,2),P=d(I),D=b(f,2),H=d(D);{var B=F=>{var $=Uo(),M=d($);L(()=>R(M,`Age: ${e().age??""}`)),h(F,$)};O(H,F=>{e().age&&F(B)})}var z=b(H,2);{var q=F=>{var $=Bo(),M=d($);L(()=>R(M,`Grade: ${e().grade_level??""}`)),h(F,$)};O(z,F=>{e().grade_level&&F(q)})}var N=b(D,2);{var K=F=>{var $=zo(),M=b(d($),2),V=d(M),W=d(V);L(()=>R(W,e().learning_preferences)),h(F,$)};O(N,F=>{l()&&e().learning_preferences&&e().learning_preferences.length>0&&F(K)})}var Y=b(N,2);{var X=F=>{var $=Go();Ie($,5,a,$e,(M,V)=>{var W=Ho(),re=d(W);L(J=>{Ce(W,1,J),R(re,i(V).label)},[()=>`px-3 py-1.5 text-xs font-medium rounded-md cursor-pointer ${c(i(V).color)}`],Oe),fe("click",W,qt(J=>{J.preventDefault(),i(V).onClick(e())})),fe("keypress",W,qt(J=>{(J.key==="Enter"||J.key===" ")&&(J.preventDefault(),i(V).onClick(e()))})),h(M,W)}),h(F,$)};O(Y,F=>{a().length>0&&F(X)})}L(()=>{var F;Ce(m,1,`
        bg-white rounded-lg w-full text-left
        ${o()?"shadow-md":"border border-gray-100"} 
        p-6 
        hover:shadow-lg transition-shadow cursor-pointer
    `),te(m,"aria-label",`Select ${e().nickname}`),R(E,e().nickname),R(P,((F=e().user)==null?void 0:F.name)||"Unknown user")}),fe("click",m,()=>s()(e())),h(g,m)},p=g=>{var m=tl(),f=d(m),_=d(f),T=d(_);{var A=F=>{var $=Wo();L(()=>{te($,"src",e().avatar),te($,"alt",e().nickname)}),h(F,$)},C=F=>{var $=Ko();h(F,$)};O(T,F=>{e().avatar?F(A):F(C,!1)})}var w=b(_,2),x=d(w),E=d(x),I=b(x,2),P=d(I),D=b(f,2),H=d(D);{var B=F=>{var $=Yo(),M=d($);L(()=>R(M,`Age: ${e().age??""}`)),h(F,$)};O(H,F=>{e().age&&F(B)})}var z=b(H,2);{var q=F=>{var $=Jo(),M=d($);L(()=>R(M,`Grade: ${e().grade_level??""}`)),h(F,$)};O(z,F=>{e().grade_level&&F(q)})}var N=b(D,2);{var K=F=>{var $=Zo(),M=b(d($),2);Ie(M,5,()=>e().learning_preferences,$e,(V,W)=>{var re=Qo(),J=d(re);L(()=>R(J,i(W))),h(V,re)}),h(F,$)};O(N,F=>{l()&&e().learning_preferences&&e().learning_preferences.length>0&&F(K)})}var Y=b(N,2);{var X=F=>{var $=el();Ie($,5,a,$e,(M,V)=>{var W=Xo(),re=d(W);L(J=>{Ce(W,1,J),R(re,i(V).label)},[()=>`px-3 py-1.5 text-xs font-medium rounded-md cursor-pointer ${c(i(V).color)}`],Oe),fe("click",W,qt(J=>{J.preventDefault(),i(V).onClick(e())})),fe("keypress",W,qt(J=>{(J.key==="Enter"||J.key===" ")&&(J.preventDefault(),i(V).onClick(e()))})),h(M,W)}),h(F,$)};O(Y,F=>{a().length>0&&F(X)})}L(()=>{var F;Ce(m,1,`
        bg-white rounded-lg
        ${o()?"shadow-md":"border border-gray-100"} 
        p-6 
    `),R(E,e().nickname),R(P,((F=e().user)==null?void 0:F.name)||"Unknown user")}),h(g,m)};O(k,g=>{n()?g(v):g(p,!1)})}h(r,u),Se()}var al=S('<div class="flex justify-center items-center h-32"><div class="animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-primary"></div></div>'),nl=S('<div class="bg-yellow-50 border-l-4 border-yellow-400 p-4"><div class="flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><p class="text-sm text-yellow-700"> </p></div></div></div>'),sl=S("<div></div>");function wn(r,t){we(t,!1);let e=j(t,"learners",24,()=>[]),a=j(t,"loading",8,!1),n=j(t,"emptyMessage",8,"No learners found."),s=j(t,"gridCols",8,"grid-cols-1 md:grid-cols-2 lg:grid-cols-3"),o=j(t,"showPreferences",8,!0),l=j(t,"onClick",8,()=>{}),c=j(t,"cardActions",24,()=>[]);function u(m){return c().filter(f=>!f.condition||f.condition(m))}Ee();var k=Ke(),v=ve(k);{var p=m=>{var f=al();h(m,f)},g=(m,f)=>{{var _=A=>{var C=nl(),w=d(C),x=b(d(w),2),E=d(x),I=d(E);L(()=>R(I,n())),h(A,C)},T=A=>{var C=sl();Ie(C,5,e,$e,(w,x)=>{const E=Oe(()=>l()!==void 0),I=Oe(()=>u(i(x)));rl(w,{get learner(){return i(x)},get clickable(){return i(E)},get onClick(){return l()},get showPreferences(){return o()},get actions(){return i(I)}})}),L(()=>Ce(C,1,`grid ${s()} gap-6`)),h(A,C)};O(m,A=>{e().length===0?A(_):A(T,!1)},f)}};O(v,m=>{a()?m(p):m(g,!1)})}h(r,k),Se()}class il{async ensureAuth(){if(!Z.authStore.isValid)throw new Error("You must be logged in to create a practice session")}async refreshAuth(){try{await Z.collection("users").authRefresh()}catch{throw Z.authStore.clear(),new Error("Your session has expired. Please log in again.")}}async makeRequest(t){const e=await fetch("/api/practice/session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:Z.authStore.token},body:JSON.stringify(t)});if(!e.ok){const a=await e.json().catch(()=>({}));throw{status:e.status,message:a.message||`Server error: ${e.status}`}}return e.json()}async createSession(t){await this.ensureAuth();try{return await this.makeRequest(t)}catch(e){if(e.status===401){await this.refreshAuth();try{return await this.makeRequest(t)}catch(a){throw new Error(a.message)}}throw new Error(e.message)}}}const ol=new il;var ll=S('<div class="flex justify-center items-center h-64"><div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"></div></div>'),cl=S('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert"><strong class="font-bold">Error!</strong> <span class="block sm:inline"> </span></div>'),dl=S('<p class="text-gray-600 mb-4"> </p>'),ul=S('<span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),fl=S('<span class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),vl=S(`<div class="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50"><div class="bg-white rounded-lg p-8 max-w-md w-full mx-4"><div class="flex flex-col items-center"><div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-primary mb-4"></div> <h3 class="text-xl font-semibold text-gray-900 mb-2">Creating Practice Session</h3> <p class="text-gray-600 text-center mb-4"> </p> <p class="text-gray-600 text-center mb-4">This may take a few minutes. Please don't refresh the page.</p> <div class="w-full bg-gray-200 rounded-full h-2.5"><div class="bg-primary h-2.5 rounded-full animate-pulse"></div></div></div></div></div>`),pl=S('<div class="bg-white shadow-md rounded-lg p-6 mb-6"><h2 class="text-xl font-semibold text-gray-900 mb-2"> </h2> <!> <div class="flex flex-wrap gap-2 mb-4"><span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span> <!> <!></div></div> <h2 class="text-xl font-semibold text-gray-900 mb-4">Select a Learner</h2> <!> <!>',1),hl=S('<div class="container mx-auto px-4 py-8"><div class="flex justify-between items-center mb-6"><h1 class="text-2xl font-bold text-gray-900">Create New Practice Session</h1> <div class="flex space-x-2"><!></div></div> <!></div>');function gl(r,t){we(t,!1);let e=U(null),a=U([]),n=U(!0),s=U(!0),o=U(!1),l=U(null),c=U(null),u=U(!0),k=null;rt(async()=>{try{const f=window.location.pathname;f.includes("/create-practice/")?(k=f.split("/create-practice/")[1],k?(await v(k),await p()):(y(c,"Invalid topic ID"),y(n,!1))):(console.error("Invalid URL format, expected /create-practice/ID"),y(c,"Invalid URL format"),y(n,!1))}catch(f){console.error("Error in onMount:",f),y(c,f instanceof Error?f.message:"An unexpected error occurred"),y(n,!1)}});async function v(f){try{if(y(n,!0),y(c,null),!f)throw new Error("Topic ID is required");const _=await Z.collection("practice_topics").getOne(f);if(_.tags){const T=_.tags;if(typeof T=="string")try{T.trim().startsWith("[")?_.tags=JSON.parse(T):_.tags=T.split(",").map(A=>A.trim()).filter(Boolean)}catch(A){console.error("Error parsing tags:",A),_.tags=[]}}else _.tags=[];y(e,_)}catch(_){console.error("Failed to load topic:",_),y(c,"Failed to load practice topic")}finally{y(n,!1)}}async function p(){try{y(s,!0);const f=await Z.collection("learners").getList(1,50,{sort:"nickname",expand:"user"});y(a,f.items)}catch(f){console.error("Failed to load learners:",f),y(c,"Failed to load learners")}finally{y(s,!1)}}function g(){k?window.navigate(`/practice-topic/${k}`):window.navigate("/practice-topics")}async function m(f){if(i(e))try{y(o,!0),y(c,null),y(l,f);const _=await ol.createSession({learnerId:f.id,practiceTopicId:i(e).id});window.navigate(`/practice-session/${_.id}`)}catch(_){console.error("Failed to create practice session:",_),y(c,_ instanceof Error?_.message:"An unexpected error occurred")}finally{y(o,!1),y(l,null)}}Ee(),nt(r,{get sidebarOpen(){return i(u)},set sidebarOpen(f){y(u,f)},children:(f,_)=>{var T=hl(),A=d(T),C=b(d(A),2),w=d(C);He(w,{type:"button",variant:"secondary",$$events:{click:g},children:(P,D)=>{var H=Re("Back to Topic");h(P,H)},$$slots:{default:!0}});var x=b(A,2);{var E=P=>{var D=ll();h(P,D)},I=(P,D)=>{{var H=z=>{var q=cl(),N=b(d(q),2),K=d(N);L(()=>R(K,i(c))),h(z,q)},B=(z,q)=>{{var N=K=>{var Y=pl(),X=ve(Y),F=d(X),$=d(F),M=b(F,2);{var V=se=>{var ae=dl(),_e=d(ae);L(()=>R(_e,i(e).description)),h(se,ae)};O(M,se=>{i(e).description&&se(V)})}var W=b(M,2),re=d(W),J=d(re),ce=b(re,2);{var Ae=se=>{var ae=ul(),_e=d(ae);L(()=>R(_e,`Age: ${i(e).target_age_range??""}`)),h(se,ae)};O(ce,se=>{i(e).target_age_range&&se(Ae)})}var be=b(ce,2);{var ne=se=>{var ae=fl(),_e=d(ae);L(()=>R(_e,`Grade: ${i(e).target_grade_level??""}`)),h(se,ae)};O(be,se=>{i(e).target_grade_level&&se(ne)})}var G=b(X,4);wn(G,{get learners(){return i(a)},get loading(){return i(s)},emptyMessage:"No learners found. Please add learners to your account first.",onClick:m,cardActions:[{label:"Create Practice",color:"primary",onClick:m}]});var ge=b(G,2);{var me=se=>{var ae=vl(),_e=d(ae),Pe=d(_e),ke=b(d(Pe),4),Q=d(ke);L(()=>{var oe;return R(Q,`We're generating personalized practice items for ${((oe=i(l))==null?void 0:oe.nickname)||"the learner"}.`)}),h(se,ae)};O(ge,se=>{i(o)&&se(me)})}L(()=>{R($,i(e).name),R(J,i(e).subject)}),h(K,Y)};O(z,K=>{i(e)&&K(N)},q)}};O(P,z=>{i(c)?z(H):z(B,!1)},D)}};O(x,P=>{i(n)?P(E):P(I,!1)})}h(f,T)},$$slots:{default:!0},$$legacy:!0}),Se()}var ml=S('<h4 class="text-md font-medium text-gray-900 mb-2"> </h4>');function xr(r,t){let e=j(t,"index",8);var a=ml(),n=d(a);L(()=>R(n,`Question ${e()+1}`)),h(r,a)}var bl=S('<div class="w-4 h-4 border border-gray-400 rounded mr-2"></div>'),_l=S('<input type="radio" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500">'),yl=S('<div class="flex items-center"><!> <label class="ml-3 text-gray-700"> </label></div>'),xl=S('<div class="mt-4 p-4 bg-gray-50 rounded-md"><h5 class="text-sm font-medium text-gray-900 mb-2">Your Answer:</h5> <p class="text-gray-600"> </p></div>'),wl=S('<h5 class="text-sm font-medium text-gray-900 mt-2 mb-2">Explanation:</h5> <p class="text-gray-600"> </p>',1),Sl=S('<h5 class="text-sm font-medium text-gray-900 mt-2 mb-2">Hints Used:</h5> <p class="text-gray-600"> </p>',1),kl=S('<div class="mt-4 p-4 bg-gray-50 rounded-md"><h5 class="text-sm font-medium text-gray-900 mb-2">Correct Answer:</h5> <p class="text-gray-600"> </p> <!> <!></div>'),Cl=S('<div class="border border-gray-200 rounded-lg p-4"><!> <p class="text-gray-600 mb-4"> </p> <div class="space-y-2"></div> <!> <!></div>');function El(r,t){we(t,!1);let e=j(t,"item",8),a=j(t,"index",8),n=j(t,"disabled",8,!1),s=j(t,"showAnswer",8,!1),o=j(t,"showInstructorInfo",8,!1),l=j(t,"onAnswerChange",8,void 0),c=j(t,"printMode",8,!1);function u(C){const w=C.target;l()&&l()(w.value)}Ee();var k=Cl(),v=d(k);xr(v,{get index(){return a()}});var p=b(v,2),g=d(p),m=b(p,2);Ie(m,5,()=>typeof e().options=="string"?JSON.parse(e().options):e().options,$e,(C,w,x)=>{var E=yl(),I=d(E);{var P=z=>{var q=bl();h(z,q)},D=z=>{var q=_l();L(()=>{te(q,"id",`question-${a()}-option-${x}-${e().id}`),te(q,"name",`question-${a()}-${e().id}`),Ns(q,i(w)),q.disabled=n()}),fe("change",q,u),h(z,q)};O(I,z=>{c()?z(P):z(D,!1)})}var H=b(I,2),B=d(H);L(()=>{te(H,"for",c()?void 0:`question-${a()}-option-${x}-${e().id}`),R(B,i(w))}),h(C,E)});var f=b(m,2);{var _=C=>{var w=xl(),x=b(d(w),2),E=d(x);L(()=>R(E,e().user_answer||"Not answered")),h(C,w)};O(f,C=>{s()&&C(_)})}var T=b(f,2);{var A=C=>{var w=kl(),x=b(d(w),2),E=d(x),I=b(x,2);{var P=B=>{var z=wl(),q=b(ve(z),2),N=d(q);L(()=>R(N,e().explanation)),h(B,z)};O(I,B=>{e().explanation&&B(P)})}var D=b(I,2);{var H=B=>{var z=Sl(),q=b(ve(z),2),N=d(q);L(()=>R(N,e().hints_used)),h(B,z)};O(D,B=>{e().hints_used&&B(H)})}L(()=>R(E,e().correct_answer)),h(C,w)};O(T,C=>{o()&&C(A)})}L(()=>R(g,e().question_text)),h(r,k),Se()}var Tl=S('<div class="w-4 h-4 border border-gray-400 rounded mr-2"></div>'),Ol=S('<input type="radio" value="true" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500">'),Al=S('<div class="w-4 h-4 border border-gray-400 rounded mr-2"></div>'),Pl=S('<input type="radio" value="false" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500">'),$l=S('<div class="mt-4 p-4 bg-gray-50 rounded-md"><h5 class="text-sm font-medium text-gray-900 mb-2">Your Answer:</h5> <p class="text-gray-600"> </p></div>'),Il=S('<h5 class="text-sm font-medium text-gray-900 mt-2 mb-2">Explanation:</h5> <p class="text-gray-600"> </p>',1),Ll=S('<h5 class="text-sm font-medium text-gray-900 mt-2 mb-2">Hints Used:</h5> <p class="text-gray-600"> </p>',1),Rl=S('<div class="mt-4 p-4 bg-gray-50 rounded-md"><h5 class="text-sm font-medium text-gray-900 mb-2">Correct Answer:</h5> <p class="text-gray-600"> </p> <!> <!></div>'),jl=S('<div class="border border-gray-200 rounded-lg p-4"><!> <p class="text-gray-600 mb-4"> </p> <div class="space-y-2"><div class="flex items-center"><!> <label class="ml-3 text-gray-700">True</label></div> <div class="flex items-center"><!> <label class="ml-3 text-gray-700">False</label></div></div> <!> <!></div>');function ql(r,t){we(t,!1);let e=j(t,"item",8),a=j(t,"index",8),n=j(t,"disabled",8,!1),s=j(t,"showAnswer",8,!1),o=j(t,"showInstructorInfo",8,!1),l=j(t,"onAnswerChange",8,void 0),c=j(t,"printMode",8,!1);function u(q){const N=q.target;l()&&l()(N.value)}Ee();var k=jl(),v=d(k);xr(v,{get index(){return a()}});var p=b(v,2),g=d(p),m=b(p,2),f=d(m),_=d(f);{var T=q=>{var N=Tl();h(q,N)},A=q=>{var N=Ol();L(()=>{te(N,"id",`question-${a()}-true-${e().id}`),te(N,"name",`question-${a()}-${e().id}`),N.disabled=n()}),fe("change",N,u),h(q,N)};O(_,q=>{c()?q(T):q(A,!1)})}var C=b(_,2),w=b(f,2),x=d(w);{var E=q=>{var N=Al();h(q,N)},I=q=>{var N=Pl();L(()=>{te(N,"id",`question-${a()}-false-${e().id}`),te(N,"name",`question-${a()}-${e().id}`),N.disabled=n()}),fe("change",N,u),h(q,N)};O(x,q=>{c()?q(E):q(I,!1)})}var P=b(x,2),D=b(m,2);{var H=q=>{var N=$l(),K=b(d(N),2),Y=d(K);L(()=>R(Y,e().user_answer||"Not answered")),h(q,N)};O(D,q=>{s()&&q(H)})}var B=b(D,2);{var z=q=>{var N=Rl(),K=b(d(N),2),Y=d(K),X=b(K,2);{var F=V=>{var W=Il(),re=b(ve(W),2),J=d(re);L(()=>R(J,e().explanation)),h(V,W)};O(X,V=>{e().explanation&&V(F)})}var $=b(X,2);{var M=V=>{var W=Ll(),re=b(ve(W),2),J=d(re);L(()=>R(J,e().hints_used)),h(V,W)};O($,V=>{e().hints_used&&V(M)})}L(()=>R(Y,e().correct_answer)),h(q,N)};O(B,q=>{o()&&q(z)})}L(()=>{R(g,e().question_text),te(C,"for",c()?void 0:`question-${a()}-true-${e().id}`),te(P,"for",c()?void 0:`question-${a()}-false-${e().id}`)}),h(r,k),Se()}var Dl=S('<div class="h-32 border border-gray-300 rounded-md"></div>'),Fl=S('<textarea class="w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Type your answer here..."></textarea>'),Nl=S('<div class="mt-4 p-4 bg-gray-50 rounded-md"><h5 class="text-sm font-medium text-gray-900 mb-2">Your Answer:</h5> <p class="text-gray-600"> </p></div>'),Ml=S('<h5 class="text-sm font-medium text-gray-900 mt-2 mb-2">Explanation:</h5> <p class="text-gray-600"> </p>',1),Ul=S('<h5 class="text-sm font-medium text-gray-900 mt-2 mb-2">Hints Used:</h5> <p class="text-gray-600"> </p>',1),Bl=S('<div class="mt-4 p-4 bg-gray-50 rounded-md"><h5 class="text-sm font-medium text-gray-900 mb-2">Correct Answer:</h5> <p class="text-gray-600"> </p> <!> <!></div>'),zl=S('<div class="border border-gray-200 rounded-lg p-4"><!> <p class="text-gray-600 mb-4"> </p> <!> <!> <!></div>');function Hl(r,t){we(t,!1);let e=j(t,"item",8),a=j(t,"index",8),n=j(t,"disabled",8,!1),s=j(t,"showAnswer",8,!1),o=j(t,"showInstructorInfo",8,!1),l=j(t,"onAnswerChange",8,void 0),c=j(t,"printMode",8,!1);function u(x){const E=x.target;l()&&l()(E.value)}Ee();var k=zl(),v=d(k);xr(v,{get index(){return a()}});var p=b(v,2),g=d(p),m=b(p,2);{var f=x=>{var E=Dl();h(x,E)},_=x=>{var E=Fl();L(()=>{te(E,"id",`question-${a()}-${e().id}`),E.disabled=n()}),fe("input",E,u),h(x,E)};O(m,x=>{c()?x(f):x(_,!1)})}var T=b(m,2);{var A=x=>{var E=Nl(),I=b(d(E),2),P=d(I);L(()=>R(P,e().user_answer||"Not answered")),h(x,E)};O(T,x=>{s()&&x(A)})}var C=b(T,2);{var w=x=>{var E=Bl(),I=b(d(E),2),P=d(I),D=b(I,2);{var H=q=>{var N=Ml(),K=b(ve(N),2),Y=d(K);L(()=>R(Y,e().explanation)),h(q,N)};O(D,q=>{e().explanation&&q(H)})}var B=b(D,2);{var z=q=>{var N=Ul(),K=b(ve(N),2),Y=d(K);L(()=>R(Y,e().hints_used)),h(q,N)};O(B,q=>{e().hints_used&&q(z)})}L(()=>R(P,e().correct_answer)),h(x,E)};O(C,x=>{o()&&x(w)})}L(()=>R(g,e().question_text)),h(r,k),Se()}var Gl=S('<div class="inline-block w-32 border-b border-gray-400 mx-1"></div>'),Vl=S('<input type="text" class="inline-block w-32 px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">'),Wl=S(" <!>",1),Kl=S('<div class="mt-4 p-4 bg-gray-50 rounded-md"><h5 class="text-sm font-medium text-gray-900 mb-2">Your Answer:</h5> <p class="text-gray-600"> </p></div>'),Yl=S('<h5 class="text-sm font-medium text-gray-900 mt-2 mb-2">Explanation:</h5> <p class="text-gray-600"> </p>',1),Jl=S('<h5 class="text-sm font-medium text-gray-900 mt-2 mb-2">Hints Used:</h5> <p class="text-gray-600"> </p>',1),Ql=S('<div class="mt-4 p-4 bg-gray-50 rounded-md"><h5 class="text-sm font-medium text-gray-900 mb-2">Correct Answer:</h5> <p class="text-gray-600"> </p> <!> <!></div>'),Zl=S('<div class="border border-gray-200 rounded-lg p-4"><!> <div class="text-gray-600 mb-4"></div> <!> <!></div>');function Xl(r,t){we(t,!1);const e=U();let a=j(t,"item",8),n=j(t,"index",8),s=j(t,"disabled",8,!1),o=j(t,"showAnswer",8,!1),l=j(t,"showInstructorInfo",8,!1),c=j(t,"onAnswerChange",8,void 0),u=j(t,"printMode",8,!1);function k(A){const C=A.target;c()&&c()(C.value)}ft(()=>_t(a()),()=>{y(e,a().question_text.split("_____"))}),Vt(),Ee();var v=Zl(),p=d(v);xr(p,{get index(){return n()}});var g=b(p,2);Ie(g,5,()=>i(e),$e,(A,C,w)=>{var x=Wl(),E=ve(x),I=b(E);{var P=D=>{var H=Ke(),B=ve(H);{var z=N=>{var K=Gl();h(N,K)},q=N=>{var K=Vl();L(()=>{te(K,"id",`question-${n()}-blank-${w}-${a().id}`),K.disabled=s()}),fe("input",K,k),h(N,K)};O(B,N=>{u()?N(z):N(q,!1)})}h(D,H)};O(I,D=>{w<i(e).length-1&&D(P)})}L(()=>R(E,`${i(C)??""} `)),h(A,x)});var m=b(g,2);{var f=A=>{var C=Kl(),w=b(d(C),2),x=d(w);L(()=>R(x,a().user_answer||"Not answered")),h(A,C)};O(m,A=>{o()&&A(f)})}var _=b(m,2);{var T=A=>{var C=Ql(),w=b(d(C),2),x=d(w),E=b(w,2);{var I=H=>{var B=Yl(),z=b(ve(B),2),q=d(z);L(()=>R(q,a().explanation)),h(H,B)};O(E,H=>{a().explanation&&H(I)})}var P=b(E,2);{var D=H=>{var B=Jl(),z=b(ve(B),2),q=d(z);L(()=>R(q,a().hints_used)),h(H,B)};O(P,H=>{a().hints_used&&H(D)})}L(()=>R(x,a().correct_answer)),h(A,C)};O(_,A=>{l()&&A(T)})}h(r,v),Se()}var ec=S('<div class="border border-red-200 rounded-lg p-4 bg-red-50"><p class="text-red-600"> </p></div>');function Aa(r,t){we(t,!1);const e=U(),a=U(),n=U();let s=j(t,"item",8),o=j(t,"index",8),l=j(t,"viewType",8,"learner"),c=j(t,"disabled",8,!1),u=j(t,"onAnswerChange",8,void 0),k=j(t,"printMode",8,!1);ft(()=>_t(l()),()=>{y(e,l()==="answered"||l()==="instructor")}),ft(()=>_t(l()),()=>{y(a,l()==="instructor")}),ft(()=>(_t(c()),_t(l())),()=>{y(n,c()||l()!=="learner")}),Vt(),Ee();var v=Ke(),p=ve(v);{var g=f=>{El(f,{get item(){return s()},get index(){return o()},get disabled(){return i(n)},get showAnswer(){return i(e)},get showInstructorInfo(){return i(a)},get onAnswerChange(){return u()},get printMode(){return k()}})},m=(f,_)=>{{var T=C=>{ql(C,{get item(){return s()},get index(){return o()},get disabled(){return i(n)},get showAnswer(){return i(e)},get showInstructorInfo(){return i(a)},get onAnswerChange(){return u()},get printMode(){return k()}})},A=(C,w)=>{{var x=I=>{Hl(I,{get item(){return s()},get index(){return o()},get disabled(){return i(n)},get showAnswer(){return i(e)},get showInstructorInfo(){return i(a)},get onAnswerChange(){return u()},get printMode(){return k()}})},E=(I,P)=>{{var D=B=>{Xl(B,{get item(){return s()},get index(){return o()},get disabled(){return i(n)},get showAnswer(){return i(e)},get showInstructorInfo(){return i(a)},get onAnswerChange(){return u()},get printMode(){return k()}})},H=B=>{var z=ec(),q=d(z),N=d(q);L(()=>R(N,`Unsupported question type: ${s().question_type??""}, id: ${s().id??""}`)),h(B,z)};O(I,B=>{s().question_type==="fill_in_blank"?B(D):B(H,!1)},P)}};O(C,I=>{s().question_type==="short_answer"?I(x):I(E,!1)},w)}};O(f,C=>{s().question_type==="true_false"?C(T):C(A,!1)},_)}};O(p,f=>{s().question_type==="multiple_choice"?f(g):f(m,!1)})}h(r,v),Se()}class tc{async ensureAuth(){if(!Z.authStore.isValid)throw new Error("You must be logged in to access practice sessions")}async loadSession(t){try{await this.ensureAuth();const e=await Z.collection("practice_sessions").getOne(t,{expand:"learner,learner.user,practice_topic,practice_items",fields:"id,name,status,assigned_at,completed_at,generation_prompt,learner,practice_topic,practice_items,expand"});if(!e)throw new Error("Session not found");return e}catch(e){throw console.error("Failed to load session:",e),e instanceof Error?e:new Error("Failed to load practice session")}}async checkUserRole(){await this.ensureAuth();try{const t=Z.authStore.model;if(!t)throw new Error("User not authenticated");try{return!!await Z.collection("instructors").getFirstListItem(`user="${t.id}"`)}catch{return!1}}catch(t){return console.error("Failed to check user role:",t),!1}}parsePracticeItems(t){var e;if((e=t.expand)!=null&&e.practice_items)return t.expand.practice_items;if(t.practice_items)try{return JSON.parse(t.practice_items)}catch(a){return console.error("Error parsing practice items:",a),[]}return[]}}const Ir=new tc;var rc=S('<div class="flex justify-center items-center h-64"><div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"></div></div>'),ac=S('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert"><strong class="font-bold">Error!</strong> <span class="block sm:inline"> </span></div>'),nc=S('<span class="bg-gray-100 text-gray-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),sc=S('<span class="bg-gray-100 text-gray-800 text-xs font-medium px-2.5 py-0.5 rounded"> </span>'),ic=S('<div class="mb-4"><h3 class="text-sm font-medium text-gray-700 mb-2">Learner:</h3> <p class="text-gray-600"> </p></div>'),oc=S('<div class="mb-4"><h3 class="text-sm font-medium text-gray-700 mb-2">Topic:</h3> <p class="text-gray-600"> </p></div>'),lc=S('<div class="question-container svelte-6swr63"><!></div>'),cc=S('<div class="mt-6"><h3 class="text-lg font-medium text-gray-900 mb-4">Practice Items</h3> <div class="space-y-6"></div></div>'),dc=S('<div class="bg-gray-50 border border-gray-200 p-4 rounded-md"><p class="text-gray-600">No practice items available.</p></div>'),uc=S('<div class="bg-white shadow-md rounded-lg p-6 mb-6"><h2 class="text-xl font-semibold text-gray-900 mb-2"> </h2> <div class="flex flex-wrap gap-2 mb-4"><span> </span> <!> <!></div> <!> <!> <!></div>'),fc=S('<div class="container mx-auto px-4 py-8 no-print"><div class="flex justify-between items-center mb-6"><h1 class="text-2xl font-bold text-gray-900">Practice Session</h1> <div class="flex space-x-2"><!> <!></div></div> <!></div>'),vc=S('<h2 class="text-xl mb-1"> </h2>'),pc=S('<p class="text-lg"> </p>'),hc=S('<div class="print-item question-container svelte-6swr63"><!></div>'),gc=S("<p>No practice items available.</p>"),mc=S('<div class="print-header svelte-6swr63"><h1 class="text-3xl font-bold mb-2"> </h1> <!> <!></div> <!>',1),bc=S('<!> <div class="print-only print-container"><!></div>',1);function _c(r,t){we(t,!1);let e=U(null),a=U([]),n=U(!0),s=U(null),o=U(!0),l=null,c=U(!1),u=U(!1);rt(async()=>{try{const f=window.location.pathname;f.includes("/practice-session/")?(l=f.split("/practice-session/")[1],l?(await v(l),await k()):(y(s,"Invalid session ID"),y(n,!1))):(console.error("Invalid URL format, expected /practice-session/ID"),y(s,"Invalid URL format"),y(n,!1))}catch(f){console.error("Error in onMount:",f),y(s,f instanceof Error?f.message:"An unexpected error occurred"),y(n,!1)}});async function k(){try{y(c,await Ir.checkUserRole())}catch(f){console.error("Failed to check user role:",f),y(c,!1)}}async function v(f){try{if(y(n,!0),y(s,null),!f)throw new Error("Session ID is required");if(y(e,await Ir.loadSession(f)),!i(e))throw new Error("Session not found");y(a,Ir.parsePracticeItems(i(e)))}catch(_){console.error("Failed to load session:",_),y(s,_ instanceof Error?_.message:"Failed to load practice session"),y(e,null),y(a,[])}finally{y(n,!1)}}function p(){window.navigate("/practice-topics")}function g(f,_){i(a)[f]&&xe(a,i(a)[f].user_answer=_)}function m(){y(u,!0),y(o,!1),setTimeout(()=>{window.print(),setTimeout(()=>{y(u,!1)},500)},200)}Ee(),nt(r,{get sidebarOpen(){return i(o)},set sidebarOpen(f){y(o,f)},children:(f,_)=>{var T=bc(),A=ve(T);{var C=I=>{var P=fc(),D=d(P),H=b(d(D),2),B=d(H);He(B,{type:"button",variant:"secondary",$$events:{click:p},children:(Y,X)=>{var F=Re("Back to Topics");h(Y,F)},$$slots:{default:!0}});var z=b(B,2);He(z,{type:"button",variant:"primary",$$events:{click:m},children:(Y,X)=>{var F=Re("Print Practice");h(Y,F)},$$slots:{default:!0}});var q=b(D,2);{var N=Y=>{var X=rc();h(Y,X)},K=(Y,X)=>{{var F=M=>{var V=ac(),W=b(d(V),2),re=d(W);L(()=>R(re,i(s))),h(M,V)},$=(M,V)=>{{var W=re=>{var J=uc(),ce=d(J),Ae=d(ce),be=b(ce,2),ne=d(be),G=d(ne),ge=b(ne,2);{var me=ee=>{var ie=nc(),le=d(ie);L(Te=>R(le,`Assigned: ${Te??""}`),[()=>new Date(i(e).assigned_at).toLocaleDateString()],Oe),h(ee,ie)};O(ge,ee=>{i(e).assigned_at&&ee(me)})}var se=b(ge,2);{var ae=ee=>{var ie=sc(),le=d(ie);L(Te=>R(le,`Completed: ${Te??""}`),[()=>new Date(i(e).completed_at).toLocaleDateString()],Oe),h(ee,ie)};O(se,ee=>{i(e).completed_at&&ee(ae)})}var _e=b(be,2);{var Pe=ee=>{var ie=ic(),le=b(d(ie),2),Te=d(le);L(()=>R(Te,i(e).expand.learner.name)),h(ee,ie)};O(_e,ee=>{var ie;(ie=i(e).expand)!=null&&ie.learner&&ee(Pe)})}var ke=b(_e,2);{var Q=ee=>{var ie=oc(),le=b(d(ie),2),Te=d(le);L(()=>R(Te,i(e).expand.practice_topic.name)),h(ee,ie)};O(ke,ee=>{var ie;(ie=i(e).expand)!=null&&ie.practice_topic&&ee(Q)})}var oe=b(ke,2);{var de=ee=>{var ie=cc(),le=b(d(ie),2);Ie(le,5,()=>i(a),$e,(Te,Fe,wt)=>{var Rt=lc(),wr=d(Rt);const Jt=Oe(()=>i(e).status==="Completed"?i(c)?"instructor":"answered":"learner"),Qt=Oe(()=>i(e).status==="Completed");Aa(wr,{get item(){return i(Fe)},index:wt,get viewType(){return i(Jt)},get disabled(){return i(Qt)},onAnswerChange:Sr=>g(wt,Sr)}),h(Te,Rt)}),h(ee,ie)},ye=ee=>{var ie=dc();h(ee,ie)};O(oe,ee=>{i(a).length>0?ee(de):ee(ye,!1)})}L(()=>{R(Ae,i(e).name||"Unnamed Practice"),Ce(ne,1,`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                            ${i(e).status==="Completed"?"bg-green-100 text-green-800":i(e).status==="InProgress"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,"svelte-6swr63"),R(G,i(e).status)}),h(re,J)};O(M,re=>{i(e)&&re(W)},V)}};O(Y,M=>{i(s)?M(F):M($,!1)},X)}};O(q,Y=>{i(n)?Y(N):Y(K,!1)})}h(I,P)};O(A,I=>{i(u)||I(C)})}var w=b(A,2),x=d(w);{var E=I=>{var P=mc(),D=ve(P),H=d(D),B=d(H),z=b(H,2);{var q=$=>{var M=vc(),V=d(M);L(()=>R(V,`Topic: ${i(e).expand.practice_topic.name??""}`)),h($,M)};O(z,$=>{var M;(M=i(e).expand)!=null&&M.practice_topic&&$(q)})}var N=b(z,2);{var K=$=>{var M=pc(),V=d(M);L(()=>R(V,`Learner: ${i(e).expand.learner.name??""}`)),h($,M)};O(N,$=>{var M;(M=i(e).expand)!=null&&M.learner&&$(K)})}var Y=b(D,2);{var X=$=>{var M=Ke(),V=ve(M);Ie(V,1,()=>i(a),$e,(W,re,J)=>{var ce=hc(),Ae=d(ce);const be=Oe(()=>i(e).status==="Completed"?i(c)?"instructor":"answered":"learner"),ne=Oe(()=>i(e).status==="Completed");Aa(Ae,{get item(){return i(re)},index:J,printMode:!0,get viewType(){return i(be)},get disabled(){return i(ne)},onAnswerChange:G=>g(J,G)}),h(W,ce)}),h($,M)},F=$=>{var M=gc();h($,M)};O(Y,$=>{i(a).length>0?$(X):$(F,!1)})}L(()=>R(B,i(e).name||"Practice Session")),h(I,P)};O(x,I=>{i(e)&&I(E)})}h(f,T)},$$slots:{default:!0},$$legacy:!0}),Se()}var yc=S('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6" role="alert"><strong class="font-bold">Error!</strong> <span class="block sm:inline"> </span></div>'),xc=S('<div class="container mx-auto px-4 py-8"><div class="flex justify-between items-center mb-6"><h1 class="text-2xl font-bold text-gray-900">Learners</h1> <!></div> <!> <!></div>');function wc(r,t){we(t,!1);let e=U([]),a=U(!0),n=U(null),s=U(!0);rt(()=>{o()});async function o(){try{y(a,!0),y(n,null);const v=Z.authStore.model;if(!v){console.error("User not authenticated"),y(n,"You must be logged in to view learners");return}const p=await Z.collection("instructors").getFirstListItem(`user="${v.id}"`),g=await Z.collection("learners").getList(1,100,{filter:`account="${p.account}"`,sort:"nickname",expand:"user"});y(e,g.items),console.log("Loaded learners:",i(e))}catch(v){console.error("Failed to load learners:",v),y(n,"Failed to load learners")}finally{y(a,!1)}}function l(v){console.log("View learner profile:",v),window.navigate(`/learner/${v.id}`)}function c(v){console.log("Edit learner:",v),window.navigate(`/edit-learner/${v.id}`)}function u(v){confirm(`Are you sure you want to delete ${v.nickname}?`)&&console.log("Delete learner:",v)}function k(){console.log("Create new learner"),window.navigate("/create-learner")}Ee(),nt(r,{get sidebarOpen(){return i(s)},set sidebarOpen(v){y(s,v)},children:(v,p)=>{var g=xc(),m=d(g),f=b(d(m),2);He(f,{type:"button",$$events:{click:k},children:(C,w)=>{var x=Re("Add New Learner");h(C,x)},$$slots:{default:!0}});var _=b(m,2);{var T=C=>{var w=yc(),x=b(d(w),2),E=d(x);L(()=>R(E,i(n))),h(C,w)};O(_,C=>{i(n)&&C(T)})}var A=b(_,2);wn(A,{get learners(){return i(e)},get loading(){return i(a)},emptyMessage:"No learners found. Add your first learner to get started!",onClick:l,cardActions:[{label:"View",color:"primary",onClick:l},{label:"Edit",color:"secondary",onClick:c},{label:"Delete",color:"danger",onClick:u}]}),h(v,g)},$$slots:{default:!0},$$legacy:!0}),Se()}var Sc=S("<option>Loading models...</option>"),kc=S("<option>Error loading models</option>"),Cc=S("<option> </option>"),Ec=S('<div class="text-center py-12 border border-dashed border-gray-200 rounded-lg"><p class="text-gray-500">No messages yet. Start a conversation below.</p></div>'),Tc=S('<span class="text-xs text-gray-400 ml-2 tooltip svelte-1dl78js"> </span>'),Oc=S('<div class="flex flex-col"><div class="flex items-center mb-2"><span class="font-medium text-sm text-gray-700 mr-2"> </span> <span class="text-xs text-gray-500"> </span> <!></div> <div><p class="whitespace-pre-wrap break-words text-left text-gray-800"> </p></div></div>'),Ac=S('<div class="flex flex-col"><div class="flex items-center mb-2"><span class="font-medium text-sm text-gray-700">Assistant</span></div> <div class="bg-gray-50 border border-gray-100 rounded-lg p-4"><div class="flex space-x-2"><div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce bounce-delay-1 svelte-1dl78js"></div> <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce bounce-delay-2 svelte-1dl78js"></div></div></div></div>'),Pc=S('<div class="space-y-6"><!> <!></div>'),$c=S(`<div class="max-w-4xl mx-auto px-4 sm:px-6 md:px-8 my-8"><div class="flex justify-between items-center mb-6"><h1 class="text-2xl font-semibold text-gray-900">Chat with LLM</h1> <div class="flex items-center"><!></div></div> <div class="bg-white shadow rounded-lg"><div class="px-4 py-5 sm:p-6 chat-container svelte-1dl78js"><!></div> <div class="border-t border-gray-200 px-4 py-5 sm:p-6"><div class="flex"><textarea placeholder="Type your message..." rows="3" class="		dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600 dark:placeholder-gray-500
 flex-1 px-4 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-0 focus:ring-secondary focus:border-secondary resize-none"></textarea> <button class="bg-secondary text-white px-6 py-2 rounded-r-md hover:bg-blue-600 focus:outline-none focus:ring-0 focus:ring-secondary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0"> </button></div> <div class="flex justify-between mt-2"><p class="text-xs text-gray-500">Press Enter to send, Shift+Enter for new line</p> <p class="text-xs text-gray-500 font-medium tooltip svelte-1dl78js"> </p></div></div></div></div>`);function Ic(r,t){we(t,!1);const e=U();let a=U(!0),n=U(""),s=U([]),o=U(!1),l="You are a helpful learning assistant for kids.",c=U(""),u=U(0),k=U(0),v=U(0),p=U(0),g=U(!1),m=U(null),f=U([]);async function _(){y(g,!0),y(m,null);try{const C=await zr.getInfo();y(f,C.platforms.flatMap(x=>x.models.map(E=>({id:E.name,name:`${E.name}${E.isDefault?" (Default)":""}`,isDefault:E.isDefault})))),i(f).length===0&&y(f,[{id:"",name:"Default"}]);const w=i(f).find(x=>x.isDefault);w&&y(c,w.id)}catch(C){console.error("Error fetching models:",C),y(m,C instanceof Error?C.message:"Failed to fetch models"),y(f,[{id:"",name:"Default"}])}finally{y(g,!1)}}_();async function T(){if(!i(n).trim())return;const C={role:"user",content:i(n),timestamp:new Date};y(s,[...i(s),C]),y(n,""),y(o,!0),Le.set(null);try{const w=i(s).map(I=>`${I.role==="user"?"User":"Assistant"}: ${I.content}`).join(`

`),x=await zr.chat(w,l,i(c)||void 0),E={role:"assistant",content:x.response,timestamp:new Date,usage:x.usage};y(s,[...i(s),E]),setTimeout(()=>{const I=document.querySelector(".chat-container");I&&(I.scrollTop=I.scrollHeight)},50)}catch(w){console.error("Error sending message:",w),Le.set(w instanceof Error?w.message:"Failed to send message")}finally{y(o,!1)}}function A(C){C.key==="Enter"&&!C.shiftKey&&(C.preventDefault(),T())}ft(()=>i(s),()=>{let C=0,w=0,x=0,E=0;i(s).forEach(I=>{I.usage&&(C+=I.usage.PromptTokens||0,w+=I.usage.CompletionTokens||0,x+=I.usage.TotalTokens||0,E+=I.usage.Cost||0)}),y(k,C),y(v,w),y(u,x),y(p,E)}),ft(()=>(i(k),i(v),i(p)),()=>{y(e,`Prompt: ${i(k)} tokens
Completion: ${i(v)} tokens
Cost: $${i(p).toFixed(6)}`)}),Vt(),Ee(),nt(r,{get sidebarOpen(){return i(a)},set sidebarOpen(C){y(a,C)},children:(C,w)=>{var x=$c(),E=d(x),I=b(d(E),2),P=d(I);xn(P,{id:"modelSelect",label:"Model",get disabled(){return i(g)},cols:"",inline:!0,get value(){return i(c)},set value(W){y(c,W)},children:(W,re)=>{var J=Ke(),ce=ve(J);{var Ae=ne=>{var G=Sc();G.value=G.__value="",h(ne,G)},be=(ne,G)=>{{var ge=se=>{var ae=kc();ae.value=ae.__value="",h(se,ae)},me=se=>{var ae=Ke(),_e=ve(ae);Ie(_e,1,()=>i(f),$e,(Pe,ke)=>{var Q=Cc(),oe={},de=d(Q);L(()=>{oe!==(oe=i(ke).id)&&(Q.value=(Q.__value=i(ke).id)??""),R(de,i(ke).name)}),h(Pe,Q)}),h(se,ae)};O(ne,se=>{i(m)?se(ge):se(me,!1)},G)}};O(ce,ne=>{i(g)?ne(Ae):ne(be,!1)})}h(W,J)},$$slots:{default:!0},$$legacy:!0});var D=b(E,2),H=d(D),B=d(H);{var z=W=>{var re=Ec();h(W,re)},q=W=>{var re=Pc(),J=d(re);Ie(J,1,()=>i(s),$e,(be,ne)=>{var G=Oc(),ge=d(G),me=d(ge),se=d(me),ae=b(me,2),_e=d(ae),Pe=b(ae,2);{var ke=ye=>{var ee=Tc(),ie=d(ee);L(le=>{te(ee,"title",`Model: ${i(ne).usage.LlmModelName||"Default"} Cache hit: ${i(ne).usage.CacheHit?"Yes":"No"} Prompt: ${i(ne).usage.PromptTokens??""} tokens Completion: ${i(ne).usage.CompletionTokens??""} tokens Cost: $${le??""}`),R(ie,`(${i(ne).usage.TotalTokens??""} tokens)`)},[()=>(i(ne).usage.Cost||0).toFixed(6)],Oe),h(ye,ee)};O(Pe,ye=>{i(ne).role==="assistant"&&i(ne).usage&&ye(ke)})}var Q=b(ge,2),oe=d(Q),de=d(oe);L(ye=>{R(se,i(ne).role==="user"?"You":"Assistant"),R(_e,ye),Ce(Q,1,`${i(ne).role==="user"?"bg-blue-50 border-blue-100":"bg-gray-50 border-gray-100"} border rounded-lg p-4`),R(de,i(ne).content)},[()=>i(ne).timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})],Oe),h(be,G)});var ce=b(J,2);{var Ae=be=>{var ne=Ac();h(be,ne)};O(ce,be=>{i(o)&&be(Ae)})}h(W,re)};O(B,W=>{i(s).length===0?W(z):W(q,!1)})}var N=b(H,2),K=d(N),Y=d(K),X=b(Y,2),F=d(X),$=b(K,2),M=b(d($),2),V=d(M);L(W=>{X.disabled=W,R(F,i(o)?"Sending...":"Send"),te(M,"title",i(e)),R(V,`${i(u)??""} tokens`)},[()=>i(o)||!i(n).trim()],Oe),zt(Y,()=>i(n),W=>y(n,W)),fe("keydown",Y,A),fe("click",X,T),h(C,x)},$$slots:{default:!0},$$legacy:!0}),Se()}var Lc=S('<div class="flex justify-center items-center h-screen"><div class="animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-gray-900 dark:border-white"></div></div>'),Rc=S('<div class="flex flex-col items-center justify-center h-screen"><div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert"><strong class="font-bold">Error!</strong> <span class="block sm:inline"> </span></div> <button class="mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Try Again</button></div>'),jc=S('<main class="svelte-1rivxoc"><!></main>');function qc(r,t){we(t,!1);const[e,a]=Lt(),n=()=>Xe(Or,"$isAuthLoading",e),s=()=>Xe(Le,"$error",e),o=()=>Xe(ot,"$isAuthenticated",e),l=()=>Xe(Tt,"$user",e);let c=U("dashboard");async function u(){var _,T,A;Or.set(!0),Le.set(null);try{const C=Ur();if(C){Z.authStore.token!==C&&(Z.authStore.clear(),localStorage.setItem("pocketbase_auth",JSON.stringify({token:C,model:Z.authStore.model})));try{if(await Z.collection("users").authRefresh(),Z.authStore.isValid){const w=await Z.collection("users").getOne(((_=Z.authStore.record)==null?void 0:_.id)??"");try{const x=await Z.collection("instructors").getFirstListItem(`user="${(T=Z.authStore.record)==null?void 0:T.id}"`);if(x){x.user=w,Tt.set(x),ot.set(!0);return}}catch{}try{const x=await Z.collection("learners").getFirstListItem(`user="${(A=Z.authStore.record)==null?void 0:A.id}"`,{requestKey:null});if(x){x.user=w,Tt.set(x),ot.set(!0);return}}catch{}Pr(),ot.set(!1)}}catch(w){console.error("Auth refresh failed:",w),Pr(),ot.set(!1)}}else ot.set(!1)}catch(C){console.error("Authentication initialization failed:",C),Pr(),ot.set(!1)}finally{Or.set(!1)}}function k(){const _=window.location.pathname||"/",T=window.location.search;if(console.log("Routing path:",_,"with search:",T),_.includes("/practice-topic/"))console.log("Setting route to practice-topic view"),y(c,"practice-topic");else if(_.includes("/create-practice/"))console.log("Setting route to create-practice"),y(c,"create-practice");else if(_.includes("/practice-session/"))console.log("Setting route to practice-session"),y(c,"practice-session");else if(_==="/")console.log("Setting route to dashboard"),y(c,"dashboard");else{const A=_.startsWith("/")?_.slice(1):_;console.log("Setting route to:",A),y(c,A)}}rt(()=>{u(),k(),window.addEventListener("popstate",()=>{console.log("Navigation event, path:",window.location.pathname),k()}),document.addEventListener("click",_=>{var C;const A=_.target.closest("a");if(A&&((C=A.getAttribute("href"))!=null&&C.startsWith("/"))&&!A.hasAttribute("target")){const w=A.getAttribute("href")||"/";if(w.startsWith("/assets/")||w.endsWith(".svg")||w.endsWith(".png")||w.endsWith(".jpg")||w.endsWith(".jpeg")||w.endsWith(".gif")||w.endsWith(".ico"))return;_.preventDefault(),history.pushState(null,"",w),k()}})});function v(_){history.pushState(null,"",_);const T=window.location.pathname||"/";if(console.log("Navigated to path:",T,"with search:",window.location.search),T.includes("/practice-topic/"))y(c,"practice-topic");else if(T.includes("/create-practice/"))y(c,"create-practice");else if(T.includes("/practice-session/"))y(c,"practice-session");else if(T==="/")y(c,"dashboard");else{const A=T.startsWith("/")?T.slice(1):T;y(c,A)}}typeof window<"u"&&(window.navigate=v),window.addEventListener("popstate",_=>{console.log("Popstate event triggered",_);const T=window.location.pathname||"/";console.log("Current path:",T,"with search:",window.location.search),k()}),Ee();var p=jc(),g=d(p);{var m=_=>{var T=Lc();h(_,T)},f=(_,T)=>{{var A=w=>{var x=Rc(),E=d(x),I=b(d(E),2),P=d(I),D=b(E,2);L(()=>R(P,s())),fe("click",D,()=>window.location.reload()),h(w,x)},C=(w,x)=>{{var E=P=>{var D=Ke(),H=ve(D);{var B=q=>{Ta(q,{})},z=(q,N)=>{{var K=X=>{Hi(X,{})},Y=(X,F)=>{{var $=V=>{Vi(V)},M=(V,W)=>{{var re=ce=>{So(ce,{})},J=(ce,Ae)=>{{var be=G=>{Fo(G,{})},ne=(G,ge)=>{{var me=ae=>{gl(ae,{})},se=(ae,_e)=>{{var Pe=Q=>{_c(Q,{})},ke=(Q,oe)=>{{var de=ee=>{wc(ee,{})},ye=(ee,ie)=>{{var le=Fe=>{Ic(Fe,{})},Te=Fe=>{Ta(Fe,{})};O(ee,Fe=>{i(c)==="chat"?Fe(le):Fe(Te,!1)},ie)}};O(Q,ee=>{i(c)==="learners"?ee(de):ee(ye,!1)},oe)}};O(ae,Q=>{i(c)==="practice-session"?Q(Pe):Q(ke,!1)},_e)}};O(G,ae=>{i(c)==="create-practice"?ae(me):ae(se,!1)},ge)}};O(ce,G=>{i(c)==="practice-topic"?G(be):G(ne,!1)},Ae)}};O(V,ce=>{i(c)==="practice-topics"?ce(re):ce(J,!1)},W)}};O(X,V=>{i(c)==="settings"?V($):V(M,!1)},F)}};O(q,X=>{i(c)==="profile"?X(K):X(Y,!1)},N)}};O(H,q=>{i(c)==="dashboard"?q(B):q(z,!1)})}h(P,D)},I=P=>{xi(P,{})};O(w,P=>{o()&&l()!==null?P(E):P(I,!1)},x)}};O(_,w=>{s()?w(A):w(C,!1)},T)}};O(g,_=>{n()?_(m):_(f,!1)})}h(r,p),Se(),a()}function Dc(){const r=document.getElementById("app");if(!r){console.error("Failed to find app element");return}try{return Os(qc,{target:r})}catch(t){console.error("Failed to mount app:",t),r.innerHTML=`
      <div class="min-h-screen flex items-center justify-center bg-gray-50">
        <div class="text-center">
          <h1 class="text-2xl font-bold text-red-600">Error</h1>
          <p class="mt-2 text-gray-600">Failed to initialize the application. Please try refreshing the page.</p>
        </div>
      </div>
    `}}Dc();
